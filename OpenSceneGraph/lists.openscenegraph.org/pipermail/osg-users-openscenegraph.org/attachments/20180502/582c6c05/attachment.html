<tt>
&lt;html&nbsp;dir=&quot;ltr&quot;&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;style&nbsp;type=&quot;text/css&quot;&nbsp;id=&quot;owaParaStyle&quot;&gt;P&nbsp;{margin-top:0;margin-bottom:0;}&lt;/style&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;fpstyle=&quot;1&quot;&nbsp;ocsi=&quot;0&quot;&gt;<br>
&lt;div&nbsp;style=&quot;direction:&nbsp;ltr;font-family:&nbsp;Tahoma;color:&nbsp;#000000;font-size:&nbsp;10pt;&quot;&gt;&lt;br&gt;<br>
&lt;div&gt;Hi&nbsp;All,&lt;br&gt;<br>
&lt;br&gt;<br>
Been&nbsp;using&nbsp;OSG&nbsp;for&nbsp;a&nbsp;while&nbsp;and&nbsp;have&nbsp;learned&nbsp;a&nbsp;lot&nbsp;and&nbsp;enjoyed&nbsp;it.&nbsp;I&nbsp;currently&nbsp;have&nbsp;an&nbsp;application&nbsp;with&nbsp;uses&nbsp;OSG&nbsp;and&nbsp;Qt&nbsp;for&nbsp;displaying&nbsp;a&nbsp;highly&nbsp;detailed&nbsp;model.&nbsp;A&nbsp;database&nbsp;is&nbsp;loaded&nbsp;which&nbsp;may&nbsp;cause&nbsp;colors&nbsp;in&nbsp;the&nbsp;model&nbsp;to&nbsp;change&nbsp;or&nbsp;additional&nbsp;geometries&nbsp;to&nbsp;be<br>
&nbsp;generated.&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
My&nbsp;OSG&nbsp;viewport&nbsp;is&nbsp;a&nbsp;class&nbsp;which&nbsp;subclasses&nbsp;from&nbsp;QWidget&nbsp;and&nbsp;osgViewer::CompisiteViewer&nbsp;and&nbsp;is&nbsp;embedded&nbsp;into&nbsp;a&nbsp;QMainWindow.&nbsp;This&nbsp;works&nbsp;fine&nbsp;so&nbsp;I've&nbsp;stuck&nbsp;with&nbsp;it.&nbsp;The&nbsp;application&nbsp;can&nbsp;perform&nbsp;most&nbsp;CAD-like&nbsp;operations&nbsp;on&nbsp;the&nbsp;model&nbsp;with&nbsp;OSG.&nbsp;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
I've&nbsp;finally&nbsp;encountered&nbsp;a&nbsp;model&nbsp;which&nbsp;brings&nbsp;my&nbsp;application&nbsp;to&nbsp;around&nbsp;1-2&nbsp;fps&nbsp;while&nbsp;interacting&nbsp;with&nbsp;it.&nbsp;I&nbsp;know&nbsp;there&nbsp;are&nbsp;various&nbsp;techniques&nbsp;used&nbsp;to&nbsp;help&nbsp;with&nbsp;performance&nbsp;but&nbsp;also&nbsp;understand&nbsp;the&nbsp;approach&nbsp;depends&nbsp;on&nbsp;the&nbsp;situation.&nbsp;I'm&nbsp;currently&nbsp;considering<br>
&nbsp;a&nbsp;major&nbsp;rewrite.&lt;br&gt;<br>
&lt;br&gt;<br>
Scene&nbsp;Details:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;540k&nbsp;vertices&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;81000&nbsp;drawables&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;77000&nbsp;sorted&nbsp;drawables&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;81000&nbsp;fast&nbsp;drawables&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;5.&nbsp;81000&nbsp;primitive&nbsp;sets&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;6.&nbsp;100000&nbsp;triangles&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;7.&nbsp;37000&nbsp;quad&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;8.&nbsp;181000&nbsp;polygon&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;probably&nbsp;hurting&nbsp;a&nbsp;lot)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;9.&nbsp;26000&nbsp;unique&nbsp;state&nbsp;sets&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;10.&nbsp;73000&nbsp;instance&nbsp;state&nbsp;sets&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;11.&nbsp;28000&nbsp;groups&lt;br&gt;<br>
&lt;br&gt;<br>
Cull:&nbsp;113.50,&nbsp;Draw:&nbsp;390,&nbsp;GPU:&nbsp;355&nbsp;(never&nbsp;seen&nbsp;values&nbsp;this&nbsp;high&nbsp;on&nbsp;the&nbsp;forums)&lt;br&gt;<br>
Additionally&nbsp;the&nbsp;graph&nbsp;doesn't&nbsp;seem&nbsp;to&nbsp;rendering&nbsp;correctly;&nbsp;the&nbsp;largest&nbsp;&quot;bar&quot;&nbsp;is&nbsp;Cull&nbsp;and&nbsp;last&nbsp;~10%&nbsp;is&nbsp;the&nbsp;Draw,&nbsp;which&nbsp;doesnt&nbsp;seem&nbsp;to&nbsp;match&nbsp;the&nbsp;values.&nbsp;(Probably&nbsp;because&nbsp;a&nbsp;single&nbsp;frame&nbsp;takes&nbsp;so&nbsp;long?)<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Implementation&nbsp;Details:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;I&nbsp;am&nbsp;orthographic&nbsp;project&nbsp;as&nbsp;it&nbsp;is&nbsp;a&nbsp;&quot;CAD&quot;&nbsp;style&nbsp;application.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;Currently&nbsp;all&nbsp;objects&nbsp;are&nbsp;within&nbsp;Geode-&gt;Geometry&nbsp;nodes,&nbsp;each&nbsp;with&nbsp;their&nbsp;own&nbsp;vertex,&nbsp;color,&nbsp;and&nbsp;normal&nbsp;arrays.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;The&nbsp;main&nbsp;&quot;mode&quot;&nbsp;of&nbsp;the&nbsp;application&nbsp;is&nbsp;a&nbsp;&quot;ghosted&quot;&nbsp;mode&nbsp;which&nbsp;is&nbsp;applied&nbsp;to&nbsp;the&nbsp;walls&nbsp;of&nbsp;the&nbsp;model.&nbsp;Each&nbsp;wall&nbsp;has&nbsp;an&nbsp;osg::Material&nbsp;set&nbsp;to&nbsp;it&nbsp;and&nbsp;blending&nbsp;turned&nbsp;on.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;All&nbsp;objects&nbsp;are&nbsp;pickable&nbsp;and&nbsp;hold&nbsp;a&nbsp;variety&nbsp;of&nbsp;property&nbsp;data&nbsp;(extracted&nbsp;from&nbsp;the&nbsp;models&nbsp;file&nbsp;or&nbsp;the&nbsp;database).&nbsp;I&nbsp;have&nbsp;implemented&nbsp;&quot;picking&quot;&nbsp;using&nbsp;the&nbsp;PickHandler::pick&nbsp;example&nbsp;and&nbsp;code.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;5.&nbsp;A&nbsp;user&nbsp;often&nbsp;views&nbsp;the&nbsp;whole&nbsp;model&nbsp;from&nbsp;afar&nbsp;interacting&nbsp;with&nbsp;other&nbsp;Qt&nbsp;widgets&nbsp;and&nbsp;watch&nbsp;how&nbsp;the&nbsp;scene&nbsp;changes,&nbsp;occasionally&nbsp;they&nbsp;will&nbsp;zoom&nbsp;in&nbsp;on&nbsp;a&nbsp;section&nbsp;but&nbsp;are&nbsp;never&nbsp;&quot;inside&quot;&nbsp;the&nbsp;model.&nbsp;I&nbsp;can&nbsp;clearly&nbsp;see&nbsp;when&nbsp;view&nbsp;frustum&nbsp;culling&nbsp;is&nbsp;working&nbsp;when<br>
&nbsp;zooming&nbsp;in.&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;6.&nbsp;My&nbsp;graph&nbsp;is&nbsp;VERY&nbsp;flat.&nbsp;Nearly&nbsp;all&nbsp;object&nbsp;are&nbsp;attached&nbsp;to&nbsp;the&nbsp;root&nbsp;node&nbsp;(objects&nbsp;like&nbsp;cubes,&nbsp;cylinders,&nbsp;and&nbsp;meshes),&nbsp;when&nbsp;the&nbsp;rooms&nbsp;form&nbsp;a&nbsp;closed&nbsp;space&nbsp;I&nbsp;create&nbsp;a&nbsp;group&nbsp;node&nbsp;whos&nbsp;children&nbsp;are&nbsp;the&nbsp;walls.&nbsp;(I&nbsp;often&nbsp;rearranged&nbsp;it&nbsp;but&nbsp;never&nbsp;saw&nbsp;an&nbsp;performance<br>
&nbsp;changes&nbsp;from&nbsp;this)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;7.&nbsp;Anything&nbsp;else&nbsp;you&nbsp;need&nbsp;to&nbsp;know...&lt;br&gt;<br>
&lt;br&gt;<br>
Fairly&nbsp;certain&nbsp;my&nbsp;main&nbsp;problem&nbsp;is&nbsp;just&nbsp;the&nbsp;sheer&nbsp;number&nbsp;of&nbsp;draw&nbsp;calls&nbsp;the&nbsp;occur&nbsp;when&nbsp;my&nbsp;models&nbsp;get&nbsp;a&nbsp;decent&nbsp;amount&nbsp;(20,000&#43;)&nbsp;objects.&nbsp;It&nbsp;seems&nbsp;a&nbsp;remedy&nbsp;for&nbsp;this&nbsp;is&nbsp;to&nbsp;combine&nbsp;drawables&nbsp;and&nbsp;share&nbsp;one&nbsp;vertex&nbsp;array&nbsp;(correct?).&nbsp;&nbsp;Would&nbsp;this&nbsp;totally&nbsp;break&nbsp;the&nbsp;picking<br>
&nbsp;code?&nbsp;This&nbsp;application&nbsp;is&nbsp;designed&nbsp;to&nbsp;run&nbsp;on&nbsp;computers&nbsp;with&nbsp;&quot;buisness&quot;&nbsp;level&nbsp;GPU&nbsp;(example&nbsp;GeForce&nbsp;GT&nbsp;640)&nbsp;but&nbsp;sadly&nbsp;I&nbsp;have&nbsp;to&nbsp;use&nbsp;the&nbsp;nouveau&nbsp;drivers.<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Sorry&nbsp;for&nbsp;being&nbsp;so&nbsp;long&nbsp;winded&nbsp;by&nbsp;wanted&nbsp;to&nbsp;clearly&nbsp;lay&nbsp;down&nbsp;the&nbsp;situation&nbsp;for&nbsp;anyone&nbsp;that&nbsp;feels&nbsp;like&nbsp;helping.&nbsp;Also&nbsp;thanks&nbsp;a&nbsp;lot&nbsp;to&nbsp;anyone&nbsp;willing&nbsp;to&nbsp;help&nbsp;me&nbsp;out!&lt;br&gt;<br>
&lt;br&gt;<br>
~Oran&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
