<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#FFFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Thanks&nbsp;Robert!&nbsp;Works&nbsp;fine&nbsp;here&nbsp;as&nbsp;well,&nbsp;and&nbsp;I&nbsp;think&nbsp;the&nbsp;line&nbsp;of<br>
&nbsp;&nbsp;&nbsp;&nbsp;least&nbsp;resistance&nbsp;was&nbsp;the&nbsp;right&nbsp;way&nbsp;this&nbsp;time.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Any&nbsp;plans&nbsp;on&nbsp;a&nbsp;3.5.9&nbsp;release&nbsp;soon?&nbsp;I'm&nbsp;now&nbsp;facing&nbsp;the&nbsp;problem&nbsp;of<br>
&nbsp;&nbsp;&nbsp;&nbsp;either&nbsp;waiting&nbsp;until&nbsp;the&nbsp;next&nbsp;release,&nbsp;or&nbsp;basing&nbsp;my&nbsp;software&nbsp;on<br>
&nbsp;&nbsp;&nbsp;&nbsp;3.5.8&nbsp;with&nbsp;this&nbsp;modification&nbsp;and&nbsp;thus&nbsp;implicitly&nbsp;recommending&nbsp;users<br>
&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;use&nbsp;3.5.8&nbsp;to&nbsp;be&nbsp;compatible&nbsp;but&nbsp;with&nbsp;the&nbsp;implication&nbsp;that&nbsp;their<br>
&nbsp;&nbsp;&nbsp;&nbsp;OpenFlight&nbsp;models&nbsp;might&nbsp;be&nbsp;load&nbsp;slowly...&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;/Andreas&lt;font&nbsp;size=&quot;2&quot;&nbsp;color=&quot;black&quot;&gt;&lt;span<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;style=&quot;font-size:0.8em;color:black&quot;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/font&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;color=&quot;black&quot;&gt;&lt;span<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;style=&quot;font-size:0.8em;color:black&quot;&gt;&lt;/span&gt;&lt;/font&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-signature&quot;&gt;&lt;font&nbsp;size=&quot;2&quot;&nbsp;color=&quot;black&quot;&gt;&lt;span<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;style=&quot;font-size:0.8em;color:black&quot;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/font&gt;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;On&nbsp;2017-11-27&nbsp;17:25,&nbsp;Robert&nbsp;Osfield<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wrote:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;<br>
cite=&quot;mid:CAFN7Y+Ujzn=Ka6LGnGss8a1ddK3zpo3+sftiBFR4URDLeM6jOA@mail.gmail.com&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Hi&nbsp;Andreas,<br>
<br>
I&nbsp;have&nbsp;checked&nbsp;in&nbsp;a&nbsp;refactor&nbsp;of&nbsp;MergeGeometry&nbsp;visitor&nbsp;that&nbsp;makes&nbsp;it<br>
work&nbsp;properly&nbsp;with&nbsp;groups&nbsp;containing&nbsp;any&nbsp;type&nbsp;of&nbsp;nodes,&nbsp;and&nbsp;avoids&nbsp;the<br>
O(N^2)&nbsp;removChild()&nbsp;usage.&nbsp;&nbsp;In&nbsp;the&nbsp;end&nbsp;I&nbsp;took&nbsp;the&nbsp;line&nbsp;of&nbsp;least<br>
resistance&nbsp;and&nbsp;just&nbsp;used&nbsp;the&nbsp;approach&nbsp;of&nbsp;removing&nbsp;all&nbsp;children&nbsp;and<br>
adding&nbsp;back&nbsp;the&nbsp;ndoes.<br>
<br>
On&nbsp;27&nbsp;November&nbsp;2017&nbsp;at&nbsp;15:56,&nbsp;Andreas&nbsp;Ekstrand<br>
&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:andreas.ekstrand@remograph.com&quot;&gt;&lt;andreas.ekstrand@remograph.com&gt;&lt;/a&gt;&nbsp;wrote:<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Yes,&nbsp;you&nbsp;can&nbsp;argue&nbsp;that&nbsp;the&nbsp;dataset&nbsp;is&nbsp;awful,&nbsp;but&nbsp;it's&nbsp;actually&nbsp;just&nbsp;storing<br>
150k&nbsp;triangles&nbsp;on&nbsp;one&nbsp;graph&nbsp;level,&nbsp;as&nbsp;separate&nbsp;OpenFlight&nbsp;face&nbsp;records,<br>
which&nbsp;is&nbsp;what&nbsp;the&nbsp;OpenFlight&nbsp;file&nbsp;format&nbsp;offers&nbsp;if&nbsp;you&nbsp;don't&nbsp;use&nbsp;its<br>
specific&nbsp;mesh&nbsp;nodes&nbsp;that&nbsp;aren't&nbsp;supported&nbsp;by&nbsp;all&nbsp;tools&nbsp;and&nbsp;don't&nbsp;offer&nbsp;full<br>
control&nbsp;of&nbsp;each&nbsp;triangle.&nbsp;OpenFlight&nbsp;is&nbsp;a&nbsp;modeling&nbsp;file&nbsp;format&nbsp;which&nbsp;is<br>
surely&nbsp;not&nbsp;visualization-friendly.&nbsp;I&nbsp;think&nbsp;the&nbsp;OpenFlight&nbsp;plugin&nbsp;simply&nbsp;uses<br>
the&nbsp;Optimizer&nbsp;to&nbsp;convert&nbsp;this&nbsp;to&nbsp;a&nbsp;dataset&nbsp;for&nbsp;effective&nbsp;visualization<br>
instead&nbsp;of&nbsp;converting&nbsp;to&nbsp;a&nbsp;more&nbsp;optimal&nbsp;scene&nbsp;graph&nbsp;to&nbsp;start&nbsp;with&nbsp;-&nbsp;a&nbsp;choice<br>
that&nbsp;I&nbsp;can't&nbsp;really&nbsp;say&nbsp;if&nbsp;it's&nbsp;good&nbsp;or&nbsp;bad,&nbsp;but&nbsp;the&nbsp;Optimizer&nbsp;should&nbsp;of<br>
course&nbsp;handle&nbsp;bad&nbsp;data&nbsp;in&nbsp;the&nbsp;best&nbsp;way&nbsp;possible.<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;No&nbsp;need&nbsp;to&nbsp;argue&nbsp;whether&nbsp;it's&nbsp;awful&nbsp;or&nbsp;not,&nbsp;there&nbsp;isn't&nbsp;any&nbsp;debate<br>
when&nbsp;it&nbsp;comes&nbsp;to&nbsp;real-time&nbsp;performance&nbsp;:&nbsp;this&nbsp;particular&nbsp;database&nbsp;is<br>
stored&nbsp;in&nbsp;the&nbsp;worst&nbsp;possible&nbsp;way&nbsp;for&nbsp;memory&nbsp;utilization&nbsp;and<br>
performance<br>
<br>
Use&nbsp;of&nbsp;the&nbsp;osgUtil::Optimizer&nbsp;is&nbsp;a&nbsp;very&nbsp;crude&nbsp;fix&nbsp;for&nbsp;bad&nbsp;databases.<br>
It's&nbsp;far&nbsp;better&nbsp;to&nbsp;just&nbsp;create&nbsp;a&nbsp;scene&nbsp;graph&nbsp;in&nbsp;an&nbsp;efficient&nbsp;form<br>
right&nbsp;from&nbsp;the&nbsp;start.&nbsp;&nbsp;Optimizing&nbsp;bad&nbsp;databases&nbsp;at&nbsp;best&nbsp;leads&nbsp;to<br>
fragment&nbsp;memory,&nbsp;it&nbsp;really&nbsp;is&nbsp;just&nbsp;papering&nbsp;over&nbsp;cracks&nbsp;and&nbsp;is<br>
unlikely&nbsp;to&nbsp;ever&nbsp;produce&nbsp;optimal&nbsp;databases.<br>
<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;The&nbsp;main&nbsp;issue&nbsp;for&nbsp;me&nbsp;though,&nbsp;is&nbsp;that&nbsp;OSG&nbsp;handles&nbsp;this&nbsp;dataset&nbsp;in&nbsp;a&nbsp;much<br>
slower&nbsp;way&nbsp;than&nbsp;before,&nbsp;hence&nbsp;my&nbsp;re-introduction&nbsp;of&nbsp;the&nbsp;previous<br>
optimization.&nbsp;But&nbsp;you're&nbsp;completely&nbsp;right,&nbsp;and&nbsp;I&nbsp;realize&nbsp;now,&nbsp;that&nbsp;other<br>
nodes&nbsp;than&nbsp;drawables&nbsp;aren't&nbsp;handle&nbsp;correctly.&nbsp;I&nbsp;haven't&nbsp;gotten&nbsp;used&nbsp;to<br>
drawables&nbsp;being&nbsp;nodes&nbsp;yet...<br>
<br>
So&nbsp;the&nbsp;fact&nbsp;that&nbsp;the&nbsp;OpenFlight&nbsp;plugin&nbsp;creates&nbsp;a&nbsp;non-optimal&nbsp;scene&nbsp;graph&nbsp;and<br>
then&nbsp;uses&nbsp;the&nbsp;Optimizer&nbsp;itself&nbsp;to&nbsp;fix&nbsp;this&nbsp;is&nbsp;probably&nbsp;a&nbsp;separate&nbsp;and&nbsp;larger<br>
problem&nbsp;-&nbsp;if&nbsp;it&nbsp;indeed&nbsp;is&nbsp;a&nbsp;problem.<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Yep,&nbsp;big&nbsp;topic.&nbsp;&nbsp;I'm&nbsp;familiar&nbsp;with&nbsp;the&nbsp;problems&nbsp;that&nbsp;the&nbsp;OpenFlight<br>
loader&nbsp;generates,&nbsp;but&nbsp;less&nbsp;so&nbsp;with&nbsp;Creator&nbsp;or&nbsp;other&nbsp;tools&nbsp;that<br>
generate&nbsp;the&nbsp;content.&nbsp;&nbsp;I'd&nbsp;much&nbsp;rather&nbsp;the&nbsp;OpenFlight&nbsp;loader&nbsp;builds<br>
more&nbsp;efficient&nbsp;database&nbsp;to&nbsp;start&nbsp;with&nbsp;rather&nbsp;than&nbsp;rely&nbsp;upon&nbsp;the<br>
Optimizer&nbsp;to&nbsp;fix&nbsp;problems&nbsp;once&nbsp;the&nbsp;data&nbsp;is&nbsp;loaded.<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;But&nbsp;I&nbsp;believe&nbsp;it's&nbsp;necessary&nbsp;to&nbsp;at<br>
least&nbsp;get&nbsp;MergeGeometryVisitor&nbsp;to&nbsp;behave&nbsp;as&nbsp;fast&nbsp;as&nbsp;before,&nbsp;either&nbsp;by<br>
modifying&nbsp;my&nbsp;fixes&nbsp;or&nbsp;by&nbsp;rewriting&nbsp;parts&nbsp;of&nbsp;it.&nbsp;I&nbsp;hope&nbsp;you&nbsp;will&nbsp;find&nbsp;the<br>
time&nbsp;to&nbsp;decide&nbsp;on&nbsp;this&nbsp;soon,&nbsp;and&nbsp;please&nbsp;let&nbsp;me&nbsp;know&nbsp;if&nbsp;I&nbsp;can&nbsp;help!<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;The&nbsp;fix&nbsp;I&nbsp;have&nbsp;checked&nbsp;in&nbsp;master:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://github.com/openscenegraph/OpenSceneGraph/commit/bc4a9d9dd0158e1e99d0ca1d1d95ef204220a560&quot;&gt;https://github.com/openscenegraph/OpenSceneGraph/commit/bc4a9d9dd0158e1e99d0ca1d1d95ef204220a560&lt;/a&gt;<br>
<br>
With&nbsp;performance&nbsp;testing&nbsp;of&nbsp;just&nbsp;the&nbsp;merge&nbsp;geometry&nbsp;on&nbsp;your&nbsp;house<br>
dataset&nbsp;I&nbsp;saw&nbsp;a&nbsp;70sec&nbsp;merge&nbsp;geometry&nbsp;before,&nbsp;and&nbsp;0.1&nbsp;sec&nbsp;merge&nbsp;after<br>
my&nbsp;changes.<br>
<br>
I've&nbsp;got&nbsp;plenty&nbsp;of&nbsp;other&nbsp;stuff&nbsp;to&nbsp;get&nbsp;on&nbsp;with&nbsp;so&nbsp;I'll&nbsp;assume&nbsp;this<br>
issue&nbsp;is&nbsp;now&nbsp;resolved.<br>
<br>
Cheers,<br>
Robert.<br>
_______________________________________________<br>
osg-users&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:osg-users@lists.openscenegraph.org&quot;&gt;osg-users@lists.openscenegraph.org&lt;/a&gt;<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&quot;&gt;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&lt;/a&gt;<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
