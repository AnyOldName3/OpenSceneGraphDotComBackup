<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&#39;m&nbsp;still&nbsp;trying&nbsp;to&nbsp;get&nbsp;my&nbsp;head&nbsp;around&nbsp;using&nbsp;osgVolume.&nbsp;I&#39;m&nbsp;trying&nbsp;to&nbsp;read&nbsp;in&nbsp;uint8&nbsp;intensity&nbsp;data&nbsp;normalized&nbsp;to&nbsp;the&nbsp;range&nbsp;[0&nbsp;255]&nbsp;and&nbsp;then&nbsp;apply&nbsp;a&nbsp;transfer&nbsp;function&nbsp;to&nbsp;my&nbsp;data&nbsp;to&nbsp;map&nbsp;it&nbsp;to&nbsp;color&nbsp;and&nbsp;opacity.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;First,&nbsp;I&nbsp;start&nbsp;with&nbsp;the&nbsp;following&nbsp;function&nbsp;to&nbsp;construct&nbsp;my&nbsp;osg::Image&nbsp;object.&nbsp;I&nbsp;specify&nbsp;GL_LUMINANCE&nbsp;when&nbsp;using&nbsp;setImage&nbsp;to&nbsp;construct&nbsp;my&nbsp;image,&nbsp;and&nbsp;I&nbsp;provide&nbsp;a&nbsp;uint8_T&nbsp;*&nbsp;pointer&nbsp;to&nbsp;an&nbsp;existing&nbsp;memory&nbsp;allocation.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp;osg::Image*&nbsp;createTexture3D(const&nbsp;mxArray*&nbsp;src,&nbsp;const&nbsp;uint8_T*&nbsp;xfer_table)&nbsp;{&lt;/b&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp;  &lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp;if&nbsp;(src&nbsp;==&nbsp;NULL&nbsp;||&nbsp;mxGetNumberOfDimensions(src)&nbsp;!=&nbsp;3&nbsp;||&nbsp;mxGetClassID(src)&nbsp;!=&nbsp;mxUINT8_CLASS)&nbsp;{&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return&nbsp;NULL;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp;}&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp;  &lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp;size_t&nbsp;num_s&nbsp;=&nbsp;mxGetDimensions(src)[0];&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp;size_t&nbsp;num_t&nbsp;=&nbsp;mxGetDimensions(src)[1];&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp;size_t&nbsp;num_r&nbsp;=&nbsp;mxGetDimensions(src)[2];&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp;//&nbsp;now&nbsp;allocate&nbsp;the&nbsp;3d&nbsp;texture;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp;osg::ref_ptr&lt;osg::Image&gt;&nbsp;image_3d&nbsp;=&nbsp;new&nbsp;osg::Image;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp;  &lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp;image_3d-&gt;setImage(num_s,&nbsp;num_t,&nbsp;num_r, &lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;GL_LUMINANCE,&nbsp;GL_LUMINANCE,&nbsp;GL_UNSIGNED_BYTE,&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;static_cast&lt;uint8_T&nbsp;*&gt;(mxGetData(src)),&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;osg::Image::NO_DELETE);&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp;  &lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp;return&nbsp;image_3d.release();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp;}&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;I&nbsp;pass&nbsp;this&nbsp;data&nbsp;into&nbsp;a&nbsp;layer&nbsp;in&nbsp;osgVolume&nbsp;and&nbsp;use&nbsp;FixedFunctionTechnique,&nbsp;I&nbsp;see&nbsp;a&nbsp;grayscale&nbsp;visualization&nbsp;in&nbsp;which&nbsp;it&nbsp;appears&nbsp;both&nbsp;the&nbsp;gray&nbsp;level&nbsp;and&nbsp;opacity&nbsp;are&nbsp;determine&nbsp;by&nbsp;the&nbsp;scalar&nbsp;intensity&nbsp;value.&nbsp;Good&nbsp;so&nbsp;far.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Next,&nbsp;I&nbsp;attempt&nbsp;to&nbsp;specify&nbsp;a&nbsp;given&nbsp;transfer&nbsp;function.&nbsp;My&nbsp;transfer&nbsp;function&nbsp;is&nbsp;float&nbsp;in&nbsp;the&nbsp;range&nbsp;[0&nbsp;1],&nbsp;and&nbsp;I&#39;m&nbsp;sure&nbsp;that&nbsp;the&nbsp;values&nbsp;in&nbsp;my&nbsp;transfer&nbsp;function&nbsp;are&nbsp;correct,&nbsp;I&#39;ve&nbsp;looked. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;attempt&nbsp;to&nbsp;use&nbsp;osgVolume::applyTransferFunction&nbsp;to&nbsp;apply&nbsp;a&nbsp;transfer&nbsp;function&nbsp;to&nbsp;my&nbsp;existing&nbsp;osg::Image&nbsp;to&nbsp;obtain&nbsp;a&nbsp;new&nbsp;osg::Image&nbsp;that&nbsp;RGBA.&nbsp;When&nbsp;I&nbsp;do&nbsp;this,&nbsp;nothing&nbsp;renders,&nbsp;blank&nbsp;screen.&nbsp;What&nbsp;am&nbsp;I&nbsp;doing&nbsp;wrong?&lt;/div&gt;&lt;div&gt;&lt;div&gt; &lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt; &lt;b&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;osg::TransferFunction1D::ColorMap&nbsp;colorMap;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for&nbsp;(size_t&nbsp;r&nbsp;=&nbsp;0;&nbsp;r&nbsp;&lt;&nbsp;256;&nbsp;++r){&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;size_t&nbsp;rowOffset&nbsp;=&nbsp;r*4;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;float&nbsp;red&nbsp;=&nbsp;static_cast&lt;float&gt;(xfer_table[rowOffset])/255.0;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;float&nbsp;green&nbsp;=&nbsp;static_cast&lt;float&gt;(xfer_table[rowOffset+1])/255.0;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;float&nbsp;blue&nbsp;=&nbsp;static_cast&lt;float&gt;(xfer_table[rowOffset+2])/255.0;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;float&nbsp;alpha&nbsp;=&nbsp;static_cast&lt;float&gt;(xfer_table[rowOffset+3])/255.0;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;std::cout&nbsp;&lt;&lt;&nbsp;&quot;red:&nbsp;&quot;&nbsp;&lt;&lt;&nbsp;red&nbsp;&lt;&lt;&nbsp;&quot;green:&nbsp;&quot;&nbsp;&lt;&lt;&nbsp;green&nbsp;&lt;&lt;&nbsp;&quot;blue:&nbsp;&quot;&nbsp;&lt;&lt;&nbsp;blue&nbsp;&lt;&lt;&nbsp;&quot;alpha:&nbsp;&quot;&nbsp;&lt;&lt;&nbsp;alpha&nbsp;&lt;&lt;&nbsp;std::endl;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;colorMap[r]&nbsp;=&nbsp;osg::Vec4(red,green,blue,alpha);&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;osg::ref_ptr&lt;osg::TransferFunction1D&gt;&nbsp;transferFunction&nbsp;=&nbsp;new&nbsp;osg::TransferFunction1D;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;transferFunction-&gt;assign(colorMap);&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;osg::ref_ptr&lt;osgVolume::VolumeTile&gt;&nbsp;tile&nbsp;=&nbsp;new&nbsp;osgVolume::VolumeTile;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;volume-&gt;addChild(tile.get());&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;osg::ref_ptr&lt;osg::Image&gt;&nbsp;image_3d&nbsp;=&nbsp;createTexture3D(data,xfer_table);&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;osg::ref_ptr&lt;osg::Image&gt;&nbsp;image_3d_mapped&nbsp;=&nbsp;osgVolume::applyTransferFunction(image_3d.get(),transferFunction.get());&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;Looking&nbsp;at&nbsp;the&nbsp;shipping&nbsp;example:&nbsp;osgvolume.cpp,&nbsp;I&#39;m&nbsp;using&nbsp;the&nbsp;applyTransferFunction&nbsp;the&nbsp;same&nbsp;way,&nbsp;and&nbsp;it&nbsp;appears&nbsp;that&nbsp;the&nbsp;expected&nbsp;normalization&nbsp;for&nbsp;entries&nbsp;in&nbsp;the&nbsp;LUT&nbsp;is&nbsp;[0,1.0]&nbsp;float,&nbsp;which&nbsp;I&#39;m&nbsp;doing.&nbsp;I&#39;m&nbsp;clearly&nbsp;doing&nbsp;something&nbsp;wrong&nbsp;with&nbsp;applyTransferFunction,&nbsp;because&nbsp;when&nbsp;I&nbsp;remove&nbsp;the&nbsp;use&nbsp;of&nbsp;applyTransferFunction&nbsp;and&nbsp;pass&nbsp;image_3d&nbsp;into&nbsp;the&nbsp;Layer&nbsp;instead&nbsp;of&nbsp;image_3d_mapped,&nbsp;I&nbsp;do&nbsp;get&nbsp;a&nbsp;&quot;correctly&quot;&nbsp;rendered&nbsp;grayscale&nbsp;with&nbsp;the&nbsp;opacity&nbsp;determined&nbsp;by&nbsp;the&nbsp;scalar&nbsp;intensity.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Is&nbsp;there&nbsp;anything&nbsp;that&nbsp;jumps&nbsp;out&nbsp;at&nbsp;anyone?&nbsp;I&nbsp;can&nbsp;provide&nbsp;a&nbsp;more&nbsp;complete&nbsp;code&nbsp;listing&nbsp;if&nbsp;that&nbsp;would&nbsp;help,&nbsp;I&nbsp;thought&nbsp;it&nbsp;best&nbsp;to&nbsp;try&nbsp;to&nbsp;make&nbsp;the&nbsp;code&nbsp;as&nbsp;stripped&nbsp;down&nbsp;as&nbsp;possible.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Alex&lt;/div&gt;&lt;/div&gt;<br>

</tt>
