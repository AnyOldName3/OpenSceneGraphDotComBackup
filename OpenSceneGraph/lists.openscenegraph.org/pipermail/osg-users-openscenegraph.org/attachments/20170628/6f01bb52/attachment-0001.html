<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Hi&nbsp;all,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&#39;s&nbsp;a&nbsp;problem&nbsp;with&nbsp;osgShadow.&lt;/div&gt;I&nbsp;hava&nbsp;a&nbsp;scene&nbsp;with&nbsp;multiple&nbsp;pagedLOD&nbsp;models&nbsp;bundled&nbsp;in&nbsp;a&nbsp;group.&nbsp;The&nbsp;models&nbsp;are&nbsp;tiles&nbsp;of&nbsp;a&nbsp;city,&nbsp;and&nbsp;each&nbsp;tile&nbsp;is&nbsp;a&nbsp;single&nbsp;model&nbsp;(buildings&nbsp;are&nbsp;not&nbsp;separeted&nbsp;with&nbsp;terrain). &lt;div&gt;I&nbsp;uses&nbsp;the&nbsp;code&nbsp;in&nbsp;the&nbsp;osgShadow&nbsp;example&nbsp;for&nbsp;shadowing,&nbsp;and&nbsp;put&nbsp;a&nbsp;point&nbsp;light&nbsp;in&nbsp;_shadowedScene.&nbsp;The&nbsp;models&nbsp;shadow&nbsp;on&nbsp;themselves.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&gt;As&nbsp;the&nbsp;attached&nbsp;image&nbsp;shows,&nbsp;the&nbsp;shadow&nbsp;result&nbsp;is&nbsp;partially&nbsp;correct.&nbsp;In&nbsp;some&nbsp;particular&nbsp;angle&nbsp;range&nbsp;from&nbsp;the&nbsp;light&nbsp;source,&nbsp;the&nbsp;correct&nbsp;shadow&nbsp;is&nbsp;casted.&nbsp;But&nbsp;in&nbsp;the&nbsp;other&nbsp;range,&nbsp;shadow&nbsp;is&nbsp;not&nbsp;cast&nbsp;correctly,&nbsp;but&nbsp;some&nbsp;strange&nbsp;shadows&nbsp;appear&nbsp;which&nbsp;I&nbsp;guess&nbsp;is&nbsp;casted&nbsp;from&nbsp;the&nbsp;model&nbsp;at&nbsp;the&nbsp;other&nbsp;side.&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Also,&nbsp;if&nbsp;I&nbsp;put&nbsp;the&nbsp;light&nbsp;on&nbsp;one&nbsp;side&nbsp;of&nbsp;the&nbsp;building,&nbsp;the&nbsp;other&nbsp;side&nbsp;of&nbsp;it&nbsp;is&nbsp;still&nbsp;lit,&nbsp;no&nbsp;shadow&nbsp;showing.&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;tried&nbsp;different&nbsp;shadow&nbsp;implementations,&nbsp;but&nbsp;the&nbsp;results&nbsp;remain&nbsp;almost&nbsp;the&nbsp;same.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;can&#39;t&nbsp;figure&nbsp;out&nbsp;what&nbsp;is&nbsp;happening&nbsp;since&nbsp;the&nbsp;shadow&nbsp;is&nbsp;just&nbsp;&#39;partially&#39;&nbsp;abnormal.&nbsp;Stuck&nbsp;here&nbsp;for&nbsp;days.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;Thanks.&nbsp;&lt;br&gt;&lt;br&gt;Regards,&nbsp;&lt;br&gt;tqjxlm.&nbsp;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;osg&nbsp;version&nbsp;3.4.0.&lt;/div&gt;&lt;div&gt;code:&lt;/div&gt;&lt;div&gt;&lt;div&gt;------------------------------&lt;wbr&gt;------------------------------&lt;wbr&gt;------------------------------&lt;wbr&gt;------------------------------&lt;wbr&gt;------------------------------&lt;wbr&gt;---------------&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;u&gt;Shadow&lt;/u&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt; //&nbsp;arguments&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;/span&gt; char*&nbsp;argv[]&nbsp;=&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;&quot;--vdsm&quot;,&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;&quot;--positionalLight&quot;,&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;&quot;--ortho&quot;,&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;&quot;--parallel-split&quot;,&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;&quot;--num-sm&quot;,&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;&quot;4&quot;,&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;&quot;--cascaded&quot;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;};&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&nbsp;int&nbsp;argc&nbsp;=&nbsp;sizeof(argv)&nbsp;/&nbsp;sizeof(argv[0]);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&nbsp;//&nbsp;use&nbsp;an&nbsp;ArgumentParser&nbsp;object&nbsp;to&nbsp;manage&nbsp;the&nbsp;program&nbsp;arguments&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;osg::ArgumentParser&nbsp;arguments(&amp;argc,&nbsp;argv);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;//&nbsp;get&nbsp;the&nbsp;viewer&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;osgViewer::View&amp;&nbsp;viewer&nbsp;=&nbsp;getViewer();&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&nbsp;//&nbsp;init&nbsp;shadowed&nbsp;scene&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;_shadowedScene&nbsp;=&nbsp;new&nbsp;osgShadow::ShadowedScene;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;osgShadow::ShadowSettings*&nbsp;settings&nbsp;=&nbsp;_shadowedScene-&gt;getShadowSetti&lt;wbr&gt;ngs();&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;settings-&gt;setReceivesShadowTra&lt;wbr&gt;versalMask(&lt;wbr&gt;ReceivesShadowTraversalMask);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;settings-&gt;setCastsShadowTraver&lt;wbr&gt;salMask(CastsShadowTraversalMa&lt;wbr&gt;sk);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;double&nbsp;distance;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;if&nbsp;(arguments.read(&quot;--max-shadow-&lt;wbr&gt;distance&quot;,&nbsp;distance))&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;settings-&gt;setMaximumShadowMapD&lt;wbr&gt;istance(distance);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;//&nbsp;choose&nbsp;shadow&nbsp;map&nbsp;implementation&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&nbsp;osg::ref_ptr&lt;osgShadow::Minima&lt;wbr&gt;lShadowMap&gt;&nbsp;msm&nbsp;=&nbsp;NULL;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;if&nbsp;(arguments.read(&quot;--no-shadows&quot;&lt;wbr&gt;))&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;OSG_NOTICE&nbsp;&lt;&lt;&nbsp;&quot;Not&nbsp;using&nbsp;a&nbsp;ShadowTechnique&quot;&nbsp;&lt;&lt;&nbsp;std::endl;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;_shadowedScene-&gt;setShadowTechn&lt;wbr&gt;ique(0);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&lt;/span&gt;&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;else&nbsp;if&nbsp;(arguments.read(&quot;--stsm&quot;))&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&lt;/span&gt;&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;osg::ref_ptr&lt;osgShadow::Standa&lt;wbr&gt;rdShadowMap&gt;&nbsp;st&nbsp;=&nbsp;new&nbsp;osgShadow::StandardShadowMap;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;_shadowedScene-&gt;setShadowTechn&lt;wbr&gt;ique(st.get());&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;else&nbsp;if&nbsp;(arguments.read(&quot;--pssm&quot;))&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&lt;/span&gt;&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;int&nbsp;mapcount&nbsp;=&nbsp;3;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--mapcount&quot;,&nbsp;mapcount));&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;osg::ref_ptr&lt;osgShadow::Parall&lt;wbr&gt;elSplitShadowMap&gt;&nbsp;pssm&nbsp;=&nbsp;new&nbsp;osgShadow::ParallelSplitShadow&lt;wbr&gt;Map(NULL,&nbsp;mapcount);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;int&nbsp;mapres&nbsp;=&nbsp;1024;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--mapres&quot;,&nbsp;mapres))&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;pssm-&gt;setTextureResolution(map&lt;wbr&gt;res);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--debug-color&lt;wbr&gt;&quot;))&nbsp;{&nbsp;pssm-&gt;setDebugColorOn();&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;int&nbsp;minNearSplit&nbsp;=&nbsp;0;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--minNearSpli&lt;wbr&gt;t&quot;,&nbsp;minNearSplit))&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;if&nbsp;(minNearSplit&nbsp;&gt;&nbsp;0)&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;pssm-&gt;setMinNearDistanceForSpl&lt;wbr&gt;its(minNearSplit);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;int&nbsp;maxfardist&nbsp;=&nbsp;0;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--maxFarDist&quot;&lt;wbr&gt;,&nbsp;maxfardist))&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;if&nbsp;(maxfardist&nbsp;&gt;&nbsp;0)&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;pssm-&gt;setMaxFarDistance(maxfar&lt;wbr&gt;dist);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;std::cout&nbsp;&lt;&lt;&nbsp;&quot;ParallelSplitShadowMap&nbsp;:&nbsp;setMaxFarDistance(&quot;&nbsp;&lt;&lt;&nbsp;maxfardist&nbsp;&lt;&lt;&nbsp;&quot;)&quot;&nbsp;&lt;&lt;&nbsp;std::endl;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;int&nbsp;moveVCamFactor&nbsp;=&nbsp;0;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--moveVCamFac&lt;wbr&gt;tor&quot;,&nbsp;moveVCamFactor))&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;if&nbsp;(maxfardist&nbsp;&gt;&nbsp;0)&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;pssm-&gt;setMoveVCamBehindRCamFac&lt;wbr&gt;tor(moveVCamFactor);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;double&nbsp;polyoffsetfactor&nbsp;=&nbsp;pssm-&gt;getPolygonOffset().x();&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;double&nbsp;polyoffsetunit&nbsp;=&nbsp;pssm-&gt;getPolygonOffset().y();&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--PolyOffset-&lt;wbr&gt;Factor&quot;,&nbsp;polyoffsetfactor));&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--PolyOffset-&lt;wbr&gt;Unit&quot;,&nbsp;polyoffsetunit));&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;pssm-&gt;setPolygonOffset(osg::Ve&lt;wbr&gt;c2(polyoffsetfactor,&nbsp;polyoffsetunit));&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;_shadowedScene-&gt;setShadowTechn&lt;wbr&gt;ique(pssm.get());&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;else&nbsp;if&nbsp;(arguments.read(&quot;--ssm&quot;))&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;osg::ref_ptr&lt;osgShadow::SoftSh&lt;wbr&gt;adowMap&gt;&nbsp;sm&nbsp;=&nbsp;new&nbsp;osgShadow::SoftShadowMap;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;_shadowedScene-&gt;setShadowTechn&lt;wbr&gt;ique(sm.get());&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;else&nbsp;if&nbsp;(arguments.read(&quot;--vdsm&quot;))&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&lt;/span&gt;&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--debugHUD&quot;))&nbsp;settings-&gt;setDebugDraw(true);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;if&nbsp;(arguments.read(&quot;--persp&quot;))&nbsp;settings-&gt;setShadowMapProjecti&lt;wbr&gt;onHint(osgShadow::&lt;wbr&gt;ShadowSettings::PERSPECTIVE_&lt;wbr&gt;SHADOW_MAP);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;if&nbsp;(arguments.read(&quot;--ortho&quot;))&nbsp;settings-&gt;setShadowMapProjecti&lt;wbr&gt;onHint(osgShadow::&lt;wbr&gt;ShadowSettings::ORTHOGRAPHIC_&lt;wbr&gt;SHADOW_MAP);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;unsigned&nbsp;int&nbsp;unit&nbsp;=&nbsp;1;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;if&nbsp;(arguments.read(&quot;--unit&quot;,&nbsp;unit))&nbsp;settings-&gt;setBaseShadowTexture&lt;wbr&gt;Unit(unit);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;double&nbsp;n&nbsp;=&nbsp;0.0;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;if&nbsp;(arguments.read(&quot;-n&quot;,&nbsp;n))&nbsp;settings-&gt;setMinimumShadowMapN&lt;wbr&gt;earFarRatio(n);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;unsigned&nbsp;int&nbsp;numShadowMaps;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;if&nbsp;(arguments.read(&quot;--num-sm&quot;,&nbsp;numShadowMaps))&nbsp;settings-&gt;setNumShadowMapsPerL&lt;wbr&gt;ight(numShadowMaps);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;if&nbsp;(arguments.read(&quot;--parallel-sp&lt;wbr&gt;lit&quot;)&nbsp;||&nbsp;arguments.read(&quot;--ps&quot;))&nbsp;settings-&gt;setMultipleShadowMap&lt;wbr&gt;Hint(osgShadow::&lt;wbr&gt;ShadowSettings::PARALLEL_&lt;wbr&gt;SPLIT);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;if&nbsp;(arguments.read(&quot;--cascaded&quot;))&nbsp;settings-&gt;setMultipleShadowMap&lt;wbr&gt;Hint(osgShadow::&lt;wbr&gt;ShadowSettings::CASCADED);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;int&nbsp;mapres&nbsp;=&nbsp;1024;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--mapres&quot;,&nbsp;mapres))&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;settings-&gt;setTextureSize(osg::&lt;wbr&gt;Vec2s(mapres,&nbsp;mapres));&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;osg::ref_ptr&lt;osgShadow::ViewDe&lt;wbr&gt;pendentShadowMap&gt;&nbsp;vdsm&nbsp;=&nbsp;new&nbsp;osgShadow::ViewDependentShadow&lt;wbr&gt;Map;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;_shadowedScene-&gt;setShadowTechn&lt;wbr&gt;ique(vdsm.get());&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;else&nbsp;if&nbsp;(arguments.read(&quot;--lispsm&quot;))&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;if&nbsp;(arguments.read(&quot;--ViewBounds&quot;&lt;wbr&gt;))&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;msm&nbsp;=&nbsp;new&nbsp;osgShadow::LightSpacePerspecti&lt;wbr&gt;veShadowMapVB;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;else&nbsp;if&nbsp;(arguments.read(&quot;--CullBounds&quot;&lt;wbr&gt;))&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;msm&nbsp;=&nbsp;new&nbsp;osgShadow::LightSpacePerspecti&lt;wbr&gt;veShadowMapCB;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;else&nbsp;//&nbsp;if(&nbsp;arguments.read(&nbsp;&quot;--DrawBounds&quot;&nbsp;)&nbsp;)&nbsp;//&nbsp;default&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;msm&nbsp;=&nbsp;new&nbsp;osgShadow::LightSpacePerspecti&lt;wbr&gt;veShadowMapDB;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;else&nbsp;if&nbsp;(arguments.read(&quot;--msm&quot;))&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;if&nbsp;(arguments.read(&quot;--ViewBounds&quot;&lt;wbr&gt;))&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;msm&nbsp;=&nbsp;new&nbsp;osgShadow::MinimalShadowMap;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;else&nbsp;if&nbsp;(arguments.read(&quot;--CullBounds&quot;&lt;wbr&gt;))&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;msm&nbsp;=&nbsp;new&nbsp;osgShadow::MinimalCullBoundsSh&lt;wbr&gt;adowMap;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;else&nbsp;//&nbsp;if(&nbsp;arguments.read(&nbsp;&quot;--DrawBounds&quot;&nbsp;)&nbsp;)&nbsp;//&nbsp;default&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;msm&nbsp;=&nbsp;new&nbsp;osgShadow::MinimalDrawBoundsSh&lt;wbr&gt;adowMap;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;else&nbsp;/*&nbsp;if&nbsp;(arguments.read(&quot;--sm&quot;))&nbsp;*/&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;osg::ref_ptr&lt;osgShadow::Shadow&lt;wbr&gt;Map&gt;&nbsp;sm&nbsp;=&nbsp;new&nbsp;osgShadow::ShadowMap;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;_shadowedScene-&gt;setShadowTechn&lt;wbr&gt;ique(sm.get());&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;int&nbsp;mapres&nbsp;=&nbsp;1024;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--mapres&quot;,&nbsp;mapres))&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;sm-&gt;setTextureSize(osg::Vec2s(&lt;wbr&gt;mapres,&nbsp;mapres));&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;if&nbsp;(msm)//&nbsp;Set&nbsp;common&nbsp;MSM&nbsp;&amp;&nbsp;LISPSM&nbsp;arguments&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;{&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;_shadowedScene-&gt;setShadowTechn&lt;wbr&gt;ique(msm.get());&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--debugHUD&quot;))&nbsp;msm-&gt;setDebugDraw(true);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;float&nbsp;minLightMargin&nbsp;=&nbsp;10.f;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;float&nbsp;maxFarPlane&nbsp;=&nbsp;0;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;unsigned&nbsp;int&nbsp;texSize&nbsp;=&nbsp;1024;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;unsigned&nbsp;int&nbsp;baseTexUnit&nbsp;=&nbsp;0;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;unsigned&nbsp;int&nbsp;shadowTexUnit&nbsp;=&nbsp;1;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--moveVCamFac&lt;wbr&gt;tor&quot;,&nbsp;minLightMargin));&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--minLightMar&lt;wbr&gt;gin&quot;,&nbsp;minLightMargin));&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--maxFarDist&quot;&lt;wbr&gt;,&nbsp;maxFarPlane));&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--mapres&quot;,&nbsp;texSize));&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--baseTexture&lt;wbr&gt;Unit&quot;,&nbsp;baseTexUnit));&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--shadowTextu&lt;wbr&gt;reUnit&quot;,&nbsp;shadowTexUnit));&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;msm-&gt;setMinLightMargin(minLigh&lt;wbr&gt;tMargin);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;msm-&gt;setMaxFarPlane(maxFarPlan&lt;wbr&gt;e);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;msm-&gt;setTextureSize(osg::Vec2s&lt;wbr&gt;(texSize,&nbsp;texSize));&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;msm-&gt;setShadowTextureCoordInde&lt;wbr&gt;x(shadowTexUnit);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;msm-&gt;setShadowTextureUnit(shad&lt;wbr&gt;owTexUnit);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;msm-&gt;setBaseTextureCoordIndex(&lt;wbr&gt;baseTexUnit);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;msm-&gt;setBaseTextureUnit(baseTe&lt;wbr&gt;xUnit);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;//&nbsp;init&nbsp;light&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;osg::Vec4&nbsp;lightpos(0.0,&nbsp;0.0,&nbsp;1,&nbsp;0.0);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;bool&nbsp;spotlight&nbsp;=&nbsp;false;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--positionalL&lt;wbr&gt;ight&quot;))&nbsp;{&nbsp;lightpos.set(0.5,&nbsp;0.5,&nbsp;1.5,&nbsp;1.0);&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--directional&lt;wbr&gt;Light&quot;))&nbsp;{&nbsp;lightpos.set(0.0,&nbsp;0.0,&nbsp;1,&nbsp;0.0);&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;while&nbsp;(arguments.read(&quot;--spotLight&quot;)&lt;wbr&gt;)&nbsp;{&nbsp;lightpos.set(0.5,&nbsp;0.5,&nbsp;1.5,&nbsp;1.0);&nbsp;spotlight&nbsp;=&nbsp;true;&nbsp;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&lt;/span&gt; //&nbsp;set&nbsp;light&nbsp;position,&nbsp;create&nbsp;a&nbsp;light&nbsp;ball&nbsp;for&nbsp;visualization&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;osg::ref_ptr&lt;osg::Geode&gt;&nbsp;coord&nbsp;=&nbsp;createIndicator(_intersectedPo&lt;wbr&gt;int);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;_lsIndicator&nbsp;=&nbsp;dynamic_cast&lt;osg::ShapeDrawabl&lt;wbr&gt;e*&gt;(coord-&gt;getDrawable(0));&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&lt;/span&gt;&nbsp;_worldRoot-&gt;addChild(coord);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;_ls&nbsp;=&nbsp;new&nbsp;osg::LightSource;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&nbsp;_ls-&gt;getLight()-&gt;setPosition(l&lt;wbr&gt;ightpos);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt; _ls-&gt;getLight()-&gt;setAmbient(o&lt;wbr&gt;sg::Vec4(0.7,&nbsp;0.7,&nbsp;0.7,&nbsp;1.0));&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt; _ls-&gt;getLight()-&gt;setDiffuse(o&lt;wbr&gt;sg::Vec4(0.8,&nbsp;0.8,&nbsp;0.8,&nbsp;1.0));&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;//&nbsp;set&nbsp;shadowed&nbsp;model&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;_model&nbsp;=&nbsp;_loadedModels;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt; _nodeMask&nbsp;=&nbsp;_model-&gt;getNodeMask();&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;_model-&gt;setNodeMask(_nodeMask&nbsp;|&nbsp;CastsShadowTraversalMask&nbsp;|&nbsp;ReceivesShadowTraversalMask);&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;_shadowedScene-&gt;addChild(_mode&lt;wbr&gt;l.get());&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&nbsp;_shadowedScene-&gt;addChild(_ls.g&lt;wbr&gt;et());&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&lt;/span&gt; _root-&gt;addChild(_shadowedScen&lt;wbr&gt;e);&lt;/div&gt;&lt;/div&gt;&lt;div&gt;------------------------------&lt;wbr&gt;------------------------------&lt;wbr&gt;------------------------------&lt;wbr&gt;------------------------------&lt;wbr&gt;------------------------------&lt;wbr&gt;---------------&lt;/div&gt;&lt;div&gt;&lt;u&gt;View&nbsp;initialization&lt;/u&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;osg::StateSet*&nbsp;state&nbsp;=&nbsp;_root-&gt;getOrCreateStateSet();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state-&gt;setMode(GL_DEPTH_TEST,&nbsp;osg::StateAttribute::ON);&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;osg::ref_ptr&lt;osgViewer::View&gt;&nbsp;view&nbsp;=&nbsp;new&nbsp;osgViewer::View;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;osg::Camera*&nbsp;camera&nbsp;=&nbsp;view-&gt;getCamera();&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;/span&gt;camera-&gt;setGraphicsContext(&nbsp;gw&nbsp;);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&lt;/span&gt;const&nbsp;osg::GraphicsContext::Traits*&nbsp;traits&nbsp;=&nbsp;gw-&gt;getTraits();&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;camera-&gt;setClearColor(&nbsp;osg::Vec4(1.0,&nbsp;1.0,&nbsp;1.0,&nbsp;1.0)&nbsp;);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;camera-&gt;setViewport(&nbsp;new&nbsp;osg::Viewport(0,&nbsp;0,&nbsp;traits-&gt;width,&nbsp;traits-&gt;height)&nbsp;);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;camera-&gt;setProjectionMatrixAsP&lt;wbr&gt;erspective(&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;30.0f,&nbsp;static_cast&lt;double&gt;(traits-&gt;wi&lt;wbr&gt;dth)/static_cast&lt;double&gt;(trait&lt;wbr&gt;s-&gt;height),&nbsp;0.1f,&nbsp;100000.0f&nbsp;);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;camera-&gt;setComputeNearFarMode(&lt;wbr&gt;osg::Camera::COMPUTE_NEAR_FAR_&lt;wbr&gt;USING_BOUNDING_VOLUMES);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&lt;/span&gt;camera-&gt;setNearFarRatio(0.0000&lt;wbr&gt;02);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;GLuint&nbsp;buffer&nbsp;=&nbsp;gw-&gt;getTraits()-&gt;doubleBuffer&nbsp;?&nbsp;GL_BACK&nbsp;:&nbsp;GL_FRONT;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;camera-&gt;setReadBuffer(buffer);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;camera-&gt;setDrawBuffer(buffer);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;view-&gt;setSceneData(&nbsp;scene&nbsp;);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;view-&gt;addEventHandler(new&nbsp;osgViewer::StatsHandler);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;view-&gt;addEventHandler(new&nbsp;osgViewer::ThreadingHandler);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;view-&gt;addEventHandler(new&nbsp;osgViewer::WindowSizeHandler);&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;m_-4240251802089280156m_-6138407011493892366gmail-Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre-wrap&quot;&gt;&nbsp;&nbsp;&nbsp;&lt;/span&gt;view-&gt;addEventHandler(new&nbsp;osgViewer::LODScaleHandler);&lt;/div&gt;&lt;div&gt;&lt;div&gt;------------------------------&lt;wbr&gt;------------------------------&lt;wbr&gt;------------------------------&lt;wbr&gt;------------------------------&lt;wbr&gt;------------------------------&lt;wbr&gt;---------------&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;And&nbsp;the&nbsp;screen&nbsp;shots:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Strange&nbsp;shadow&nbsp;on&nbsp;a&nbsp;square.&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;img&nbsp;src=&quot;https://i.imgbox.com/o570lsHN.png&quot;&nbsp;width=&quot;562&quot;&nbsp;height=&quot;322&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;No&nbsp;shadow&nbsp;of&nbsp;the&nbsp;flag.&lt;/div&gt;&lt;div&gt;&lt;img&nbsp;src=&quot;https://i.imgbox.com/9i8kNVAi.png&quot;&nbsp;style=&quot;margin-right:&nbsp;0px;&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Change&nbsp;light&nbsp;position,&nbsp;flag&nbsp;is&nbsp;shadowed&nbsp;correctly.&lt;br&gt;&lt;img&nbsp;src=&quot;https://i.imgbox.com/htSoUnpB.png&quot;&nbsp;style=&quot;margin-right:&nbsp;0px;&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Light&nbsp;on&nbsp;a&nbsp;build&nbsp;wall.&lt;br&gt;&lt;img&nbsp;src=&quot;https://i.imgbox.com/4qAb648k.png&quot;&nbsp;style=&quot;margin-right:&nbsp;0px;&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;back&nbsp;side&nbsp;should&nbsp;not&nbsp;be&nbsp;lit.&lt;br&gt;&lt;img&nbsp;src=&quot;https://i.imgbox.com/AOReMIZV.png&quot;&nbsp;style=&quot;margin-right:&nbsp;0px;&quot;&gt;&lt;br&gt;&lt;br&gt;​&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
