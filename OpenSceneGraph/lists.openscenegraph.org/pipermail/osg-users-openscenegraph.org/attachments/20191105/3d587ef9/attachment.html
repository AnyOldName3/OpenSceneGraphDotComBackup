<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;Community,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;implement&nbsp;4.4&nbsp;Persistent&nbsp;Mapping&nbsp;Streaming,&nbsp;within&nbsp;the&nbsp;context &nbsp;of&nbsp;OSG.&nbsp;Bellow&nbsp;is&nbsp;from&nbsp;the&nbsp;spec.&nbsp;I&nbsp;am&nbsp;struggling&nbsp;at&nbsp;the&nbsp;moment&nbsp;with&nbsp;making&nbsp;the&nbsp;buffer&nbsp;object&nbsp;sections,&nbsp;with&nbsp;the&nbsp;current&nbsp;OSG&nbsp;implementation&nbsp;and&nbsp;not&nbsp;sure&nbsp;if&nbsp;it&nbsp;is&nbsp;possible&nbsp;so&nbsp;I&nbsp;am&nbsp;asking&nbsp;here&nbsp;for&nbsp;hints&nbsp;if&nbsp;any&nbsp;of&nbsp;you&nbsp;have&nbsp;done&nbsp;something&nbsp;similar.&nbsp;Thanks&nbsp;a&nbsp;bunch&nbsp;as always!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;h2&nbsp;style=&quot;color:rgb(0,0,0);background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial;font-weight:normal;margin:1em&nbsp;0px&nbsp;0.25em;overflow:hidden;padding:0px;border-bottom:1px&nbsp;solid&nbsp;rgb(162,169,177);font-family:&quot;Linux&nbsp;Libertine&quot;,Georgia,Times,serif;line-height:1.3&quot;&gt;&lt;span&nbsp;class=&quot;gmail-mw-headline&quot;&nbsp;id=&quot;gmail-Persistent_mapped_streaming&quot;&gt;Persistent&nbsp;mapped&nbsp;streaming&lt;/span&gt;&lt;/h2&gt;&lt;p&nbsp;style=&quot;margin:0.5em&nbsp;0px;line-height:inherit;font-family:sans-serif;font-size:14px&quot;&gt;Given&nbsp;the&nbsp;availability&nbsp;of&nbsp;OpenGL&nbsp;4.4 or &lt;a&nbsp;rel=&quot;nofollow&quot;&nbsp;class=&quot;external&nbsp;gmail-text&quot;&nbsp;href=&quot;http://www.opengl.org/registry/specs/ARB/buffer_storage.txt&quot;&nbsp;style=&quot;text-decoration-line:none;color:rgb(102,51,102);background-color:initial;padding-right:13px&quot;&gt;ARB_buffer_storage&lt;/a&gt;,&nbsp;the&nbsp;use&nbsp;of&nbsp;persistent&nbsp;mapping&nbsp;of&nbsp;buffers&nbsp;becomes&nbsp;a&nbsp;possibility.&lt;/p&gt;&lt;p&nbsp;style=&quot;margin:0.5em&nbsp;0px;line-height:inherit;font-family:sans-serif;font-size:14px&quot;&gt;The&nbsp;idea&nbsp;here&nbsp;is&nbsp;to&nbsp;allocate&nbsp;an&nbsp;immutable&nbsp;buffer&nbsp;2-3x&nbsp;the&nbsp;size&nbsp;you&nbsp;need,&nbsp;and&nbsp;while&nbsp;you&#39;re&nbsp;executing&nbsp;operations&nbsp;from&nbsp;one&nbsp;region&nbsp;of&nbsp;the&nbsp;buffer&nbsp;while&nbsp;you&nbsp;are&nbsp;writing&nbsp;to&nbsp;a&nbsp;different&nbsp;region.&nbsp;The&nbsp;difference&nbsp;between&nbsp;the&nbsp;prior&nbsp;mapping&nbsp;scheme&nbsp;is&nbsp;that&nbsp;you&nbsp;are&nbsp;not&nbsp;frequently&nbsp;mapping&nbsp;and&nbsp;unmapping&nbsp;the&nbsp;buffer.&nbsp;You&nbsp;map&nbsp;it&nbsp;persistently&nbsp;when&nbsp;you&nbsp;create&nbsp;the&nbsp;buffer,&nbsp;and&nbsp;keep&nbsp;it&nbsp;mapped&nbsp;until&nbsp;it&#39;s&nbsp;time&nbsp;to&nbsp;delete&nbsp;the&nbsp;buffer.&lt;/p&gt;&lt;p&nbsp;style=&quot;margin:0.5em&nbsp;0px;line-height:inherit;font-family:sans-serif;font-size:14px&quot;&gt;This&nbsp;requires&nbsp;using &lt;span&nbsp;class=&quot;gmail-tpl-code&quot;&nbsp;style=&quot;font-family:Consolas,monospace;background-color:rgb(248,248,248)&quot;&gt;&lt;a&nbsp;href=&quot;https://www.khronos.org/opengl/wiki/GLAPI/glBufferStorage&quot;&nbsp;title=&quot;GLAPI/glBufferStorage&quot;&nbsp;style=&quot;text-decoration-line:none;color:rgb(11,0,128);background:none&quot;&gt;glBufferStorage&lt;/a&gt;&lt;/span&gt; with&nbsp;the &lt;span&nbsp;class=&quot;gmail-tpl-enum&quot;&nbsp;style=&quot;font-family:Consolas,monospace;background-color:rgb(248,248,248);color:rgb(160,0,160)&quot;&gt;GL_MAP_WRITE&lt;/span&gt; and &lt;span&nbsp;class=&quot;gmail-tpl-enum&quot;&nbsp;style=&quot;font-family:Consolas,monospace;background-color:rgb(248,248,248);color:rgb(160,0,160)&quot;&gt;GL_PERSISTENT_BIT&lt;/span&gt;s.&nbsp;It&nbsp;also&nbsp;requires&nbsp;using &lt;span&nbsp;class=&quot;gmail-tpl-code&quot;&nbsp;style=&quot;font-family:Consolas,monospace;background-color:rgb(248,248,248)&quot;&gt;&lt;a&nbsp;href=&quot;https://www.khronos.org/opengl/wiki/GLAPI/glMapBufferRange&quot;&nbsp;title=&quot;GLAPI/glMapBufferRange&quot;&nbsp;style=&quot;text-decoration-line:none;color:rgb(11,0,128);background:none&quot;&gt;glMapBufferRange&lt;/a&gt;&lt;/span&gt; with&nbsp;those&nbsp;same&nbsp;bits&nbsp;when&nbsp;mapping&nbsp;it.&lt;/p&gt;&lt;p&nbsp;style=&quot;margin:0.5em&nbsp;0px;line-height:inherit;font-family:sans-serif;font-size:14px&quot;&gt;The&nbsp;general&nbsp;algorithm&nbsp;is&nbsp;as&nbsp;follows.&nbsp;The&nbsp;buffer&nbsp;is&nbsp;logically&nbsp;divided&nbsp;into&nbsp;3&nbsp;sections:&nbsp;the&nbsp;section&nbsp;you&#39;re&nbsp;writing&nbsp;to,&nbsp;and&nbsp;two&nbsp;sections&nbsp;that&nbsp;could&nbsp;currently&nbsp;be&nbsp;in&nbsp;use.&lt;/p&gt;&lt;p&nbsp;style=&quot;margin:0.5em&nbsp;0px;line-height:inherit;font-family:sans-serif;font-size:14px&quot;&gt;The&nbsp;first&nbsp;step&nbsp;is&nbsp;to&nbsp;write&nbsp;to&nbsp;section&nbsp;1&nbsp;of&nbsp;the&nbsp;buffer.&nbsp;Once&nbsp;you&nbsp;have&nbsp;finished&nbsp;writing,&nbsp;you&nbsp;must&nbsp;make&nbsp;this&nbsp;range&nbsp;of&nbsp;data&nbsp;visible&nbsp;to&nbsp;OpenGL&nbsp;by&nbsp;flushing&nbsp;it&nbsp;(if&nbsp;you&nbsp;aren&#39;t&nbsp;mapping&nbsp;coherently).&nbsp;Then,&nbsp;you&nbsp;do&nbsp;whatever&nbsp;you&nbsp;need&nbsp;to&nbsp;in&nbsp;order&nbsp;to &lt;a&nbsp;href=&quot;https://www.khronos.org/opengl/wiki/Buffer_Object_Streaming#Persistent_visibility&quot;&nbsp;style=&quot;text-decoration-line:none;color:rgb(11,0,128);background:none&quot;&gt;ensure&nbsp;that&nbsp;this&nbsp;data&nbsp;is&nbsp;visible&nbsp;to&nbsp;OpenGL&lt;/a&gt;.&nbsp;Once&nbsp;the&nbsp;data&nbsp;is&nbsp;visible,&nbsp;you&nbsp;issue&nbsp;some&nbsp;number&nbsp;of &lt;a&nbsp;href=&quot;https://www.khronos.org/opengl/wiki/Rendering_Command&quot;&nbsp;class=&quot;gmail-mw-redirect&quot;&nbsp;title=&quot;Rendering&nbsp;Command&quot;&nbsp;style=&quot;text-decoration-line:none;color:rgb(11,0,128);background:none&quot;&gt;Rendering&nbsp;Commands&lt;/a&gt; that&nbsp;read&nbsp;from&nbsp;that&nbsp;section&nbsp;of&nbsp;the&nbsp;buffer.&nbsp;After&nbsp;issuing&nbsp;all&nbsp;of&nbsp;the&nbsp;commands&nbsp;that&nbsp;read&nbsp;from&nbsp;the&nbsp;buffer,&nbsp;you&nbsp;create&nbsp;a &lt;a&nbsp;href=&quot;https://www.khronos.org/opengl/wiki/Sync_Object&quot;&nbsp;title=&quot;Sync&nbsp;Object&quot;&nbsp;style=&quot;text-decoration-line:none;color:rgb(11,0,128);background:none&quot;&gt;fence&nbsp;sync&nbsp;object&lt;/a&gt;.&lt;/p&gt;&lt;p&nbsp;style=&quot;margin:0.5em&nbsp;0px;line-height:inherit;font-family:sans-serif;font-size:14px&quot;&gt;Next&nbsp;frame,&nbsp;you&nbsp;start&nbsp;writing&nbsp;to&nbsp;buffer&nbsp;section&nbsp;2.&nbsp;You&nbsp;do&nbsp;all&nbsp;of&nbsp;the&nbsp;above,&nbsp;and&nbsp;create&nbsp;a&nbsp;new&nbsp;fence&nbsp;sync&nbsp;object.&nbsp;Keep&nbsp;each&nbsp;buffer&nbsp;section&#39;s&nbsp;sync&nbsp;objects&nbsp;separate.&lt;/p&gt;&lt;p&nbsp;style=&quot;margin:0.5em&nbsp;0px;line-height:inherit;font-family:sans-serif;font-size:14px&quot;&gt;You&nbsp;do&nbsp;the&nbsp;same&nbsp;with&nbsp;buffer&nbsp;section&nbsp;3&nbsp;on&nbsp;the&nbsp;next&nbsp;frame.&lt;/p&gt;&lt;p&nbsp;style=&quot;margin:0.5em&nbsp;0px;line-height:inherit;font-family:sans-serif;font-size:14px&quot;&gt;On&nbsp;the&nbsp;fourth&nbsp;frame,&nbsp;you&nbsp;want&nbsp;to&nbsp;start&nbsp;using&nbsp;section&nbsp;1&nbsp;again.&nbsp;However,&nbsp;you&nbsp;need&nbsp;to&nbsp;check&nbsp;section&nbsp;1&#39;s&nbsp;sync&nbsp;object&nbsp;to&nbsp;see&nbsp;if&nbsp;it&nbsp;has&nbsp;completed &lt;i&gt;before&lt;/i&gt; you&nbsp;can&nbsp;start.&nbsp;You&nbsp;can&nbsp;only&nbsp;start&nbsp;writing&nbsp;to&nbsp;a&nbsp;section&nbsp;if&nbsp;that&nbsp;section&#39;s&nbsp;sync&nbsp;object&nbsp;has&nbsp;completed.&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_signature&quot;&nbsp;data-smartmail=&quot;gmail_signature&quot;&gt;trajce&nbsp;nikolov&nbsp;nick&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
