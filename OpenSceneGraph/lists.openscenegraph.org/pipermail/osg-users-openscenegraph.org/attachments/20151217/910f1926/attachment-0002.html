<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;uyb8Gf&quot;&nbsp;style=&quot;font-size:13px;line-height:19.5px&quot;&gt;&lt;div&nbsp;class=&quot;F3hlO&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;I&nbsp;have&nbsp;a&nbsp;question&nbsp;about&nbsp;the&nbsp;construction&nbsp;of&nbsp;the&nbsp;osgImage&nbsp;and&nbsp;the&nbsp;specification&nbsp;of&nbsp;a&nbsp;transfer&nbsp;function. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;have&nbsp;uint8_T&nbsp;intensity&nbsp;data&nbsp;in&nbsp;the&nbsp;range&nbsp;[0&nbsp;255]&nbsp;and&nbsp;a&nbsp;1-D&nbsp;transfer&nbsp;function&nbsp;of&nbsp;RGBA&nbsp;uint8_T&nbsp;values&nbsp;in&nbsp;a&nbsp;lookup&nbsp;table,&nbsp;also&nbsp;in&nbsp;the&nbsp;range&nbsp;[0&nbsp;255].&nbsp;I&nbsp;can&#39;t&nbsp;figure&nbsp;out&nbsp;the&nbsp;right&nbsp;setup&nbsp;for&nbsp;my&nbsp;osgImage&nbsp;and&nbsp;the&nbsp;specification&nbsp;of&nbsp;the&nbsp;TransferFunction1D&nbsp;when&nbsp;working&nbsp;with&nbsp;RayTracedTechnique&nbsp;as&nbsp;the&nbsp;rendering&nbsp;algorithm.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;I&nbsp;construct&nbsp;my&nbsp;image&nbsp;in&nbsp;a&nbsp;function&nbsp;createTexture3D&nbsp;as&nbsp;follows:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;  &lt;b&gt; osg::Image*&nbsp;createTexture3D(const&nbsp;mxArray*&nbsp;src,&nbsp;const&nbsp;uint8_T*&nbsp;xfer_table)&nbsp;{&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp;  &lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp;if&nbsp;(src&nbsp;==&nbsp;NULL&nbsp;||&nbsp;mxGetNumberOfDimensions(src)&nbsp;!=&nbsp;3&nbsp;||&nbsp;mxGetClassID(src)&nbsp;!=&nbsp;mxUINT8_CLASS)&nbsp;{&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return&nbsp;NULL;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp;}&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp;  &lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp;size_t&nbsp;num_s&nbsp;=&nbsp;mxGetDimensions(src)[0];&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp;size_t&nbsp;num_t&nbsp;=&nbsp;mxGetDimensions(src)[1];&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp;size_t&nbsp;num_r&nbsp;=&nbsp;mxGetDimensions(src)[2];&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp;//&nbsp;now&nbsp;allocate&nbsp;the&nbsp;3d&nbsp;texture;&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;uyb8Gf&quot;&nbsp;style=&quot;font-size:13px;line-height:19.5px&quot;&gt;&lt;div&nbsp;class=&quot;pv&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp;osg::ref_ptr&lt;osg::Image&gt;&nbsp;image_3d&nbsp;=&nbsp;new&nbsp;osg::Image;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp;  &lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;uyb8Gf&quot;&nbsp;style=&quot;font-size:13px;line-height:19.5px&quot;&gt;&lt;div&nbsp;class=&quot;F3hlO&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp;image_3d-&gt;setImage(num_s,&nbsp;num_t,&nbsp;num_r, &lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;GL_LUMINANCE,&nbsp;GL_LUMINANCE,&nbsp;GL_UNSIGNED_BYTE,&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;static_cast&lt;uint8_T&nbsp;*&gt;(mxGetData(src)),&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;osg::Image::NO_DELETE);&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp;  &lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp;return&nbsp;image_3d.release();&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp;}&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;And&nbsp;then&nbsp;attempt&nbsp;to&nbsp;setup&nbsp;my&nbsp;transfer&nbsp;function,&nbsp;I&nbsp;can&#39;t&nbsp;get&nbsp;the&nbsp;specification&nbsp;of&nbsp;the&nbsp;transfer&nbsp;function&nbsp;right.&nbsp;I&#39;ve&nbsp;tried:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;uyb8Gf&quot;&nbsp;style=&quot;font-size:13px;line-height:19.5px&quot;&gt;&lt;div&nbsp;title=&quot;Hide&nbsp;quoted&nbsp;text&quot;&nbsp;tabindex=&quot;0&quot;&nbsp;class=&quot;mg&quot;&gt;…&lt;/div&gt;&lt;div&nbsp;class=&quot;pv&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp;osg::ref_ptr&lt;osg::Image&gt;&nbsp;image_3d&nbsp;=&nbsp;createTexture3D(data,xfer_table);&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;osg::ref_ptr&lt;osgVolume::ImageLayer&gt;&nbsp;layer&nbsp;=&nbsp;new&nbsp;osgVolume::ImageLayer(image_3d.get());&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tile-&gt;setLayer(layer.get());&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;uyb8Gf&quot;&nbsp;style=&quot;font-size:13px;line-height:19.5px&quot;&gt;&lt;div&nbsp;class=&quot;F3hlO&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//tile-&gt;setVolumeTechnique(new&nbsp;osgVolume::FixedFunctionTechnique());&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tile-&gt;setVolumeTechnique(new&nbsp;osgVolume::RayTracedTechnique());&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;float&nbsp;alphaFunc=0.0f;&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;uyb8Gf&quot;&nbsp;style=&quot;font-size:13px;line-height:19.5px&quot;&gt;&lt;div&nbsp;title=&quot;Hide&nbsp;quoted&nbsp;text&quot;&nbsp;tabindex=&quot;0&quot;&nbsp;class=&quot;mg&quot;&gt;…&lt;/div&gt;&lt;div&nbsp;class=&quot;pv&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;float&nbsp;sampleDensityWhenMoving&nbsp;=&nbsp;0.02;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;osgVolume::AlphaFuncProperty*&nbsp;ap&nbsp;=&nbsp;new&nbsp;osgVolume::AlphaFuncProperty(alphaFunc);&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;osgVolume::SampleDensityProperty*&nbsp;sd&nbsp;=&nbsp;new&nbsp;osgVolume::SampleDensityProperty(0.005);&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;osgVolume::SampleDensityWhenMovingProperty*&nbsp;sdwm&nbsp;=&nbsp;sampleDensityWhenMoving!=0.0&nbsp;?&nbsp;new&nbsp;osgVolume::SampleDensityWhenMovingProperty(sampleDensityWhenMoving)&nbsp;:&nbsp;0;&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;uyb8Gf&quot;&nbsp;style=&quot;font-size:13px;line-height:19.5px&quot;&gt;&lt;div&nbsp;class=&quot;F3hlO&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;osgVolume::TransparencyProperty*&nbsp;tp&nbsp;=&nbsp;new&nbsp;osgVolume::TransparencyProperty(0.6);&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;osgVolume::TransferFunctionProperty*&nbsp;tfp&nbsp;=&nbsp;new&nbsp;osgVolume::TransferFunctionProperty(transferFunction);&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp;  &lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;layer-&gt;addProperty(ap);&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;layer-&gt;addProperty(sd);&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;layer-&gt;addProperty(sdwm);&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;layer-&gt;addProperty(tp);&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;layer-&gt;addProperty(tfp);&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;I&nbsp;don&#39;t&nbsp;specify&nbsp;a&nbsp;TransferFunctionProperty,&nbsp;depending&nbsp;on&nbsp;the&nbsp;dataset,&nbsp;I&nbsp;sometimes&nbsp;see&nbsp;a&nbsp;cube&nbsp;shaped&nbsp;brick&nbsp;that&nbsp;roughly&nbsp;shows&nbsp;the&nbsp;structure&nbsp;of&nbsp;my&nbsp;data,&nbsp;othertimes&nbsp;I&nbsp;see&nbsp;nothing&nbsp;at&nbsp;all.&nbsp;When&nbsp;I&nbsp;specify&nbsp;the&nbsp;transfer&nbsp;function,&nbsp;I&nbsp;don&#39;t&nbsp;see&nbsp;anything&nbsp;at&nbsp;all.&nbsp;I&#39;ve&nbsp;tried&nbsp;defining&nbsp;my&nbsp;TransferFunction1D&nbsp;as&nbsp;a&nbsp;4-vec&nbsp;of&nbsp;float&nbsp;values&nbsp;in&nbsp;the&nbsp;range&nbsp;[0&nbsp;1]&nbsp;and&nbsp;a&nbsp;uint8_T&nbsp;values&nbsp;in&nbsp;the&nbsp;range&nbsp;[0&nbsp;255]. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;One&nbsp;question&nbsp;I&nbsp;have:&nbsp;what&nbsp;is&nbsp;the&nbsp;expected&nbsp;datatype&nbsp;and&nbsp;normalization&nbsp;of&nbsp;values&nbsp;in&nbsp;the&nbsp;LUT&nbsp;for&nbsp;color&nbsp;and&nbsp;alpha&nbsp;values?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;As&nbsp;a&nbsp;debugging&nbsp;step,&nbsp;I&nbsp;tried&nbsp;FixedFunctionTechnique.&nbsp;In&nbsp;that&nbsp;algorithm,&nbsp;I&nbsp;see&nbsp;my&nbsp;data&nbsp;as&nbsp;I&nbsp;would&nbsp;expect&nbsp;as&nbsp;grayscale&nbsp;without&nbsp;any&nbsp;color&nbsp;mapping&nbsp;applied.&nbsp;It&nbsp;looks&nbsp;like&nbsp;it&#39;s&nbsp;modulating&nbsp;alpha&nbsp;using&nbsp;the&nbsp;intensity&nbsp;values&nbsp;for&nbsp;each&nbsp;voxel.&nbsp;This&nbsp;at&nbsp;least&nbsp;suggests&nbsp;I&#39;m&nbsp;roughly&nbsp;using&nbsp;the&nbsp;setImage&nbsp;method&nbsp;of&nbsp;osgImage&nbsp;properly,&nbsp;it&nbsp;seems&nbsp;like&nbsp;I&quot;m&nbsp;just&nbsp;not&nbsp;able&nbsp;to&nbsp;set&nbsp;the&nbsp;transferFunction&nbsp;correctly.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;How&nbsp;exactly&nbsp;should&nbsp;I&nbsp;specify&nbsp;the&nbsp;transferFunction&nbsp;in&nbsp;terms&nbsp;of&nbsp;datatype&nbsp;and&nbsp;normalization&nbsp;of&nbsp;data&nbsp;values&nbsp;within&nbsp;the&nbsp;transferFunction?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Hoping&nbsp;someone&nbsp;on&nbsp;the&nbsp;list&nbsp;can&nbsp;help&nbsp;me,&nbsp;I&nbsp;feel&nbsp;like&nbsp;working&nbsp;with&nbsp;uint8&nbsp;intensity&nbsp;data&nbsp;and&nbsp;a&nbsp;known&nbsp;colormap/transfer&nbsp;function&nbsp;is&nbsp;a&nbsp;pretty&nbsp;common&nbsp;use&nbsp;case&nbsp;of&nbsp;volume&nbsp;rendering,&nbsp;but&nbsp;I&nbsp;can&#39;t&nbsp;seem&nbsp;to&nbsp;get&nbsp;this&nbsp;right.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-&nbsp;Alex&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
