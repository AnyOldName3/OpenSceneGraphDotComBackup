<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;Hi&nbsp;David,&lt;br&gt;&lt;br&gt;&lt;/div&gt;I&nbsp;have&nbsp;just&nbsp;had&nbsp;a&nbsp;look&nbsp;at&nbsp;DisplaySettings.cpp&nbsp;and&nbsp;there&nbsp;is&nbsp;a&nbsp;line:&lt;br&gt;&lt;br&gt;  &nbsp;OSG_INIT_SINGLETON_PROXY(ProxyInitDisplaySettings,&nbsp;DisplaySettings::instance())&nbsp;&lt;br&gt;&lt;br&gt;&lt;/div&gt;That&nbsp;should&nbsp;in&nbsp;theory&nbsp;force&nbsp;the&nbsp;initialization&nbsp;of&nbsp;the&nbsp;&nbsp;DisplaySettings::instance()&nbsp;singleton&nbsp;during&nbsp;the&nbsp;static&nbsp;initialization&nbsp;of&nbsp;the&nbsp;osg&nbsp;library. &nbsp;In&nbsp;your&nbsp;case&nbsp;it&nbsp;sounds&nbsp;like&nbsp;the&nbsp;Registry::instance()&nbsp;is&nbsp;being&nbsp;constructed&nbsp;before&nbsp;this&nbsp;which&nbsp;I&#39;m&nbsp;surprised&nbsp;by.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Perhaps&nbsp;it&#39;s&nbsp;simply&nbsp;the&nbsp;InitRegistry&nbsp;construction/destruction&nbsp;in&nbsp;src/osgViewer/ViewerBase.cpp&nbsp;is&nbsp;the&nbsp;root&nbsp;of&nbsp;the&nbsp;problem. &nbsp;Perhaps&nbsp;just&nbsp;removing&nbsp;this&nbsp;would&nbsp;be&nbsp;sufficient.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;Robert.&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;5&nbsp;October&nbsp;2015&nbsp;at&nbsp;10:24,&nbsp;David&nbsp;Siñuela&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:david.sinuela@pix4d.com&quot;&nbsp;target=&quot;_blank&quot;&gt;david.sinuela@pix4d.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;Hello,&lt;br&gt;&lt;br&gt;&lt;/div&gt;Thanks&nbsp;for&nbsp;your&nbsp;input.&nbsp;We&nbsp;can&nbsp;wait&nbsp;for&nbsp;an&nbsp;upstream&nbsp;fix,&nbsp;in&nbsp;the&nbsp;meanwhile&nbsp;we&nbsp;will&nbsp;patch&nbsp;it&nbsp;in&nbsp;our&nbsp;development&nbsp;branch.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;tried&nbsp;your&nbsp;proposed&nbsp;solution,&nbsp;calling&nbsp;DisplaySettings::instance()&nbsp;from&nbsp;main(),&nbsp;and&nbsp;it&nbsp;didn&#39;t&nbsp;work,&nbsp;when&nbsp;s_InitRegistry&nbsp;is&nbsp;destroyed&nbsp;the&nbsp;DisplaySettings::s_displaySettings&nbsp;has&nbsp;been&nbsp;destroyed&nbsp;already.&nbsp;It&nbsp;can&nbsp;be&nbsp;fixed&nbsp;by&nbsp;defining&nbsp;a&nbsp;static&nbsp;initializer&nbsp;like&nbsp;InitRegistry&nbsp;that&nbsp;simply&nbsp;calls&nbsp;DisplaySettings::instance()&nbsp;in&nbsp;our&nbsp;program.&nbsp;If&nbsp;I&nbsp;understood&nbsp;it&nbsp;correctly&nbsp;this&nbsp;works&nbsp;because&nbsp;the&nbsp;compiler/linker&nbsp;will&nbsp;see&nbsp;this&nbsp;static&nbsp;member&nbsp;and&nbsp;DisplaySettings::s_displaySettings&nbsp;before&nbsp;InitRegistry,&nbsp;changing&nbsp;the&nbsp;order&nbsp;of&nbsp;initialization&nbsp;so&nbsp;that&nbsp;DisplaySettings::s_displaySettings&nbsp;is&nbsp;allocated&nbsp;before&nbsp;s_InitRegistry&nbsp;and&nbsp;deallocated&nbsp;after.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&nbsp;can&nbsp;also&nbsp;be&nbsp;fixed&nbsp;by&nbsp;calling&nbsp;&quot;osgDB::DatabasePager::prototype()&quot;&nbsp;or&nbsp;&quot;osg::DisplaySettings::instance()&quot;&nbsp;from&nbsp;InitRegistry&#39;s&nbsp;constructor.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;br&gt;&lt;/div&gt;&lt;div&gt;David&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Oct&nbsp;2,&nbsp;2015&nbsp;at&nbsp;6:28&nbsp;PM,&nbsp;Robert&nbsp;Osfield&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:robert.osfield@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;robert.osfield@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;Hi&nbsp;David,&lt;br&gt;&lt;br&gt;&lt;/div&gt;Curious&nbsp;bug. &nbsp;Perhaps&nbsp;another&nbsp;solution&nbsp;would&nbsp;be&nbsp;to&nbsp;call&nbsp;DisplaySettings::instance()&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;main.&lt;br&gt;&lt;br&gt;&lt;/div&gt;An&nbsp;actual&nbsp;bug&nbsp;fix&nbsp;might&nbsp;be&nbsp;to&nbsp;put&nbsp;in&nbsp;a&nbsp;proxy&nbsp;object&nbsp;into&nbsp;src/osg/DisplauySettings.cpp&nbsp;that&nbsp;forces&nbsp;that&nbsp;DisplaySettings::instance()&nbsp;to&nbsp;be&nbsp;constructed&nbsp;during&nbsp;static&nbsp;initialization,&nbsp;this&nbsp;would&nbsp;obviously&nbsp;require&nbsp;a&nbsp;patch&nbsp;to&nbsp;the&nbsp;core&nbsp;OSG,&nbsp;something&nbsp;I&#39;m&nbsp;happy&nbsp;to&nbsp;do,&nbsp;but&nbsp;won&#39;t&nbsp;help&nbsp;you&nbsp;right&nbsp;away.&lt;br&gt;&lt;br&gt;&lt;/div&gt;Robert.&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;On&nbsp;2&nbsp;October&nbsp;2015&nbsp;at&nbsp;17:07,&nbsp;David&nbsp;Siñuela&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:david.sinuela@pix4d.com&quot;&nbsp;target=&quot;_blank&quot;&gt;david.sinuela@pix4d.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;Hello,&lt;br&gt;&lt;br&gt;&lt;/div&gt;We&nbsp;have&nbsp;a&nbsp;Qt&nbsp;application&nbsp;that&nbsp;uses&nbsp;OSG&nbsp;for&nbsp;the&nbsp;3D&nbsp;viewer/editor,&nbsp;but&nbsp;the&nbsp;OSG&nbsp;viewer&nbsp;may&nbsp;not&nbsp;be&nbsp;used&nbsp;if&nbsp;the&nbsp;user&nbsp;does&nbsp;not&nbsp;open&nbsp;the&nbsp;3D&nbsp;view&nbsp;tab.&nbsp;We&nbsp;are&nbsp;in&nbsp;the&nbsp;process&nbsp;of&nbsp;upgrading&nbsp;to&nbsp;OSG&nbsp;3.4&nbsp;and&nbsp;we&nbsp;noticed&nbsp;that&nbsp;the&nbsp;application&nbsp;crashes&nbsp;when&nbsp;the&nbsp;user&nbsp;quits&nbsp;if&nbsp;the&nbsp;3D&nbsp;view&nbsp;is&nbsp;never&nbsp;open.&lt;br&gt;&lt;br&gt;&lt;/div&gt;The&nbsp;problem&nbsp;seems&nbsp;to&nbsp;be&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;the&nbsp;static&nbsp;variables&nbsp;are&nbsp;destroyed&nbsp;at&nbsp;shutdown.&nbsp;The&nbsp;stacktrace&nbsp;looks&nbsp;like&nbsp;this:&lt;br&gt;&lt;br&gt;Program&nbsp;received&nbsp;signal&nbsp;SIGSEGV,&nbsp;Segmentation&nbsp;fault.&lt;br&gt;0x0000000001d8a0b0&nbsp;in&nbsp;osg::DisplaySettings::getNumOfHttpDatabaseThreadsHint&nbsp;(this=0x0)&nbsp;at&nbsp;/home/siu/src/pix4dmapper/2.1/external_tmp/build/openscenegraph/include/osg/DisplaySettings:203&lt;br&gt;(gdb)&nbsp;bt&lt;br&gt;#0 &nbsp;0x0000000001d8a0b0&nbsp;in&nbsp;osg::DisplaySettings::getNumOfHttpDatabaseThreadsHint&nbsp;(this=0x0)&nbsp;at&nbsp;/home/siu/src/pix4dmapper/2.1/external_tmp/build/openscenegraph/include/osg/DisplaySettings:203&lt;br&gt;#1 &nbsp;0x0000000001d86b47&nbsp;in&nbsp;osgDB::DatabasePager::DatabasePager&nbsp;(this=0x3a10fb0)&nbsp;at&nbsp;/home/siu/src/pix4dmapper/2.1/external_tmp/build/openscenegraph/src/osgDB/DatabasePager.cpp:1111&lt;br&gt;#2 &nbsp;0x0000000001d87815&nbsp;in&nbsp;osgDB::DatabasePager::prototype&nbsp;()&nbsp;at&nbsp;/home/siu/src/pix4dmapper/2.1/external_tmp/build/openscenegraph/src/osgDB/DatabasePager.cpp:1235&lt;br&gt;#3 &nbsp;0x0000000001d1ceef&nbsp;in&nbsp;InitRegistry::~InitRegistry&nbsp;(this=0x32cc6f3&nbsp;&lt;s_InitRegistry&gt;,&nbsp;__in_chrg=&lt;optimized&nbsp;out&gt;)&nbsp;at&nbsp;/home/siu/src/pix4dmapper/2.1/external_tmp/build/openscenegraph/src/osgViewer/ViewerBase.cpp:53&lt;br&gt;#4 &nbsp;0x00007fffec82df88&nbsp;in&nbsp;__run_exit_handlers&nbsp;()&nbsp;from&nbsp;/usr/lib/libc.so.6&lt;br&gt;#5 &nbsp;0x00007fffec82dfd5&nbsp;in&nbsp;exit&nbsp;()&nbsp;from&nbsp;/usr/lib/libc.so.6&lt;br&gt;#6 &nbsp;0x00007fffec818617&nbsp;in&nbsp;__libc_start_main&nbsp;()&nbsp;from&nbsp;/usr/lib/libc.so.6&lt;br&gt;#7 &nbsp;0x0000000000ea3709&nbsp;in&nbsp;_start&nbsp;()&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;As&nbsp;shown&nbsp;in&nbsp;the&nbsp;trace&nbsp;calling&nbsp;DatabasePager::prototype()&nbsp;is&nbsp;creating&nbsp;the&nbsp;static&nbsp;DatabasePager&nbsp;for&nbsp;the&nbsp;first&nbsp;time&nbsp;and&nbsp;this&nbsp;one&nbsp;calls&nbsp;osg::DisplaySettings::instance()&nbsp;which&nbsp;was&nbsp;released&nbsp;already.&nbsp;It&nbsp;is&nbsp;easily&nbsp;reproducible&nbsp;on&nbsp;linux&nbsp;with&nbsp;gcc.&nbsp;Removing&nbsp;the&nbsp;osgDB::DatabasePager::prototype()&nbsp;=&nbsp;0;&nbsp;line&nbsp;fixes&nbsp;the&nbsp;crash&nbsp;but&nbsp;I&nbsp;am&nbsp;not&nbsp;sure&nbsp;about&nbsp;the&nbsp;intent&nbsp;of&nbsp;that&nbsp;line.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;span&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;--&nbsp;&lt;br&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;David&nbsp;Sinuela&nbsp;Pastor&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;size=&quot;1&quot;&gt;&lt;b&gt;Pix4D&nbsp;SA&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;size=&quot;1&quot;&gt;&lt;b&gt;EPFL&nbsp;Innovation&nbsp;Park&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;size=&quot;1&quot;&gt;&lt;b&gt;Building&nbsp;D&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;size=&quot;1&quot;&gt;&lt;b&gt;1015&nbsp;Lausanne&nbsp;-&nbsp;Switzerland&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;size=&quot;1&quot;&gt;&lt;b&gt;Email:&nbsp;&lt;a&nbsp;href=&quot;mailto:david.sinuela@pix4d.com&quot;&nbsp;target=&quot;_blank&quot;&gt;&lt;/a&gt;&lt;a&nbsp;href=&quot;mailto:david.sinuela@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;david.sinuela@pix4d.com&lt;/a&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;b&nbsp;style=&quot;font-size:x-small&quot;&gt;Skype:&nbsp;david.sinuela.pix4d&lt;/b&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;size=&quot;1&quot;&gt;&lt;a&nbsp;href=&quot;http://www.pix4d.com&quot;&nbsp;target=&quot;_blank&quot;&gt;&lt;b&gt;www.pix4d.com&lt;/b&gt;&lt;/a&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;/div&gt;_______________________________________________&lt;br&gt;<br>
osg-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:osg-users@lists.openscenegraph.org&quot;&nbsp;target=&quot;_blank&quot;&gt;osg-users@lists.openscenegraph.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;br&gt;_______________________________________________&lt;br&gt;<br>
osg-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:osg-users@lists.openscenegraph.org&quot;&nbsp;target=&quot;_blank&quot;&gt;osg-users@lists.openscenegraph.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;David&nbsp;Sinuela&nbsp;Pastor&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;size=&quot;1&quot;&gt;&lt;b&gt;Pix4D&nbsp;SA&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;size=&quot;1&quot;&gt;&lt;b&gt;EPFL&nbsp;Innovation&nbsp;Park&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;size=&quot;1&quot;&gt;&lt;b&gt;Building&nbsp;D&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;size=&quot;1&quot;&gt;&lt;b&gt;1015&nbsp;Lausanne&nbsp;-&nbsp;Switzerland&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;size=&quot;1&quot;&gt;&lt;b&gt;Email:&nbsp;&lt;a&nbsp;href=&quot;mailto:david.sinuela@pix4d.com&quot;&nbsp;target=&quot;_blank&quot;&gt;&lt;/a&gt;&lt;a&nbsp;href=&quot;mailto:david.sinuela@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;david.sinuela@pix4d.com&lt;/a&gt;&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;b&nbsp;style=&quot;font-size:x-small&quot;&gt;Skype:&nbsp;david.sinuela.pix4d&lt;/b&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;size=&quot;1&quot;&gt;&lt;a&nbsp;href=&quot;http://www.pix4d.com&quot;&nbsp;target=&quot;_blank&quot;&gt;&lt;b&gt;www.pix4d.com&lt;/b&gt;&lt;/a&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;br&gt;_______________________________________________&lt;br&gt;<br>
osg-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:osg-users@lists.openscenegraph.org&quot;&gt;osg-users@lists.openscenegraph.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
