<tt>
&lt;div&gt;Hi&nbsp;Cully,&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;It&nbsp;seems&nbsp;like&nbsp;the&nbsp;problem&nbsp;that&nbsp;split&nbsp;window&nbsp;or&nbsp;frame&nbsp;buffer&nbsp;to&nbsp;different&nbsp;part.&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;There&nbsp;are&nbsp;two&nbsp;way&nbsp;to&nbsp;do&nbsp;this&nbsp;in&nbsp;osg.&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;1.add&nbsp;slave&nbsp;camera&nbsp;to&nbsp;osgViewer::view,each&nbsp;camera&nbsp;has&nbsp;different&nbsp;graphiccontext.&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;2.add&nbsp;osgViewer::view&nbsp;to&nbsp;osgViewer::compositeViewer,and&nbsp;one&nbsp;osgViewer::view&nbsp;correspond&nbsp;one&nbsp;camera,and&nbsp;has&nbsp;the&nbsp;same&nbsp;graphiccontext.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;method&nbsp;1&nbsp;prefer&nbsp;the&nbsp;situation&nbsp;that&nbsp;each&nbsp;camera&nbsp;has&nbsp;different&nbsp;view&nbsp;or&nbsp;proj&nbsp;matrix&nbsp;but&nbsp;has&nbsp;same&nbsp;node&nbsp;tree.like&nbsp;Virtual&nbsp;Reality&nbsp;rendering,or&nbsp;cad&nbsp;design.&lt;/div&gt;&lt;div&gt;method&nbsp;2&nbsp;prefer&nbsp;each&nbsp;view(camera)&nbsp;has&nbsp;independent&nbsp;node&nbsp;tree.Like&nbsp;multi-doc&nbsp;edit&nbsp;in&nbsp;Word.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;And&nbsp;the&nbsp;thread&nbsp;problem,I&nbsp;think&nbsp;you'd&nbsp;better&nbsp;do&nbsp;update&nbsp;in&nbsp;osg&nbsp;update&nbsp;thread,like&nbsp;add&nbsp;updateCallback&nbsp;to&nbsp;node.By&nbsp;this&nbsp;way,your&nbsp;thread&nbsp;will&nbsp;not&nbsp;have&nbsp;sync&nbsp;problem&nbsp;with&nbsp;osg&nbsp;render&nbsp;thread.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;To&nbsp;be&nbsp;honest,I&nbsp;don't&nbsp;pretty&nbsp;understand&nbsp;your&nbsp;problem.&lt;/div&gt;&lt;div&gt;you'd&nbsp;better&nbsp;simplify&nbsp;your&nbsp;code&nbsp;to&nbsp;a&nbsp;problem&nbsp;example.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Qi&nbsp;Yu.&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;12px;font-family:&nbsp;Arial&nbsp;Narrow;padding:2px&nbsp;0&nbsp;2px&nbsp;0;&quot;&gt;------------------&nbsp;Original&nbsp;------------------&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;12px;background:#efefef;padding:8px;&quot;&gt;&lt;div&gt;&lt;b&gt;From:&lt;/b&gt;&nbsp;&quot;Antoine&nbsp;Cully&quot;&lt;antoinecully@hotmail.com&gt;;&lt;/div&gt;&lt;div&gt;&lt;b&gt;Date:&lt;/b&gt;&nbsp;Thu,&nbsp;May&nbsp;23,&nbsp;2019&nbsp;00:49&nbsp;AM&lt;/div&gt;&lt;div&gt;&lt;b&gt;To:&lt;/b&gt;&nbsp;&quot;osg-users&quot;&lt;osg-users@lists.openscenegraph.org&gt;;&lt;wbr&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;Subject:&lt;/b&gt;&nbsp;[osg-users]&nbsp;Running&nbsp;multiple&nbsp;(independent)&nbsp;viewers&nbsp;in&nbsp;differentthreads&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;Dear&nbsp;OSG&nbsp;Community,&nbsp;&lt;br&gt;&lt;br&gt;I&nbsp;searched&nbsp;quite&nbsp;a&nbsp;lot&nbsp;through&nbsp;the&nbsp;source&nbsp;code&nbsp;and&nbsp;the&nbsp;beginner&nbsp;guide,&nbsp;but&nbsp;I&nbsp;was&nbsp;unable&nbsp;to&nbsp;find&nbsp;a&nbsp;way&nbsp;to&nbsp;make&nbsp;this&nbsp;work,&nbsp;so&nbsp;I&nbsp;am&nbsp;posting&nbsp;here&nbsp;hoping&nbsp;that&nbsp;you&nbsp;could&nbsp;help&nbsp;me.&nbsp;&lt;br&gt;&lt;br&gt;I&nbsp;am&nbsp;developing&nbsp;a&nbsp;tool&nbsp;to&nbsp;run&nbsp;physical&nbsp;simulations&nbsp;(of&nbsp;robots)&nbsp;in&nbsp;parallel.&nbsp;This&nbsp;tool&nbsp;is&nbsp;used&nbsp;to&nbsp;run&nbsp;stochastic&nbsp;optimisation&nbsp;(like&nbsp;deep&nbsp;reinforcement&nbsp;learning)&nbsp;algorithms,&nbsp;and&nbsp;for&nbsp;this&nbsp;I&nbsp;need&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;run&nbsp;several,&nbsp;but&nbsp;fully&nbsp;independent,&nbsp;simulations&nbsp;in&nbsp;parallel&nbsp;thanks&nbsp;to&nbsp;multithreading.&nbsp;This&nbsp;enables&nbsp;to&nbsp;collect&nbsp;data&nbsp;faster&nbsp;and&nbsp;for&nbsp;instance&nbsp;with&nbsp;a&nbsp;32-core&nbsp;multithreaded&nbsp;CPU&nbsp;the&nbsp;speed-up&nbsp;factor&nbsp;is&nbsp;quite&nbsp;significant.&nbsp;&lt;br&gt;&lt;br&gt;In&nbsp;each&nbsp;simulation,&nbsp;I&nbsp;have&nbsp;one&nbsp;camera&nbsp;that&nbsp;observes&nbsp;the&nbsp;environment,&nbsp;and&nbsp;which&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;change&nbsp;the&nbsp;behaviour&nbsp;of&nbsp;the&nbsp;robot&nbsp;running&nbsp;in&nbsp;this&nbsp;simulation.&nbsp;The&nbsp;camera&nbsp;is&nbsp;currently&nbsp;implemented&nbsp;as&nbsp;a&nbsp;pbuffer&nbsp;following&nbsp;closely&nbsp;the&nbsp;osgscreencapture&nbsp;example.&nbsp;The&nbsp;actual&nbsp;code&nbsp;of&nbsp;the&nbsp;camera&nbsp;can&nbsp;be&nbsp;found&nbsp;on&nbsp;github,&nbsp;but&nbsp;apprently&nbsp;I&nbsp;am&nbsp;not&nbsp;allowed&nbsp;to&nbsp;post&nbsp;URLs&nbsp;at&nbsp;the&nbsp;moment.&nbsp;&lt;br&gt;The&nbsp;multithreading&nbsp;is&nbsp;managed&nbsp;by&nbsp;TBB&nbsp;(an&nbsp;Intel&nbsp;library&nbsp;that&nbsp;I&nbsp;have&nbsp;been&nbsp;using&nbsp;for&nbsp;6&nbsp;years&nbsp;now).&nbsp;&lt;br&gt;&lt;br&gt;If&nbsp;I&nbsp;run&nbsp;my&nbsp;code&nbsp;in&nbsp;a&nbsp;&quot;sequential&nbsp;mode&quot;,&nbsp;i.e.,&nbsp;all&nbsp;the&nbsp;simulations&nbsp;running&nbsp;one&nbsp;after&nbsp;the&nbsp;other,&nbsp;everything&nbsp;is&nbsp;going&nbsp;well.&nbsp;&nbsp;However,&nbsp;if&nbsp;I&nbsp;run&nbsp;it&nbsp;in&nbsp;parallel,&nbsp;then&nbsp;I&nbsp;have&nbsp;some&nbsp;unstable&nbsp;behaviours.&nbsp;For&nbsp;instance,&nbsp;I&nbsp;can&nbsp;have&nbsp;a&nbsp;segmentation&nbsp;fault&nbsp;happening&nbsp;after&nbsp;a&nbsp;random&nbsp;number&nbsp;of&nbsp;simulations&nbsp;or&nbsp;suddenly&nbsp;after&nbsp;again&nbsp;a&nbsp;random&nbsp;number&nbsp;of&nbsp;simulations,&nbsp;the&nbsp;pbuffer&nbsp;cannot&nbsp;be&nbsp;created&nbsp;anymore&nbsp;(OSG&nbsp;displays&nbsp;&quot;Error:&nbsp;Unable&nbsp;to&nbsp;create&nbsp;pbuffer.&quot;).&nbsp;It&nbsp;seems&nbsp;to&nbsp;me&nbsp;that&nbsp;&quot;::osg::ref_ptr&lt;::osg::GraphicsContext&gt;&nbsp;pbuffer&nbsp;=&nbsp;&nbsp;::osg::GraphicsContext::createGraphicsContext(traits.get());&nbsp;&quot;&lt;br&gt;does&nbsp;not&nbsp;work&nbsp;in&nbsp;this&nbsp;setup.&nbsp;&lt;br&gt;&lt;br&gt;If&nbsp;I&nbsp;remove&nbsp;the&nbsp;cameras&nbsp;(and&nbsp;all&nbsp;OSG&nbsp;components)&nbsp;from&nbsp;my&nbsp;code,&nbsp;it&nbsp;is&nbsp;working&nbsp;well&nbsp;in&nbsp;parallel,&nbsp;but&nbsp;of&nbsp;course&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;have&nbsp;cameras&nbsp;in&nbsp;my&nbsp;simulations.&nbsp;&lt;br&gt;&lt;br&gt;Ideally,&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;run&nbsp;OSG&nbsp;in&nbsp;a&nbsp;single-thread&nbsp;mode&nbsp;and&nbsp;let&nbsp;TBB&nbsp;distribute&nbsp;the&nbsp;different&nbsp;instances&nbsp;of&nbsp;the&nbsp;simulator&nbsp;and&nbsp;OSG&nbsp;in&nbsp;different&nbsp;threads,&nbsp;but&nbsp;even&nbsp;with&nbsp;&quot;setThreadingModel(osgViewer::ViewerBase::ThreadingModel::SingleThreaded);&quot;&nbsp;it&nbsp;does&nbsp;not&nbsp;work.&nbsp;&lt;br&gt;I&nbsp;tried&nbsp;different&nbsp;threading&nbsp;modes,&nbsp;with&nbsp;the&nbsp;same&nbsp;result.&lt;br&gt;&lt;br&gt;So&nbsp;here&nbsp;is&nbsp;my&nbsp;question:&nbsp;&lt;br&gt;What&nbsp;would&nbsp;be&nbsp;the&nbsp;most&nbsp;appropriate&nbsp;way&nbsp;to&nbsp;run&nbsp;several&nbsp;independent&nbsp;viewers&nbsp;and&nbsp;pbuffers,&nbsp;each&nbsp;in&nbsp;a&nbsp;different&nbsp;thread?&nbsp;&lt;br&gt;The&nbsp;rendered&nbsp;scenes&nbsp;are&nbsp;really&nbsp;simple&nbsp;(no&nbsp;texture,&nbsp;just&nbsp;several&nbsp;primitive&nbsp;shapes)&nbsp;and&nbsp;I&nbsp;am&nbsp;only&nbsp;rendering&nbsp;a&nbsp;couple&nbsp;of&nbsp;frames&nbsp;in&nbsp;each&nbsp;simulation,&nbsp;so&nbsp;I&nbsp;don't&nbsp;need&nbsp;a&nbsp;complex&nbsp;threading&nbsp;model&nbsp;for&nbsp;OSG.&nbsp;&lt;br&gt;&lt;br&gt;&lt;br&gt;Some&nbsp;information&nbsp;about&nbsp;my&nbsp;system:&lt;br&gt;-&nbsp;Ubuntu&nbsp;18.04&lt;br&gt;-&nbsp;OSG&nbsp;3.6.4&lt;br&gt;&lt;br&gt;Thank&nbsp;you&nbsp;in&nbsp;advance&nbsp;for&nbsp;your&nbsp;help.&nbsp;&lt;br&gt;&lt;br&gt;Best&nbsp;regards,&nbsp;&lt;br&gt;&lt;br&gt;Antoine&lt;br&gt;&lt;br&gt;------------------&lt;br&gt;Read&nbsp;this&nbsp;topic&nbsp;online&nbsp;here:&lt;br&gt;http://forum.openscenegraph.org/viewtopic.php?p=76134#76134&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;_______________________________________________&lt;br&gt;osg-users&nbsp;mailing&nbsp;list&lt;br&gt;osg-users@lists.openscenegraph.org&lt;br&gt;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&lt;br&gt;&lt;/div&gt;
</tt>
