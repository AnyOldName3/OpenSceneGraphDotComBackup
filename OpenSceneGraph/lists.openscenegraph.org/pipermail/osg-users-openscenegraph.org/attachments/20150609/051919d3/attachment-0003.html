<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;Robert,&lt;br&gt;I&nbsp;did&nbsp;a&nbsp;couple&nbsp;of&nbsp;builds&nbsp;one&nbsp;for&nbsp;MacOSX&nbsp;10.10&nbsp;and&nbsp;for&nbsp;android&nbsp;gles1.&nbsp;For&nbsp;macosx&nbsp;everything&nbsp;worked&nbsp;so&nbsp;far&nbsp;but&nbsp;for&nbsp;android&nbsp;I&#39;m&nbsp;getting&nbsp;this&nbsp;error&nbsp;using&nbsp;the&nbsp;toolchain:&lt;div&gt;&lt;br&gt;&lt;/div&gt;osg-trunk/include/osg/GLDefines:35:21:&nbsp;error:&nbsp;conflicting&nbsp;declaration&nbsp;&#39;typedef&nbsp;GLfloat&nbsp;GLdouble&#39;&lt;br&gt;&lt;br&gt;I&nbsp;suspect&nbsp;this&nbsp;is&nbsp;the&nbsp;same&nbsp;problem&nbsp;others&nbsp;has&nbsp;spotted.&nbsp;I&nbsp;think&nbsp;you&nbsp;suggested&nbsp;to&nbsp;do&nbsp;a&nbsp;better&nbsp;identification&nbsp;in&nbsp;cmake,&nbsp;or&nbsp;maybe&nbsp;just&nbsp;check&nbsp;if&nbsp;the&nbsp;symbol&nbsp;already&nbsp;exists&nbsp;in&nbsp;that&nbsp;header.&nbsp;I&#39;ll&nbsp;try&nbsp;to&nbsp;provide&nbsp;a&nbsp;fix&nbsp;later&nbsp;today.&lt;br&gt;&lt;br&gt;Regards,&lt;br&gt;Rafa.&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;El&nbsp;lun.,&nbsp;8&nbsp;jun.&nbsp;2015&nbsp;a&nbsp;las&nbsp;20:01,&nbsp;Robert&nbsp;Osfield&nbsp;(&lt;&lt;a&nbsp;href=&quot;mailto:robert.osfield@gmail.com&quot;&gt;robert.osfield@gmail.com&lt;/a&gt;&gt;)&nbsp;escribi√≥:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;Jannik,&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;A&nbsp;quick&nbsp;reply&nbsp;as&nbsp;I&nbsp;am&nbsp;replying&nbsp;on&nbsp;my&nbsp;phone.&nbsp;My&nbsp;intention&nbsp;was&nbsp;to&nbsp;introduce&nbsp;the&nbsp;same&nbsp;technique&nbsp;as&nbsp;osg::Node::asTransform()&nbsp;to&nbsp;avoid&nbsp;the&nbsp;dynamic&nbsp;cast,&nbsp;but&nbsp;only&nbsp;do&nbsp;this&nbsp;if&nbsp;there&nbsp;was&nbsp;a&nbsp;noticeable&nbsp;performance&nbsp;regression.&nbsp;&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;The&nbsp;20%&nbsp;regression&nbsp;you&#39;ve&nbsp;seen&nbsp;could&nbsp;qualify.&nbsp;Is&nbsp;this&nbsp;with&nbsp;a&nbsp;release&nbsp;build?&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;As&nbsp;general&nbsp;note,&nbsp;I&nbsp;suspect&nbsp;you&nbsp;are&nbsp;over&nbsp;using&nbsp;callbacks.&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Robert&lt;/p&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;8&nbsp;Jun&nbsp;2015&nbsp;17:16,&nbsp;&quot;Jannik&nbsp;Heller&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:scrawl@baseoftrash.de&quot;&nbsp;target=&quot;_blank&quot;&gt;scrawl@baseoftrash.de&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&nbsp;type=&quot;attribution&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Hi&nbsp;Robert,&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;tried&nbsp;my&nbsp;application&nbsp;using&nbsp;the&nbsp;latest&nbsp;trunk&nbsp;and&nbsp;didn&#39;t&nbsp;notice&nbsp;any&nbsp;functional&nbsp;regressions.&lt;br&gt;<br>
&lt;br&gt;<br>
However,&nbsp;I&nbsp;did&nbsp;notice&nbsp;a&nbsp;performance&nbsp;decrease&nbsp;in&nbsp;the&nbsp;Update&nbsp;phase&nbsp;of&nbsp;about&nbsp;20%,&nbsp;compared&nbsp;to&nbsp;OSG&nbsp;3.2.0.&nbsp;This&nbsp;had&nbsp;me&nbsp;a&nbsp;bit&nbsp;concerned,&nbsp;so&nbsp;I&nbsp;digged&nbsp;through&nbsp;the&nbsp;changes&nbsp;and&nbsp;found&nbsp;commit&nbsp;&lt;a&nbsp;href=&quot;https://github.com/openscenegraph/osg/commit/e967420323bb6e500425144cb305cf8060c1c515&quot;&nbsp;target=&quot;_blank&quot;&gt;https://github.com/openscenegraph/osg/commit/e967420323bb6e500425144cb305cf8060c1c515&lt;/a&gt;&nbsp;.&lt;br&gt;<br>
Since&nbsp;that&nbsp;commit,&nbsp;we&nbsp;now&nbsp;get&nbsp;*four*&nbsp;dynamic_cast&#39;s&nbsp;per&nbsp;frame&nbsp;and&nbsp;NodeCallback,&nbsp;which&nbsp;I&nbsp;suspect&nbsp;is&nbsp;causing&nbsp;the&nbsp;slowdown.&nbsp;Two&nbsp;dynamic_cast&#39;s&nbsp;are&nbsp;in&nbsp;NodeCallback::run,&nbsp;then&nbsp;another&nbsp;two&nbsp;in&nbsp;NodeCallback::traverse.&lt;br&gt;<br>
&lt;br&gt;<br>
Changing&nbsp;to&nbsp;the&nbsp;non-deprecated&nbsp;Callback&nbsp;instead&nbsp;of&nbsp;NodeCallback&nbsp;gives&nbsp;a&nbsp;slight&nbsp;improvement&nbsp;with&nbsp;now&nbsp;just&nbsp;two&nbsp;dynamic_cast&#39;s&nbsp;in&nbsp;Callback::traverse,&nbsp;but&nbsp;still&nbsp;isn&#39;t&nbsp;optimal.&lt;br&gt;<br>
&lt;br&gt;<br>
Ideally,&nbsp;the&nbsp;application&nbsp;should&nbsp;be&nbsp;able&nbsp;to&nbsp;decide&nbsp;on&nbsp;the&nbsp;level&nbsp;of&nbsp;safety&nbsp;vs.&nbsp;level&nbsp;of&nbsp;performance&nbsp;it&nbsp;needs.&nbsp;If&nbsp;a&nbsp;Callback&nbsp;is&nbsp;only&nbsp;intended&nbsp;to&nbsp;be&nbsp;used&nbsp;on&nbsp;Nodes,&nbsp;there&nbsp;is&nbsp;little&nbsp;point&nbsp;in&nbsp;dynamic_casting&nbsp;to&nbsp;Node&nbsp;every&nbsp;frame.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;think&nbsp;I&nbsp;can&nbsp;workaround&nbsp;the&nbsp;casts&nbsp;by&nbsp;using&nbsp;a&nbsp;custom&nbsp;class&nbsp;derived&nbsp;from&nbsp;osg::Callback&nbsp;as&nbsp;the&nbsp;base&nbsp;class&nbsp;for&nbsp;all&nbsp;my&nbsp;node&nbsp;callbacks.&nbsp;Still,&nbsp;it&#39;s&nbsp;quite&nbsp;a&nbsp;peculiar&nbsp;situation&nbsp;that&nbsp;does&nbsp;affect&nbsp;all&nbsp;users&nbsp;of&nbsp;the&nbsp;OSG.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;guess&nbsp;my&nbsp;question&nbsp;comes&nbsp;down&nbsp;to,&nbsp;are&nbsp;there&nbsp;any&nbsp;plans&nbsp;on&nbsp;optimizing&nbsp;the&nbsp;Callback&nbsp;code&nbsp;before&nbsp;a&nbsp;final&nbsp;3.4&nbsp;release?&nbsp;If&nbsp;you&nbsp;aren&#39;t&nbsp;convinced,&nbsp;I&nbsp;can&nbsp;throw&nbsp;together&nbsp;a&nbsp;repro&nbsp;case&nbsp;and&nbsp;some&nbsp;profiling&nbsp;data,&nbsp;but&nbsp;I&nbsp;think&nbsp;the&nbsp;impact&nbsp;of&nbsp;4&nbsp;dynamic_cast&#39;s&nbsp;per&nbsp;frame&nbsp;and&nbsp;NodeCallback&nbsp;should&nbsp;be&nbsp;obvious.&lt;br&gt;<br>
&lt;br&gt;<br>
Cheers,&lt;br&gt;<br>
Jannik&lt;br&gt;<br>
&lt;br&gt;<br>
------------------&lt;br&gt;<br>
Read&nbsp;this&nbsp;topic&nbsp;online&nbsp;here:&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://forum.openscenegraph.org/viewtopic.php?p=63985#63985&quot;&nbsp;target=&quot;_blank&quot;&gt;http://forum.openscenegraph.org/viewtopic.php?p=63985#63985&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
osg-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:osg-users@lists.openscenegraph.org&quot;&nbsp;target=&quot;_blank&quot;&gt;osg-users@lists.openscenegraph.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>
_______________________________________________&lt;br&gt;<br>
osg-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:osg-users@lists.openscenegraph.org&quot;&nbsp;target=&quot;_blank&quot;&gt;osg-users@lists.openscenegraph.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
