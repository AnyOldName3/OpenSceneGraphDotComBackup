<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;Robert,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Sorry&nbsp;for&nbsp;the&nbsp;late&nbsp;reply.&nbsp;The&nbsp;codes&nbsp;of&nbsp;CreateGeometryNode&nbsp;looks&nbsp;like&nbsp;this: &lt;/div&gt;&lt;div&gt;&lt;div&gt;osg::ref_ptr&lt;osg::MatrixTransform&gt;&nbsp;CreateGeometryNode()&nbsp;{&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;std::vector&lt;float&gt;&nbsp;xyzs&nbsp;=&nbsp;RandomPoints();&nbsp;///&lt;&nbsp;Create&nbsp;ramdon&nbsp;number&nbsp;of&nbsp;points &lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;osg::Vec3Array&nbsp;vs&nbsp;=&nbsp;new&nbsp;osg::Vec3Array(xyzs.size()/3,&nbsp;(const&nbsp;osg::Vec3&nbsp;*)(xyzs.data()));&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;osg::ref_ptr&lt;osg::Geometry&gt;&nbsp;geo&nbsp;=&nbsp;new&nbsp;osg::Geometry;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;geo-&gt;setVertexArray(vs.get());&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;geo-&gt;setColorArray(osg::Vec3(0.5,0.5,0.5));&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;geo-&gt;setColorBinding(osg::Geometry::BIND_OVERALL);&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;geo-&gt;addPrimitiveSet(new&nbsp;osg::DrawArrays(osg::PrimitiveSet::POINTS,&nbsp;0,&nbsp;numpt));&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;geo-&gt;getOrCreateStateSet()-&gt;setMode(GL_LIGHTING,&nbsp;osg::StateAttribute::OFF);&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;geo-&gt;getOrCreateStateSet()-&gt;setAttribute(new&nbsp;osg::Point(size),&nbsp;osg::StateAttribute::ON);&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;osg::ref_ptr&lt;osg::MatrixTransform&gt;&nbsp;mt&nbsp;=&nbsp;new&nbsp;osg::MatrixTransform;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;osg::ref_ptr&lt;osg::Geode&gt;&nbsp;geode&nbsp;=&nbsp;new&nbsp;osg::Geode;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;geode-&gt;addDrawable(geo.get());&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;mt-&gt;addChild(geode);&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;return&nbsp;mt; &lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;There&#39;s&nbsp;an&nbsp;old&nbsp;post&nbsp;from&nbsp;you&nbsp;which&nbsp;said&nbsp;that&nbsp;OSG&nbsp;will&nbsp;cache&nbsp;objects&nbsp;to&nbsp;improve&nbsp;performance,&nbsp;I&nbsp;wonder&nbsp;if&nbsp;this&nbsp;is&nbsp;the&nbsp;case&nbsp;and&nbsp;how&nbsp;I&nbsp;could&nbsp;change&nbsp;that&nbsp;behavior. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks! &lt;/div&gt;&lt;br&gt;On&nbsp;Wednesday,&nbsp;May&nbsp;27,&nbsp;2020&nbsp;at&nbsp;2:37:27&nbsp;AM&nbsp;UTC+8,&nbsp;Robert&nbsp;Osfield&nbsp;wrote:&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0;margin-left:&nbsp;0.8ex;border-left:&nbsp;1px&nbsp;#ccc&nbsp;solid;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Hi&nbsp;Hui,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;On&nbsp;Tuesday,&nbsp;26&nbsp;May&nbsp;2020&nbsp;10:36:18&nbsp;UTC+1,&nbsp;Hui&nbsp;Li&nbsp;&nbsp;wrote:&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0;margin-left:0.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;div&gt;The&nbsp;codes&nbsp;looks&nbsp;like&nbsp;this: &lt;/div&gt;&lt;div&gt;```&lt;/div&gt;&lt;div&gt;&lt;div&gt;root&nbsp;=&nbsp;GroupOfSwitch(); &lt;/div&gt;&lt;div&gt;viewer-&gt;setSceneData(root);&lt;/div&gt;&lt;div&gt;while&nbsp;(!viewer-&gt;done())&nbsp;{&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;root-&gt;removeChild(0);&nbsp;//&nbsp;Remove&nbsp;the&nbsp;point&nbsp;cloud &lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;pc&nbsp;=&nbsp;sensor.Capture(); &nbsp;//&nbsp;Get&nbsp;the&nbsp;point&nbsp;cloud&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;geo&nbsp;=&nbsp;CreateGeometryNode(pc);&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;root-&gt;addChild(geo);&nbsp;//&nbsp;Add&nbsp;the&nbsp;pointcloud &lt;/div&gt;&lt;div&gt; &nbsp; &nbsp;viewer-&gt;frame();&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;&quot;principle&quot;&nbsp;this&nbsp;shouldn&#39;t&nbsp;cause&nbsp;unbounded&nbsp;memory&nbsp;growth&nbsp;but&nbsp;as&nbsp;you&nbsp;don&#39;t&nbsp;provide&nbsp;any&nbsp;details&nbsp;about&nbsp;the&nbsp;CreateGeometryNode()&nbsp;there&nbsp;is&nbsp;no&nbsp;way&nbsp;for&nbsp;use&nbsp;know&nbsp;what&nbsp;is&nbsp;going&nbsp;on&nbsp;there. &nbsp;It&nbsp;could&nbsp;be&nbsp;that&nbsp;your&nbsp;leak&nbsp;it&nbsp;right&nbsp;there&nbsp;in&nbsp;that&nbsp;function&nbsp;call,&nbsp;or&nbsp;else&nbsp;where&nbsp;somewhere&nbsp;in&nbsp;your&nbsp;application.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;While&nbsp;I&nbsp;can&#39;t&nbsp;comment&nbsp;about&nbsp;the&nbsp;details&nbsp;of&nbsp;your&nbsp;implementation&nbsp;the&nbsp;approach&nbsp;of&nbsp;removing,&nbsp;creating&nbsp;and&nbsp;adding&nbsp;new&nbsp;nodes&nbsp;and&nbsp;associated&nbsp;data&nbsp;each&nbsp;frame&nbsp;is&nbsp;really,&nbsp;really&nbsp;inefficient.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;As&nbsp;much&nbsp;as&nbsp;possible&nbsp;you&nbsp;should&nbsp;try&nbsp;to&nbsp;reuse&nbsp;data. &nbsp;For&nbsp;a&nbsp;point&nbsp;cloud&nbsp;application&nbsp;where&nbsp;the&nbsp;data&nbsp;is&nbsp;dynamic&nbsp;I&nbsp;would&nbsp;personally&nbsp;allocate&nbsp;a&nbsp;fixed&nbsp;number&nbsp;of&nbsp;Geometry&nbsp;nodes&nbsp;with&nbsp;fixed&nbsp;Vec3Array&#39;s&nbsp;within&nbsp;them&nbsp;and&nbsp;single&nbsp;DrawArray&nbsp;primitive&nbsp;set. &nbsp;I&#39;d&nbsp;allocate&nbsp;the&nbsp;Vec3Array&nbsp;to&nbsp;it&#39;s&nbsp;full&nbsp;size&nbsp;right&nbsp;up&nbsp;front&nbsp;and&nbsp;next&nbsp;change&nbsp;it&#39;s&nbsp;size. &nbsp;The&nbsp;DrawArrays&nbsp;has&nbsp;a&nbsp;count&nbsp;value&nbsp;that&nbsp;you&nbsp;can&nbsp;set&nbsp;to&nbsp;specify&nbsp;how&nbsp;many&nbsp;vertices&nbsp;in&nbsp;the&nbsp;array&nbsp;need&nbsp;to&nbsp;be&nbsp;rendered&nbsp;and&nbsp;needn&#39;t&nbsp;be&nbsp;the&nbsp;whole&nbsp;length&nbsp;of&nbsp;the&nbsp;Vec3Aray.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;With&nbsp;really&nbsp;large&nbsp;datasets&nbsp;I&nbsp;would&nbsp;chunk&nbsp;the&nbsp;data&nbsp;so&nbsp;rather&nbsp;one&nbsp;big&nbsp;osg::Geometry,&nbsp;I&#39;d&nbsp;have&nbsp;say&nbsp;10,000&nbsp;vertices&nbsp;in&nbsp;each&nbsp;osg::Geometry. &nbsp;I&nbsp;would&nbsp;also&nbsp;use&nbsp;VertexBufferObjects&nbsp;and&nbsp;avoid&nbsp;using&nbsp;DisplayLists.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Do&nbsp;this&nbsp;all&nbsp;correctly&nbsp;and&nbsp;you&nbsp;should&nbsp;get&nbsp;a&nbsp;good&nbsp;performance&nbsp;and&nbsp;no&nbsp;memory&nbsp;growth.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Robert.&lt;br&gt;&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;<br>
<br>
&lt;p&gt;&lt;/p&gt;<br>
<br>
--&nbsp;&lt;br&nbsp;/&gt;<br>
You&nbsp;received&nbsp;this&nbsp;message&nbsp;because&nbsp;you&nbsp;are&nbsp;subscribed&nbsp;to&nbsp;the&nbsp;Google&nbsp;Groups&nbsp;&quot;OpenSceneGraph&nbsp;Users&quot;&nbsp;group.&lt;br&nbsp;/&gt;<br>
To&nbsp;unsubscribe&nbsp;from&nbsp;this&nbsp;group&nbsp;and&nbsp;stop&nbsp;receiving&nbsp;emails&nbsp;from&nbsp;it,&nbsp;send&nbsp;an&nbsp;email&nbsp;to&nbsp;&lt;a&nbsp;href=&quot;mailto:osg-users+unsubscribe@googlegroups.com&quot;&gt;osg-users+unsubscribe@googlegroups.com&lt;/a&gt;.&lt;br&nbsp;/&gt;<br>
To&nbsp;view&nbsp;this&nbsp;discussion&nbsp;on&nbsp;the&nbsp;web&nbsp;visit&nbsp;&lt;a&nbsp;href=&quot;https://groups.google.com/d/msgid/osg-users/ddac852b-0888-42a4-82d8-23a92f83b571%40googlegroups.com?utm_medium=email&amp;utm_source=footer&quot;&gt;https://groups.google.com/d/msgid/osg-users/ddac852b-0888-42a4-82d8-23a92f83b571%40googlegroups.com&lt;/a&gt;.&lt;br&nbsp;/&gt;<br>

</tt>
