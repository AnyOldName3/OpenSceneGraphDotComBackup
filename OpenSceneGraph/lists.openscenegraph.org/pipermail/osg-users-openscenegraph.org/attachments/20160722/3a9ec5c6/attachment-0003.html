<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=windows-1252&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;bgcolor=&quot;#FFFFFF&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Hi&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Josiah&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;Am&nbsp;22.07.2016&nbsp;um&nbsp;13:00&nbsp;schrieb&nbsp;Josiah<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jideani:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;cite=&quot;mid:1469185204.m2f.68195@forum.openscenegraph.org&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Hi,<br>
<br>
I&nbsp;am&nbsp;developing&nbsp;a&nbsp;scientific&nbsp;visualization&nbsp;application&nbsp;using&nbsp;Qt&nbsp;and&nbsp;Openscenegraph.&nbsp;&nbsp;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;create&nbsp;a&nbsp;3D&nbsp;osg::Image&nbsp;to&nbsp;add&nbsp;to&nbsp;an&nbsp;osgVolume.&nbsp;&nbsp;I&nbsp;am&nbsp;having&nbsp;problems&nbsp;allocating&nbsp;the&nbsp;image&nbsp;data&nbsp;when&nbsp;I&nbsp;call&nbsp;the&nbsp;allocateImage&nbsp;member&nbsp;function&nbsp;(see&nbsp;the&nbsp;code&nbsp;snippet&nbsp;below).<br>
<br>
The&nbsp;allocation&nbsp;works&nbsp;for&nbsp;equal&nbsp;dimensions&nbsp;less&nbsp;than&nbsp;640.<br>
<br>
When&nbsp;I&nbsp;try&nbsp;to&nbsp;allocate&nbsp;anything&nbsp;above&nbsp;640x640x640&nbsp;but&nbsp;less&nbsp;than&nbsp;800x800x800,&nbsp;it&nbsp;seems&nbsp;to&nbsp;allocate&nbsp;successfully&nbsp;because&nbsp;image_s,&nbsp;image_t&nbsp;and&nbsp;image_r&nbsp;hold&nbsp;the&nbsp;correct&nbsp;sizes&nbsp;however&nbsp;when&nbsp;I&nbsp;try&nbsp;to&nbsp;write&nbsp;to&nbsp;the&nbsp;image&nbsp;data&nbsp;(the&nbsp;nested&nbsp;for&nbsp;loops)&nbsp;a&nbsp;segmentation&nbsp;fault&nbsp;is&nbsp;thrown&nbsp;at&nbsp;data[0]&nbsp;=&nbsp;0.0f&nbsp;when&nbsp;s&nbsp;=&nbsp;0;&nbsp;t&nbsp;=&nbsp;0;&nbsp;and&nbsp;r&nbsp;=&nbsp;some&nbsp;random&nbsp;but&nbsp;valid&nbsp;number.&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Putting&nbsp;the&nbsp;numbers&nbsp;together,&nbsp;640^3&nbsp;with&nbsp;4*4&nbsp;bytes&nbsp;(float&nbsp;and&nbsp;rgba)<br>
&nbsp;&nbsp;&nbsp;&nbsp;hits&nbsp;the&nbsp;4&nbsp;gig&nbsp;limit.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;believe&nbsp;the&nbsp;image&nbsp;size&nbsp;used&nbsp;internally&nbsp;by&nbsp;OSG&nbsp;is&nbsp;an&nbsp;unsigned<br>
&nbsp;&nbsp;&nbsp;&nbsp;int(which&nbsp;on&nbsp;most&nbsp;platforms&nbsp;is&nbsp;32bits)&nbsp;,&nbsp;so&nbsp;that&nbsp;is&nbsp;probably&nbsp;what<br>
&nbsp;&nbsp;&nbsp;&nbsp;you're&nbsp;hitting.[1]&nbsp;Could&nbsp;you&nbsp;check&nbsp;what&nbsp;the&nbsp;calculated&nbsp;image&nbsp;size<br>
&nbsp;&nbsp;&nbsp;&nbsp;returns,&nbsp;when&nbsp;you&nbsp;encounter&nbsp;the&nbsp;allocation&nbsp;fails?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Typ&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;my&nbsp;theory&nbsp;is&nbsp;right,&nbsp;we&nbsp;would&nbsp;have&nbsp;to&nbsp;change&nbsp;the&nbsp;data&nbsp;type&nbsp;used<br>
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;calculation&nbsp;to&nbsp;long/size_t.&nbsp;(Seems&nbsp;like&nbsp;the&nbsp;calculation&nbsp;and&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;constructor&nbsp;are&nbsp;the&nbsp;only&nbsp;places&nbsp;that&nbsp;fail&nbsp;to&nbsp;use&nbsp;the&nbsp;correct&nbsp;size)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Cheers&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Sebastian&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;[1]<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://trac.openscenegraph.org/projects/osg//browser/OpenSceneGraph/trunk/src/osg/Image.cpp?rev=10890&quot;&gt;http://trac.openscenegraph.org/projects/osg//browser/OpenSceneGraph/trunk/src/osg/Image.cpp?rev=10890&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;&lt;span&nbsp;class=&quot;code-type&quot;&gt;unsigned&lt;/span&gt;&lt;/b&gt; &lt;b&gt;&lt;span<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class=&quot;code-type&quot;&gt;int&lt;/span&gt;&lt;/b&gt; &lt;b&gt;&lt;span&nbsp;class=&quot;code-func&quot;&gt;Image::getTotalSizeInBytesIncludingMipmaps&lt;/span&gt;&lt;/b&gt;()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;&lt;span&nbsp;class=&quot;code-type&quot;&gt;const&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/b&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;cite=&quot;mid:1469185204.m2f.68195@forum.openscenegraph.org&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
<br>
I&nbsp;can&nbsp;allocate&nbsp;and&nbsp;write&nbsp;to&nbsp;the&nbsp;image&nbsp;data&nbsp;with&nbsp;sizes&nbsp;between&nbsp;800x800x800&nbsp;and&nbsp;1024x1024x1024,&nbsp;but&nbsp;a&nbsp;segmentation&nbsp;fault&nbsp;is&nbsp;thrown&nbsp;from&nbsp;the&nbsp;object&nbsp;code&nbsp;after&nbsp;the&nbsp;call&nbsp;to&nbsp;the&nbsp;viewer's&nbsp;frame()&nbsp;method.<br>
<br>
And&nbsp;finally&nbsp;for&nbsp;sizes&nbsp;above&nbsp;1024&nbsp;the&nbsp;allocation&nbsp;completely&nbsp;fails&nbsp;as&nbsp;image_s&nbsp;image_t&nbsp;and&nbsp;image_r&nbsp;all&nbsp;hold&nbsp;0.<br>
<br>
Any&nbsp;clue&nbsp;on&nbsp;how&nbsp;to&nbsp;solve&nbsp;this?&nbsp;It&nbsp;was&nbsp;my&nbsp;understanding&nbsp;that&nbsp;the&nbsp;maximum&nbsp;size&nbsp;of&nbsp;the&nbsp;image&nbsp;is&nbsp;limited&nbsp;by&nbsp;the&nbsp;maximum&nbsp;3D&nbsp;texture&nbsp;size&nbsp;of&nbsp;the&nbsp;graphics&nbsp;card&nbsp;which&nbsp;for&nbsp;the&nbsp;Quadro&nbsp;K4200&nbsp;that&nbsp;I'm&nbsp;using&nbsp;is&nbsp;4096x4096x4096.&nbsp;&nbsp;So&nbsp;why&nbsp;am&nbsp;I&nbsp;only&nbsp;able&nbsp;to&nbsp;allocate&nbsp;a&nbsp;640x640x640&nbsp;image?<br>
<br>
These&nbsp;are&nbsp;the&nbsp;specifications&nbsp;of&nbsp;my&nbsp;system:<br>
Operating&nbsp;system:&nbsp;Opensuse&nbsp;Leap&nbsp;42.1<br>
RAM:&nbsp;128GB<br>
Graphics&nbsp;Card:&nbsp;Quadro&nbsp;K4200<br>
Qt:&nbsp;Qt&nbsp;4.7.1<br>
OSG&nbsp;version:&nbsp;3.2.3&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Are&nbsp;you&nbsp;trying&nbsp;to&nbsp;compensate&nbsp;something?&nbsp;;-)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;cite=&quot;mid:1469185204.m2f.68195@forum.openscenegraph.org&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
<br>
<br>
<br>
Thank&nbsp;you!<br>
<br>
Cheers,<br>
Josiah<br>
<br>
<br>
Code:<br>
<br>
osg::ref_ptr&lt;osg::Image&gt;&nbsp;image&nbsp;=&nbsp;new&nbsp;osg::Image<br>
image-&gt;allocateImage(1024,&nbsp;1024,&nbsp;1024,&nbsp;GL_RGBA,&nbsp;GL_FLOAT);<br>
<br>
int&nbsp;image_s&nbsp;=&nbsp;image-&gt;s();<br>
int&nbsp;image_t&nbsp;=&nbsp;image-&gt;t();<br>
int&nbsp;image_r&nbsp;=&nbsp;image-&gt;r();<br>
<br>
for(int&nbsp;s&nbsp;=&nbsp;0;&nbsp;s&nbsp;&lt;&nbsp;image_s;&nbsp;s++)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;t&nbsp;=&nbsp;0;&nbsp;t&nbsp;&lt;&nbsp;image_t;&nbsp;t++)<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;r&nbsp;=&nbsp;0;&nbsp;r&nbsp;&lt;&nbsp;image_r;&nbsp;r++)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float*&nbsp;data&nbsp;=&nbsp;(float*)&nbsp;image-&gt;data(s,t,r);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[0]&nbsp;=&nbsp;0.0f;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[1]&nbsp;=&nbsp;0.0f;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[2]&nbsp;=&nbsp;1.0f;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[3]&nbsp;=&nbsp;0.1f;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
<br>
<br>
<br>
<br>
------------------<br>
Read&nbsp;this&nbsp;topic&nbsp;online&nbsp;here:<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://forum.openscenegraph.org/viewtopic.php?p=68195#68195&quot;&gt;http://forum.openscenegraph.org/viewtopic.php?p=68195#68195&lt;/a&gt;<br>
<br>
<br>
<br>
<br>
<br>
_______________________________________________<br>
osg-users&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:osg-users@lists.openscenegraph.org&quot;&gt;osg-users@lists.openscenegraph.org&lt;/a&gt;<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&quot;&gt;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&lt;/a&gt;<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
