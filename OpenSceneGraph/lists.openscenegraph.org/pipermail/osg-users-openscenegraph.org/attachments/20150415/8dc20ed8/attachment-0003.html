<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;Jannik,&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;15&nbsp;April&nbsp;2015&nbsp;at&nbsp;11:55,&nbsp;Jannik&nbsp;Heller&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:scrawl@baseoftrash.de&quot;&nbsp;target=&quot;_blank&quot;&gt;scrawl@baseoftrash.de&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Thanks&nbsp;for&nbsp;the&nbsp;hints&nbsp;-&nbsp;I&nbsp;am&nbsp;using&nbsp;a&nbsp;release&nbsp;build,&nbsp;and&nbsp;I&nbsp;already&nbsp;disabled&nbsp;double&nbsp;precision&nbsp;from&nbsp;cmake&nbsp;which&nbsp;gave&nbsp;me&nbsp;another&nbsp;nice&nbsp;boost.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;am&nbsp;surprised&nbsp;you&nbsp;saw&nbsp;a&nbsp;boost&nbsp;with&nbsp;disable&nbsp;double&nbsp;precision. &nbsp;What&nbsp;specific&nbsp;element&nbsp;you&nbsp;do&nbsp;you&nbsp;change&nbsp;w.r.t&nbsp;double&nbsp;precision?&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;For&nbsp;the&nbsp;change&nbsp;to&nbsp;double&nbsp;precision&nbsp;making&nbsp;a&nbsp;difference&nbsp;it&#39;s&nbsp;a&nbsp;hint&nbsp;that&nbsp;you&nbsp;have&nbsp;a&nbsp;scene&nbsp;that&nbsp;is&nbsp;poorly&nbsp;balanced. &nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
In&nbsp;the&nbsp;stats&nbsp;handler&nbsp;I&nbsp;am&nbsp;seeing&nbsp;roughly&nbsp;the&nbsp;same&nbsp;amount&nbsp;of&nbsp;time&nbsp;spent&nbsp;in&nbsp;the&nbsp;cull,&nbsp;draw&nbsp;and&nbsp;GPU&nbsp;threads.&nbsp;After&nbsp;adding&nbsp;the&nbsp;double&nbsp;buffering&nbsp;the&nbsp;3&nbsp;threads&nbsp;all&nbsp;run&nbsp;in&nbsp;parallel&nbsp;so&nbsp;performance&nbsp;is&nbsp;decent&nbsp;now.&lt;br&gt;<br>
I&nbsp;know&nbsp;that&nbsp;my&nbsp;app&nbsp;is&nbsp;CPU&nbsp;bound&nbsp;but&nbsp;there&#39;s&nbsp;not&nbsp;much&nbsp;I&nbsp;can&nbsp;do&nbsp;about&nbsp;it.&lt;br&gt;<br>
Some&nbsp;of&nbsp;the&nbsp;time&nbsp;in&nbsp;the&nbsp;cull&nbsp;thread&nbsp;is&nbsp;spent&nbsp;updating&nbsp;vertex&nbsp;animations,&nbsp;and&nbsp;some&nbsp;time&nbsp;for&nbsp;organizing&nbsp;light&nbsp;lists.&nbsp;I&nbsp;have&nbsp;scenes&nbsp;with&nbsp;a&nbsp;lot&nbsp;more&nbsp;than&nbsp;8&nbsp;lights,&nbsp;so&nbsp;I&nbsp;have&nbsp;to&nbsp;check&nbsp;what&nbsp;lights&nbsp;are&nbsp;closest&nbsp;to&nbsp;a&nbsp;given&nbsp;sub-graph&nbsp;before&nbsp;rendering&nbsp;it.&nbsp;This&nbsp;system&nbsp;was&nbsp;really&nbsp;slow&nbsp;to&nbsp;begin&nbsp;with&nbsp;but&nbsp;I&nbsp;already&nbsp;optimized&nbsp;it&nbsp;a&nbsp;lot.&nbsp;Non&nbsp;the&nbsp;less&nbsp;setting&nbsp;the&nbsp;lights&nbsp;still&nbsp;has&nbsp;a&nbsp;noticable&nbsp;overhead.&lt;br&gt;<br>
Next&nbsp;problem&nbsp;is&nbsp;the&nbsp;sheer&nbsp;number&nbsp;of&nbsp;objects&nbsp;-&nbsp;often&nbsp;thousands&nbsp;per&nbsp;scene.&nbsp;I&nbsp;tried&nbsp;batching&nbsp;before&nbsp;but&nbsp;the&nbsp;problem&nbsp;is&nbsp;the&nbsp;scenes&nbsp;I&nbsp;am&nbsp;working&nbsp;with&nbsp;are&nbsp;scripted,&nbsp;so&nbsp;objects&nbsp;can&nbsp;be&nbsp;moved&nbsp;or&nbsp;removed&nbsp;at&nbsp;any&nbsp;time,&nbsp;also,&nbsp;batching&nbsp;objects&nbsp;would&nbsp;interfere&nbsp;with&nbsp;the&nbsp;light&nbsp;lists&nbsp;-&nbsp;i.e.&nbsp;with&nbsp;too&nbsp;many&nbsp;objects&nbsp;sharing&nbsp;a&nbsp;large&nbsp;batch&nbsp;I&nbsp;can&nbsp;not&nbsp;set&nbsp;fine&nbsp;grained&nbsp;light&nbsp;lists&nbsp;on&nbsp;them.&lt;br&gt;<br>
I&#39;m&nbsp;looking&nbsp;forward&nbsp;to&nbsp;switching&nbsp;the&nbsp;light&nbsp;system&nbsp;to&nbsp;deferred&nbsp;shading&nbsp;in&nbsp;the&nbsp;future&nbsp;-&nbsp;I&#39;m&nbsp;sure&nbsp;then&nbsp;it&nbsp;will&nbsp;be&nbsp;GPU&nbsp;bound.&nbsp;I&nbsp;still&nbsp;need&nbsp;a&nbsp;forward&nbsp;rendering&nbsp;fallback&nbsp;in&nbsp;place&nbsp;though.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thousands&nbsp;of&nbsp;objects&nbsp;per&nbsp;frame&nbsp;is&nbsp;not&nbsp;unusually&nbsp;for&nbsp;a&nbsp;scene&nbsp;graph&nbsp;application&nbsp;and&nbsp;should&nbsp;work&nbsp;fine&nbsp;rendering&nbsp;at&nbsp;60hz&nbsp;on&nbsp;modern&nbsp;hardware. &nbsp;If&nbsp;you&nbsp;are&nbsp;hitting&nbsp;CPU&nbsp;limits&nbsp;prematurely&nbsp;then&nbsp;it&#39;s&nbsp;another&nbsp;hint&nbsp;that&nbsp;the&nbsp;scene&nbsp;graph&nbsp;is&nbsp;poorly&nbsp;balanced.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;There&nbsp;are&nbsp;lots&nbsp;of&nbsp;different&nbsp;things&nbsp;you&nbsp;can&nbsp;do&nbsp;to&nbsp;create&nbsp;a&nbsp;more&nbsp;efficient&nbsp;scene&nbsp;graph,&nbsp;exactly&nbsp;what&nbsp;to&nbsp;advice&nbsp;is&nbsp;hard&nbsp;to&nbsp;do&nbsp;without&nbsp;knowing&nbsp;more&nbsp;specifics&nbsp;about&nbsp;the&nbsp;application&nbsp;and&nbsp;types&nbsp;of&nbsp;data&nbsp;being&nbsp;handling. &nbsp;Batching&nbsp;might&nbsp;be&nbsp;one&nbsp;thing&nbsp;to&nbsp;try,&nbsp;but&nbsp;only&nbsp;if&nbsp;it&#39;s&nbsp;established&nbsp;as&nbsp;the&nbsp;main&nbsp;bottleneck. &nbsp;From&nbsp;what&nbsp;you&#39;ve&nbsp;written&nbsp;I&nbsp;wonder&nbsp;if&nbsp;the&nbsp;animation&nbsp;element&nbsp;to&nbsp;your&nbsp;scene&nbsp;is&nbsp;what&nbsp;is&nbsp;slowing&nbsp;things&nbsp;down.  &nbsp;Are&nbsp;you&nbsp;using&nbsp;CPU&nbsp;based&nbsp;animation? &nbsp;Could&nbsp;you&nbsp;shift&nbsp;it&nbsp;onto&nbsp;the&nbsp;GPU?&nbsp;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Robert.&lt;br&gt;&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
