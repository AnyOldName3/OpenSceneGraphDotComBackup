<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;HI&nbsp;Clement,&lt;br&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;1&nbsp;September&nbsp;2017&nbsp;at&nbsp;10:26,&nbsp;&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:Clement.Chu@csiro.au&quot;&nbsp;target=&quot;_blank&quot;&gt;Clement.Chu@csiro.au&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;<br>
<br>
<br>
<br>
<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;style=&quot;font-size:12pt;color:rgb(0,0,0);background-color:rgb(255,255,255);font-family:Calibri,Arial,Helvetica,sans-serif&quot;&gt; &nbsp;Since&nbsp;I&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;to&nbsp;debug&nbsp;or&nbsp;print&nbsp;message&nbsp;in&nbsp;shader&nbsp;code,&nbsp;I&nbsp;am&nbsp;not&nbsp;sure&nbsp;what&nbsp;exact&nbsp;value&nbsp;of&nbsp;vertex. &nbsp;I&nbsp;guess&nbsp;the&nbsp;value&nbsp;of&nbsp;vertex&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;(0.0&nbsp;to&nbsp;1.0),&nbsp;so&nbsp;texture3D&nbsp;method&nbsp;cannot&nbsp;get&nbsp;correct&nbsp;color&nbsp;value&nbsp;by&nbsp;coordinate. &nbsp;In&nbsp;file&nbsp;volume_frag.cpp, <br>
&nbsp;variable&nbsp;texcoord&nbsp;is&nbsp;assigned&nbsp;from&nbsp;vertex&nbsp;data.&nbsp;If&nbsp;vertex&nbsp;data&nbsp;is&nbsp;not&nbsp;the&nbsp;0.0f&nbsp;to&nbsp;1.0f&nbsp;range,&nbsp;variable&nbsp;color&nbsp;(type&nbsp;vec4)&nbsp;will&nbsp;become strange&nbsp;value. &nbsp;Even I&nbsp;added some codes&nbsp;to make&nbsp;sure values&nbsp;of&nbsp;color.x, color.y,&nbsp;color.z&nbsp;and&nbsp;color.w &nbsp;in&nbsp;the&nbsp;range&nbsp;(0.0&nbsp;to<br>
&nbsp;1.0),&nbsp;it&nbsp;still&nbsp;cause&nbsp;the&nbsp;crash.&nbsp;Unless&nbsp;vertex&nbsp;is&nbsp;in&nbsp;the&nbsp;range&nbsp;(0.0&nbsp;to&nbsp;1.0).&nbsp;So&nbsp;far,&nbsp;this&nbsp;problem&nbsp;occurs&nbsp;in&nbsp;Intel&nbsp;HD&nbsp;Graphics&nbsp;520&nbsp;or&nbsp;above. &nbsp;My&nbsp;old&nbsp;laptop&nbsp;is&nbsp;Intel&nbsp;HD&nbsp;Graphics&nbsp;3000,&nbsp;but&nbsp;it&nbsp;works&nbsp;fine&nbsp;and&nbsp;Nvidia&nbsp;cards&nbsp;work&nbsp;fine&nbsp;too.&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Debugging&nbsp;shaders&nbsp;is&nbsp;*really*&nbsp;hard&nbsp;because&nbsp;you&nbsp;just&nbsp;can&#39;t&nbsp;put&nbsp;in&nbsp;break&nbsp;points,&nbsp;print&nbsp;out&nbsp;values,&nbsp;do&nbsp;any&nbsp;of&nbsp;the&nbsp;normal&nbsp;debugging&nbsp;approaches&nbsp;we&nbsp;take&nbsp;for&nbsp;granted&nbsp;on&nbsp;the&nbsp;desktop. &nbsp;So&nbsp;it&#39;s&nbsp;a&nbsp;case&nbsp;of&nbsp;think&nbsp;of&nbsp;idea&nbsp;what&nbsp;might&nbsp;be&nbsp;wrong,&nbsp;adapt&nbsp;the&nbsp;shaders&nbsp;to&nbsp;test&nbsp;that,&nbsp;run&nbsp;them&nbsp;app&nbsp;and&nbsp;just&nbsp;and&nbsp;make&nbsp;sense&nbsp;of&nbsp;the&nbsp;results. &nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;fact&nbsp;that&nbsp;shaders&nbsp;can&nbsp;be&nbsp;loaded&nbsp;and&nbsp;compiled&nbsp;at&nbsp;runtime&nbsp;helps&nbsp;reduce&nbsp;the&nbsp;time&nbsp;takes&nbsp;to&nbsp;see&nbsp;changes&nbsp;so&nbsp;this&nbsp;can&nbsp;help&nbsp;a&nbsp;bit,&nbsp;for&nbsp;yourself&nbsp;I&nbsp;would&nbsp;certainly&nbsp;recommend&nbsp;copying&nbsp;the&nbsp;volume.vert&nbsp;and&nbsp;volume.frag&nbsp;shaders&nbsp;from&nbsp;OpenSceneGraph-Data,&nbsp;put &nbsp;them&nbsp;on&nbsp;your&nbsp;path&nbsp;as&nbsp;use&nbsp;in&nbsp;testing.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Another&nbsp;thing&nbsp;that&nbsp;might&nbsp;help&nbsp;if&nbsp;you&nbsp;are&nbsp;having&nbsp;to&nbsp;put&nbsp;&quot;workaround&quot;&nbsp;code&nbsp;in&nbsp;just&nbsp;for&nbsp;a&nbsp;certain&nbsp;hardware&nbsp;vendor&nbsp;then&nbsp;the&nbsp;vendor&nbsp;string&nbsp;and&nbsp;#pragma(tic)&nbsp;shader&nbsp;composition&nbsp;might&nbsp;be&nbsp;of&nbsp;help. &nbsp;I&nbsp;use&nbsp;this&nbsp;facility&nbsp;to&nbsp;detect&nbsp;and&nbsp;provide&nbsp;a&nbsp;workaround&nbsp;for&nbsp;an&nbsp;NVidia&nbsp;issue&nbsp;-&nbsp;look&nbsp;at&nbsp;how&nbsp;NVIDIA_Corporation&nbsp;is&nbsp;used&nbsp;in&nbsp;the&nbsp;shaders. &nbsp;The&nbsp;osg::State&nbsp;object&nbsp;checks&nbsp;the&nbsp;GL_VENDOR&nbsp;string&nbsp;at&nbsp;runtime&nbsp;and&nbsp;sets&nbsp;a&nbsp;#define&nbsp;with&nbsp;this&nbsp;value&nbsp;that&nbsp;you&nbsp;can&nbsp;then&nbsp;reference&nbsp;using&nbsp;#pragma&nbsp;import_defines(..). &nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;don&#39;t&nbsp;know&nbsp;what&nbsp;the&nbsp;string&nbsp;will&nbsp;be&nbsp;for&nbsp;Intel. &nbsp;Run&nbsp;an&nbsp;OSG&nbsp;application&nbsp;with&nbsp;the&nbsp;OSG_NOTIFY_LEVEL&nbsp;set&nbsp;to&nbsp;INFO&nbsp;and&nbsp;search&nbsp;the&nbsp;console&nbsp;output&nbsp;for&nbsp;a&nbsp;&quot;GL_VENDOR&nbsp;=&nbsp;&quot;&nbsp;entry. &nbsp;You&nbsp;can&nbsp;they&nbsp;use&nbsp;this&nbsp;in&nbsp;the&nbsp;shader&nbsp;mods.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;On&nbsp;the&nbsp;specific&nbsp;issue&nbsp;of&nbsp;the&nbsp;vertex&nbsp;value&nbsp;clamping,&nbsp;RayTracedTechnique&nbsp;creates&nbsp;a&nbsp;box&nbsp;with&nbsp;dimensons&nbsp;of&nbsp;0,0,0&nbsp;to&nbsp;1,1,1&nbsp;so&nbsp;there&nbsp;shouldn&#39;t&nbsp;be&nbsp;any&nbsp;values&nbsp;outside&nbsp;this&nbsp;being&nbsp;passed&nbsp;to&nbsp;the&nbsp;vertex&nbsp;shader.&nbsp;However,&nbsp;the&nbsp;CPU-&gt;driver-&gt;GPU&nbsp;might&nbsp;be&nbsp;changing&nbsp;the&nbsp;precision&nbsp;enough&nbsp;that&nbsp;you&nbsp;are&nbsp;getting&nbsp;values&nbsp;outside&nbsp;this&nbsp;range. &nbsp;I&nbsp;find&nbsp;it&nbsp;odd&nbsp;that&nbsp;the&nbsp;shaders&nbsp;would&nbsp;be&nbsp;sensitive&nbsp;to&nbsp;such&nbsp;small&nbsp;precision&nbsp;issues&nbsp;though.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Robert.&lt;br&gt;&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
