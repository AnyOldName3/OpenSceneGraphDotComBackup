<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#FFFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Hi,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;what&nbsp;we&nbsp;do&nbsp;is&nbsp;packing&nbsp;our&nbsp;instance&nbsp;parameters&nbsp;in&nbsp;a&nbsp;uniform&nbsp;array&nbsp;and<br>
&nbsp;&nbsp;&nbsp;&nbsp;access&nbsp;it&nbsp;via&nbsp;gl_InstanceID&nbsp;as&nbsp;an&nbsp;index&nbsp;into&nbsp;the&nbsp;array.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Werner&nbsp;-&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;Am&nbsp;01.08.2018&nbsp;um&nbsp;16:32&nbsp;schrieb&nbsp;Julien<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Valentin:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cite=&quot;mid:1533133957.m2f.74452@forum.openscenegraph.org&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Hi<br>
perhaps&nbsp;it's&nbsp;because&nbsp;of&nbsp;transaltion&nbsp;array&nbsp;'s&nbsp;default&nbsp;binding&nbsp;(UNDEFINED)<br>
try<br>
translation-&gt;setArrayBinding(Array::PER_VERTEX)<br>
Cheers<br>
<br>
<br>
ppsychrite&nbsp;wrote:<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;hello&nbsp;sorry&nbsp;if&nbsp;i&nbsp;did&nbsp;this&nbsp;wrong&nbsp;but&nbsp;i&nbsp;dont&nbsp;know&nbsp;how&nbsp;to&nbsp;use&nbsp;mailing&nbsp;lists<br>
<br>
so&nbsp;ive&nbsp;been&nbsp;trying&nbsp;to&nbsp;do&nbsp;modern&nbsp;glsl/opengl&nbsp;3.3+&nbsp;with&nbsp;osg::Geometry&nbsp;and&nbsp;<br>
osg::Stateset&nbsp;and&nbsp;it's&nbsp;been&nbsp;working&nbsp;OK&nbsp;for&nbsp;basic&nbsp;triangle&nbsp;except&nbsp;for&nbsp;<br>
implementing&nbsp;instanced&nbsp;array&nbsp;data<br>
am&nbsp;I&nbsp;doing&nbsp;it&nbsp;the&nbsp;wrong&nbsp;way?&nbsp;here's&nbsp;the&nbsp;.cpp&nbsp;code&nbsp;for&nbsp;it&nbsp;and&nbsp;for&nbsp;me&nbsp;it&nbsp;<br>
seems&nbsp;well&nbsp;enough&nbsp;and&nbsp;fine,&nbsp;position&nbsp;and&nbsp;color&nbsp;works&nbsp;fine<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;osg::Vec3&nbsp;coords[]&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;-0.05f,0.05f,0.f&nbsp;},<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;0.05f,-0.05f,0.f&nbsp;},<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;0.05f,0.05f,1.f&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;osg::Vec3&nbsp;colors[]&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{1.f,0.f,0.f},<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{0.f,1.f,0.f},<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{0.f,0.f,1.f}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;osg::Vec2&nbsp;instancetranslations[]&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;0.0f,&nbsp;0.0f&nbsp;},<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;0.1f,&nbsp;0.0f&nbsp;},<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;0.2f,&nbsp;0.0f&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;osg::Vec3Array&nbsp;*pos&nbsp;=&nbsp;new&nbsp;osg::Vec3Array(sizeof(coords)&nbsp;/&nbsp;<br>
sizeof(osg::Vec3),&nbsp;coords);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;osg::Vec3Array&nbsp;*color&nbsp;=&nbsp;new&nbsp;osg::Vec3Array(sizeof(colors)&nbsp;/&nbsp;<br>
sizeof(osg::Vec3),&nbsp;colors);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;osg::Vec2Array&nbsp;*translation&nbsp;=&nbsp;new&nbsp;<br>
osg::Vec2Array(sizeof(instancetranslations)&nbsp;/&nbsp;sizeof(osg::Vec2),&nbsp;<br>
instancetranslations);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;osg::Geometry&nbsp;*vao&nbsp;=&nbsp;new&nbsp;osg::Geometry();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vao-&gt;setUseDisplayList(false);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vao-&gt;setUseVertexArrayObject(true);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vao-&gt;setUseVertexBufferObjects(true);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vao-&gt;setVertexAttribArray(0,&nbsp;pos,&nbsp;osg::Array::BIND_PER_VERTEX);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vao-&gt;setVertexAttribArray(1,&nbsp;color,&nbsp;osg::Array::BIND_PER_VERTEX);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vao-&gt;setVertexAttribArray(2,&nbsp;translation);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vao-&gt;addPrimitiveSet(new&nbsp;osg::DrawArrays(GL_TRIANGLES,&nbsp;0,&nbsp;3,&nbsp;3));&nbsp;//3&nbsp;<br>
instances<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;osg::ref_ptr&lt;osg::Program&gt;&nbsp;program&nbsp;=&nbsp;new&nbsp;osg::Program;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;program-&gt;addShader(osgDB::readShaderFile(&quot;shaders/basic.vert&quot;));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;program-&gt;addShader(osgDB::readShaderFile(&quot;shaders/basic.frag&quot;));<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;osg::StateSet&nbsp;*stateset&nbsp;=&nbsp;geom-&gt;getOrCreateStateSet();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateset-&gt;setAttributeAndModes(program.get());<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateset-&gt;setAttribute(new&nbsp;osg::VertexAttribDivisor(2,&nbsp;1));&nbsp;//set&nbsp;3rd&nbsp;<br>
array&nbsp;as&nbsp;per-instance<br>
<br>
here's&nbsp;the&nbsp;vertex&nbsp;shader&nbsp;code&nbsp;for&nbsp;it:<br>
<br>
<br>
#version&nbsp;330&nbsp;core<br>
layout&nbsp;(location&nbsp;=&nbsp;0)&nbsp;in&nbsp;vec3&nbsp;aPos;<br>
layout&nbsp;(location&nbsp;=&nbsp;1)&nbsp;in&nbsp;vec3&nbsp;aColor;<br>
layout&nbsp;(location&nbsp;=&nbsp;2)&nbsp;in&nbsp;vec2&nbsp;aTrans;<br>
<br>
out&nbsp;vec3&nbsp;color;<br>
<br>
void&nbsp;main()<br>
{<br>
color&nbsp;=&nbsp;aColor;<br>
gl_Position&nbsp;=&nbsp;vec4(aPos.x+&nbsp;aTrans.x,aPos.y+&nbsp;aTrans.y,aPos.z,1.0);<br>
}<br>
<br>
<br>
aTrans&nbsp;doesn't&nbsp;move&nbsp;the&nbsp;triangle&nbsp;at&nbsp;all,&nbsp;it's&nbsp;just&nbsp;one.&nbsp;I&nbsp;know&nbsp;it&nbsp;isn't&nbsp;<br>
the&nbsp;shaders&nbsp;fault&nbsp;because&nbsp;instead&nbsp;of&nbsp;adding&nbsp;aTrans&nbsp;to&nbsp;aPos&nbsp;I've&nbsp;done&nbsp;<br>
(gl_InstanceID&nbsp;*&nbsp;0.1f)&nbsp;and&nbsp;it's&nbsp;worked&nbsp;perfectly,&nbsp;seeing&nbsp;3&nbsp;instanced&nbsp;<br>
triangles<br>
<br>
what&nbsp;am&nbsp;i&nbsp;doing&nbsp;wrong/how&nbsp;could&nbsp;i&nbsp;get&nbsp;per-instanced&nbsp;array&nbsp;working?<br>
<br>
<br>
<br>
<br>
<br>
_______________________________________________<br>
osg-users&nbsp;mailing&nbsp;list<br>
<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&quot;&gt;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&lt;/a&gt;<br>
<br>
&nbsp;------------------<br>
Post&nbsp;generated&nbsp;by&nbsp;Mail2Forum<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
<br>
------------------------<br>
Twirling&nbsp;twirling&nbsp;twirling&nbsp;toward&nbsp;freedom<br>
<br>
------------------<br>
Read&nbsp;this&nbsp;topic&nbsp;online&nbsp;here:<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://forum.openscenegraph.org/viewtopic.php?p=74452#74452&quot;&gt;http://forum.openscenegraph.org/viewtopic.php?p=74452#74452&lt;/a&gt;<br>
<br>
<br>
<br>
<br>
<br>
_______________________________________________<br>
osg-users&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:osg-users@lists.openscenegraph.org&quot;&gt;osg-users@lists.openscenegraph.org&lt;/a&gt;<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&quot;&gt;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&lt;/a&gt;<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-signature&quot;&gt;--&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;TE&lt;span&nbsp;style=&quot;color:red;&quot;&gt;X&lt;/span&gt;ION&nbsp;Software&nbsp;Solutions,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rotter&nbsp;Bruch&nbsp;26a,&nbsp;D-52068&nbsp;Aachen&lt;/b&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Phone:&nbsp;+49&nbsp;241&nbsp;475757-0&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fax:&nbsp;+49&nbsp;241&nbsp;475757-29&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Web:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://texion.eu&quot;&gt;http://texion.eu&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eMail:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:info@texion.eu&quot;&gt;info@texion.eu&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
