<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Thanks&nbsp;Robert,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;am&nbsp;aware&nbsp;of&nbsp;it,&nbsp;it&nbsp;is&nbsp;already&nbsp;used&nbsp;in&nbsp;my&nbsp;second&nbsp;snippet.&nbsp;Here&nbsp;it&nbsp;is:&nbsp;(is&nbsp;it&nbsp;done&nbsp;properly?)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;ol&nbsp;class=&quot;gmail-cpp&quot;&nbsp;style=&quot;color:rgb(172,172,172);background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial;background-color:rgb(247,247,247);margin:0px;padding:0px&nbsp;0px&nbsp;0px&nbsp;55px;font-family:consolas,menlo,monaco,&quot;lucida&nbsp;console&quot;,&quot;liberation&nbsp;mono&quot;,&quot;dejavu&nbsp;sans&nbsp;mono&quot;,&quot;bitstream&nbsp;vera&nbsp;sans&nbsp;mono&quot;,monospace,serif;font-size:12px&quot;&gt;&lt;li&nbsp;class=&quot;gmail-li1&quot;&nbsp;style=&quot;background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial;background-color:rgb(255,255,255)&quot;&gt;&lt;div&nbsp;class=&quot;gmail-de1&quot;&nbsp;style=&quot;padding:0px&nbsp;8px;vertical-align:top;color:rgb(51,51,51);border-left:1px&nbsp;solid&nbsp;rgb(221,221,221);background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial&quot;&gt;&lt;span&nbsp;class=&quot;gmail-kw4&quot;&nbsp;style=&quot;color:rgb(0,0,255)&quot;&gt;void&lt;/span&gt; MyCullVisitor&lt;span&nbsp;class=&quot;gmail-sy4&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;::&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-me2&quot;&nbsp;style=&quot;color:rgb(0,119,136)&quot;&gt;apply&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;osg&lt;span&nbsp;class=&quot;gmail-sy4&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;::&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-me2&quot;&nbsp;style=&quot;color:rgb(0,119,136)&quot;&gt;LightSource&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy3&quot;&nbsp;style=&quot;color:rgb(0,0,64)&quot;&gt;&amp;&lt;/span&gt; node&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;gmail-li1&quot;&nbsp;style=&quot;background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial;background-color:rgb(255,255,255)&quot;&gt;&lt;div&nbsp;class=&quot;gmail-de1&quot;&nbsp;style=&quot;padding:0px&nbsp;8px;vertical-align:top;color:rgb(51,51,51);border-left:1px&nbsp;solid&nbsp;rgb(221,221,221);background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial&quot;&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;{&lt;/span&gt;  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;gmail-li1&quot;&nbsp;style=&quot;background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial;background-color:rgb(255,255,255)&quot;&gt;&lt;div&nbsp;class=&quot;gmail-de1&quot;&nbsp;style=&quot;padding:0px&nbsp;8px;vertical-align:top;color:rgb(51,51,51);border-left:1px&nbsp;solid&nbsp;rgb(221,221,221);background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial&quot;&gt; &nbsp; &lt;/div&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;gmail-li1&quot;&nbsp;style=&quot;background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial;background-color:rgb(255,255,255)&quot;&gt;&lt;div&nbsp;class=&quot;gmail-de1&quot;&nbsp;style=&quot;padding:0px&nbsp;8px;vertical-align:top;color:rgb(51,51,51);border-left:1px&nbsp;solid&nbsp;rgb(221,221,221);background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial&quot;&gt; &nbsp; &nbsp;osg&lt;span&nbsp;class=&quot;gmail-sy4&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;::&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-me2&quot;&nbsp;style=&quot;color:rgb(0,119,136)&quot;&gt;Matrixd&lt;/span&gt; inverseViewMatrix &lt;span&nbsp;class=&quot;gmail-sy1&quot;&nbsp;style=&quot;color:rgb(0,0,128)&quot;&gt;=&lt;/span&gt; osg&lt;span&nbsp;class=&quot;gmail-sy4&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;::&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-me2&quot;&nbsp;style=&quot;color:rgb(0,119,136)&quot;&gt;Matrixd&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy4&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;::&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-me2&quot;&nbsp;style=&quot;color:rgb(0,119,136)&quot;&gt;inverse&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;getCurrentCamera&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy2&quot;&nbsp;style=&quot;color:rgb(0,0,64)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy1&quot;&nbsp;style=&quot;color:rgb(0,0,128)&quot;&gt;&gt;&lt;/span&gt;getViewMatrix&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy4&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;gmail-li2&quot;&nbsp;style=&quot;background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial;background-color:rgb(255,255,255)&quot;&gt;&lt;div&nbsp;class=&quot;gmail-de2&quot;&nbsp;style=&quot;padding:0px&nbsp;8px;vertical-align:top;color:rgb(51,51,51);border-left:1px&nbsp;solid&nbsp;rgb(221,221,221);background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial&quot;&gt; &nbsp; &nbsp;osg&lt;span&nbsp;class=&quot;gmail-sy4&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;::&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-me2&quot;&nbsp;style=&quot;color:rgb(0,119,136)&quot;&gt;Matrixd&lt;/span&gt; worldMatrix &lt;span&nbsp;class=&quot;gmail-sy1&quot;&nbsp;style=&quot;color:rgb(0,0,128)&quot;&gt;=&lt;/span&gt; inverseViewMatrix &lt;span&nbsp;class=&quot;gmail-sy2&quot;&nbsp;style=&quot;color:rgb(0,0,64)&quot;&gt;*&lt;/span&gt; &lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy2&quot;&nbsp;style=&quot;color:rgb(0,0,64)&quot;&gt;*&lt;/span&gt;getModelViewMatrix&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy4&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;gmail-li1&quot;&nbsp;style=&quot;background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial;background-color:rgb(255,255,255)&quot;&gt;&lt;div&nbsp;class=&quot;gmail-de1&quot;&nbsp;style=&quot;padding:0px&nbsp;8px;vertical-align:top;color:rgb(51,51,51);border-left:1px&nbsp;solid&nbsp;rgb(221,221,221);background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial&quot;&gt; &lt;/div&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;gmail-li1&quot;&nbsp;style=&quot;background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial;background-color:rgb(255,255,255)&quot;&gt;&lt;div&nbsp;class=&quot;gmail-de1&quot;&nbsp;style=&quot;padding:0px&nbsp;8px;vertical-align:top;color:rgb(51,51,51);border-left:1px&nbsp;solid&nbsp;rgb(221,221,221);background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial&quot;&gt; &nbsp; &nbsp;osg&lt;span&nbsp;class=&quot;gmail-sy4&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;::&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-me2&quot;&nbsp;style=&quot;color:rgb(0,119,136)&quot;&gt;Vec3d&lt;/span&gt; pos&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;node.&lt;span&nbsp;class=&quot;gmail-me1&quot;&nbsp;style=&quot;color:rgb(0,119,136)&quot;&gt;getLight&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy2&quot;&nbsp;style=&quot;color:rgb(0,0,64)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy1&quot;&nbsp;style=&quot;color:rgb(0,0,128)&quot;&gt;&gt;&lt;/span&gt;getPosition&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;.&lt;span&nbsp;class=&quot;gmail-me1&quot;&nbsp;style=&quot;color:rgb(0,119,136)&quot;&gt;x&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;,&nbsp;node.&lt;span&nbsp;class=&quot;gmail-me1&quot;&nbsp;style=&quot;color:rgb(0,119,136)&quot;&gt;getLight&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy2&quot;&nbsp;style=&quot;color:rgb(0,0,64)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy1&quot;&nbsp;style=&quot;color:rgb(0,0,128)&quot;&gt;&gt;&lt;/span&gt;getPosition&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;.&lt;span&nbsp;class=&quot;gmail-me1&quot;&nbsp;style=&quot;color:rgb(0,119,136)&quot;&gt;y&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;,&nbsp;node.&lt;span&nbsp;class=&quot;gmail-me1&quot;&nbsp;style=&quot;color:rgb(0,119,136)&quot;&gt;getLight&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy2&quot;&nbsp;style=&quot;color:rgb(0,0,64)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy1&quot;&nbsp;style=&quot;color:rgb(0,0,128)&quot;&gt;&gt;&lt;/span&gt;getPosition&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;.&lt;span&nbsp;class=&quot;gmail-me1&quot;&nbsp;style=&quot;color:rgb(0,119,136)&quot;&gt;z&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy4&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;gmail-li1&quot;&nbsp;style=&quot;background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial;background-color:rgb(255,255,255)&quot;&gt;&lt;div&nbsp;class=&quot;gmail-de1&quot;&nbsp;style=&quot;padding:0px&nbsp;8px;vertical-align:top;color:rgb(51,51,51);border-left:1px&nbsp;solid&nbsp;rgb(221,221,221);background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial&quot;&gt; &nbsp; &nbsp;worldMatrix &lt;span&nbsp;class=&quot;gmail-sy1&quot;&nbsp;style=&quot;color:rgb(0,0,128)&quot;&gt;=&lt;/span&gt; osg&lt;span&nbsp;class=&quot;gmail-sy4&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;::&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-me2&quot;&nbsp;style=&quot;color:rgb(0,119,136)&quot;&gt;Matrixd&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy4&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;::&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-me2&quot;&nbsp;style=&quot;color:rgb(0,119,136)&quot;&gt;translate&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;pos&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt; &lt;span&nbsp;class=&quot;gmail-sy2&quot;&nbsp;style=&quot;color:rgb(0,0,64)&quot;&gt;*&lt;/span&gt; worldMatrix&lt;span&nbsp;class=&quot;gmail-sy4&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;gmail-li1&quot;&nbsp;style=&quot;background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial;background-color:rgb(255,255,255)&quot;&gt;&lt;div&nbsp;class=&quot;gmail-de1&quot;&nbsp;style=&quot;padding:0px&nbsp;8px;vertical-align:top;color:rgb(51,51,51);border-left:1px&nbsp;solid&nbsp;rgb(221,221,221);background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial&quot;&gt; &lt;/div&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;gmail-li2&quot;&nbsp;style=&quot;background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial;background-color:rgb(255,255,255)&quot;&gt;&lt;div&nbsp;class=&quot;gmail-de2&quot;&nbsp;style=&quot;padding:0px&nbsp;8px;vertical-align:top;color:rgb(51,51,51);border-left:1px&nbsp;solid&nbsp;rgb(221,221,221);background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial&quot;&gt; &nbsp; &nbsp;node.&lt;span&nbsp;class=&quot;gmail-me1&quot;&nbsp;style=&quot;color:rgb(0,119,136)&quot;&gt;setUserValue&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-st0&quot;&nbsp;style=&quot;color:rgb(255,0,0)&quot;&gt;&quot;WorldMatrix&quot;&lt;/span&gt;,&nbsp;worldMatrix&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy4&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;gmail-li1&quot;&nbsp;style=&quot;background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial;background-color:rgb(255,255,255)&quot;&gt;&lt;div&nbsp;class=&quot;gmail-de1&quot;&nbsp;style=&quot;padding:0px&nbsp;8px;vertical-align:top;color:rgb(51,51,51);border-left:1px&nbsp;solid&nbsp;rgb(221,221,221);background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial&quot;&gt; &nbsp;  &lt;span&nbsp;class=&quot;gmail-kw1&quot;&nbsp;style=&quot;color:rgb(0,0,255)&quot;&gt;if&lt;/span&gt; &lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;node.&lt;span&nbsp;class=&quot;gmail-me1&quot;&nbsp;style=&quot;color:rgb(0,119,136)&quot;&gt;getLight&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy2&quot;&nbsp;style=&quot;color:rgb(0,0,64)&quot;&gt;-&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy1&quot;&nbsp;style=&quot;color:rgb(0,0,128)&quot;&gt;&gt;&lt;/span&gt;getLightNum&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt; &lt;span&nbsp;class=&quot;gmail-sy1&quot;&nbsp;style=&quot;color:rgb(0,0,128)&quot;&gt;==&lt;/span&gt; &lt;span&nbsp;class=&quot;gmail-nu0&quot;&nbsp;style=&quot;color:rgb(0,0,221)&quot;&gt;0&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;gmail-li1&quot;&nbsp;style=&quot;background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial;background-color:rgb(255,255,255)&quot;&gt;&lt;div&nbsp;class=&quot;gmail-de1&quot;&nbsp;style=&quot;padding:0px&nbsp;8px;vertical-align:top;color:rgb(51,51,51);border-left:1px&nbsp;solid&nbsp;rgb(221,221,221);background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial&quot;&gt; &nbsp;  &lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;{&lt;/span&gt;&lt;/div&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;gmail-li1&quot;&nbsp;style=&quot;background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial;background-color:rgb(255,255,255)&quot;&gt;&lt;div&nbsp;class=&quot;gmail-de1&quot;&nbsp;style=&quot;padding:0px&nbsp;8px;vertical-align:top;color:rgb(51,51,51);border-left:1px&nbsp;solid&nbsp;rgb(221,221,221);background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial&quot;&gt; &nbsp; &nbsp; &nbsp; &nbsp;osgUtil&lt;span&nbsp;class=&quot;gmail-sy4&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;::&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-me2&quot;&nbsp;style=&quot;color:rgb(0,119,136)&quot;&gt;CullVisitor&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy4&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;::&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-me2&quot;&nbsp;style=&quot;color:rgb(0,119,136)&quot;&gt;apply&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;(&lt;/span&gt;node&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;)&lt;/span&gt;&lt;span&nbsp;class=&quot;gmail-sy4&quot;&nbsp;style=&quot;color:rgb(0,128,128)&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;gmail-li1&quot;&nbsp;style=&quot;background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial;background-color:rgb(255,255,255)&quot;&gt;&lt;div&nbsp;class=&quot;gmail-de1&quot;&nbsp;style=&quot;padding:0px&nbsp;8px;vertical-align:top;color:rgb(51,51,51);border-left:1px&nbsp;solid&nbsp;rgb(221,221,221);background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial&quot;&gt; &nbsp;  &lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;/li&gt;&lt;li&nbsp;class=&quot;gmail-li2&quot;&nbsp;style=&quot;background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial;background-color:rgb(255,255,255)&quot;&gt;&lt;div&nbsp;class=&quot;gmail-de2&quot;&nbsp;style=&quot;padding:0px&nbsp;8px;vertical-align:top;color:rgb(51,51,51);border-left:1px&nbsp;solid&nbsp;rgb(221,221,221);background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-origin:initial;background-clip:initial;background-color:rgb(248,248,248)&quot;&gt;&lt;span&nbsp;class=&quot;gmail-br0&quot;&nbsp;style=&quot;color:rgb(0,128,0)&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Nov&nbsp;3,&nbsp;2016&nbsp;at&nbsp;9:14&nbsp;AM,&nbsp;Robert&nbsp;Osfield&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:robert.osfield@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;robert.osfield@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Hi&nbsp;Nick,&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;osgUtil::CullVisitor&nbsp;has&nbsp;the&nbsp;maintains&nbsp;a&nbsp;stack&nbsp;of&nbsp;ModelViewMatrix&lt;br&gt;<br>
that&nbsp;it&nbsp;accumulates&nbsp;through&nbsp;the&nbsp;the&nbsp;scene&nbsp;graph&nbsp;traversal,&nbsp;you&nbsp;should&lt;br&gt;<br>
just&nbsp;need&nbsp;to&nbsp;get&nbsp;the&nbsp;top&nbsp;of&nbsp;this&nbsp;stack&nbsp;using&lt;br&gt;<br>
cullVisitor-&gt;&lt;wbr&gt;getModelViewMatrix().&lt;br&gt;<br>
&lt;br&gt;<br>
Robert.&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;2&nbsp;November&nbsp;2016&nbsp;at&nbsp;22:25,&nbsp;Trajce&nbsp;Nikolov&nbsp;NICK&lt;br&gt;<br>
&lt;div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:trajce.nikolov.nick@gmail.com&quot;&gt;trajce.nikolov.nick@gmail.com&lt;/a&gt;&lt;wbr&gt;&gt;&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;Hi&nbsp;Community,&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;optimize&nbsp;the&nbsp;rendering.&nbsp;Getting&nbsp;huge&nbsp;update&nbsp;numbers.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;story&nbsp;is&nbsp;this:&lt;br&gt;<br>
&gt;&nbsp;My&nbsp;scene&nbsp;has&nbsp;huge&nbsp;number&nbsp;of&nbsp;lights,&nbsp;some&nbsp;are&nbsp;static&nbsp;(streetlights)&nbsp;some&lt;br&gt;<br>
&gt;&nbsp;dynamic&nbsp;(a&nbsp;car).&nbsp;The&nbsp;lighting&nbsp;engine&nbsp;needs&nbsp;the&nbsp;World&nbsp;matrix&nbsp;of&nbsp;a&nbsp;LightSource&lt;br&gt;<br>
&gt;&nbsp;and&nbsp;the&nbsp;ViewMatrix&nbsp;(which&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;World&nbsp;inverse&nbsp;just&nbsp;with&nbsp;some&lt;br&gt;<br>
&gt;&nbsp;extra&nbsp;rotation).&nbsp;In&nbsp;my&nbsp;code&nbsp;after&nbsp;the&nbsp;update&nbsp;before&nbsp;the&nbsp;rendering&nbsp;traversal&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;am&nbsp;updating&nbsp;these&nbsp;matrices&nbsp;each&nbsp;frame&nbsp;and&nbsp;I&nbsp;am&nbsp;about&nbsp;to&nbsp;place&nbsp;this&nbsp;code&nbsp;in&lt;br&gt;<br>
&gt;&nbsp;my&nbsp;custom&nbsp;CullVisitor&nbsp;(which&nbsp;traverse&nbsp;the&nbsp;scene&nbsp;anyway&nbsp;but&nbsp;only&nbsp;the&nbsp;active&lt;br&gt;<br>
&gt;&nbsp;children).&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Here&nbsp;is&nbsp;my&nbsp;approach&nbsp;at&nbsp;the&nbsp;moment:&nbsp;list&nbsp;of&nbsp;light&nbsp;entities&nbsp;and&nbsp;here&nbsp;is&nbsp;how&nbsp;I&lt;br&gt;<br>
&gt;&nbsp;am&nbsp;computing&nbsp;these:&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://pastebin.com/0A64sc7Y&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://pastebin.com/0A64sc7Y&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;Simply&nbsp;getting&nbsp;the&nbsp;NodePath&nbsp;and&nbsp;computing&nbsp;the&nbsp;world&nbsp;matrix&nbsp;from&nbsp;this&nbsp;node&lt;br&gt;<br>
&gt;&nbsp;path.&nbsp;This&nbsp;seams&nbsp;to&nbsp;be&nbsp;costly&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;am&nbsp;after&nbsp;wiser&nbsp;optimization,&nbsp;to&nbsp;place&nbsp;this&nbsp;in&nbsp;my&nbsp;CullVistor:&nbsp;Here&nbsp;is&nbsp;the&lt;br&gt;<br>
&gt;&nbsp;snippet:&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://pastebin.com/6dQnih8N&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://pastebin.com/6dQnih8N&lt;/a&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;These&nbsp;snippets&nbsp;are&nbsp;simple&nbsp;and&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;ask&nbsp;if&nbsp;this&nbsp;is&nbsp;more&nbsp;proper&lt;br&gt;<br>
&gt;&nbsp;way,&nbsp;which&nbsp;it&nbsp;seams&nbsp;to&nbsp;me&nbsp;since&nbsp;I&nbsp;will&nbsp;gain&nbsp;more&nbsp;performance&nbsp;by&nbsp;updating&lt;br&gt;<br>
&gt;&nbsp;only&nbsp;the&nbsp;culled&nbsp;and&nbsp;active&nbsp;nodes.&nbsp;Also&nbsp;the&nbsp;math&nbsp;in&nbsp;the&nbsp;cull&nbsp;visitor.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Thanks&nbsp;a&nbsp;lot&nbsp;for&nbsp;any&nbsp;hints,&nbsp;ideas.&nbsp;As&nbsp;always&nbsp;:-)&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Cheers,&lt;br&gt;<br>
&gt;&nbsp;Nick&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;--&lt;br&gt;<br>
&gt;&nbsp;trajce&nbsp;nikolov&nbsp;nick&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&gt;&nbsp;______________________________&lt;wbr&gt;_________________&lt;br&gt;<br>
&gt;&nbsp;osg-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:osg-users@lists.openscenegraph.org&quot;&gt;osg-users@lists.&lt;wbr&gt;openscenegraph.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.openscenegraph.&lt;wbr&gt;org/listinfo.cgi/osg-users-&lt;wbr&gt;openscenegraph.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
______________________________&lt;wbr&gt;_________________&lt;br&gt;<br>
osg-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:osg-users@lists.openscenegraph.org&quot;&gt;osg-users@lists.&lt;wbr&gt;openscenegraph.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.openscenegraph.&lt;wbr&gt;org/listinfo.cgi/osg-users-&lt;wbr&gt;openscenegraph.org&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_signature&quot;&nbsp;data-smartmail=&quot;gmail_signature&quot;&gt;trajce&nbsp;nikolov&nbsp;nick&lt;br&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>

</tt>
