<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;Robert &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;the&nbsp;reply.&nbsp;I&nbsp;toggled&nbsp;on&nbsp;the&nbsp;high&nbsp;levels&nbsp;of&nbsp;stats&nbsp;info&nbsp;and&nbsp;it&nbsp;was&nbsp;immediately&nbsp;apparent&nbsp;that&nbsp;the&nbsp;delays&nbsp;were&nbsp;occurring&nbsp;in&nbsp;the&nbsp;event&nbsp;traversal,&nbsp;which&nbsp;made&nbsp;no&nbsp;sense,&nbsp;since&nbsp;the&nbsp;only&nbsp;eventhandler&nbsp;that&nbsp;I&nbsp;explicitly&nbsp;added&nbsp;is&nbsp;the&nbsp;StatsHandler&nbsp;and&nbsp;the&nbsp;problem&nbsp;predates&nbsp;that.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;At&nbsp;this&nbsp;point,&nbsp;I&nbsp;abandoned&nbsp;my&nbsp;strong&nbsp;preconception&nbsp;that&nbsp;the&nbsp;problem&nbsp;was&nbsp;somewhere&nbsp;in&nbsp;my&nbsp;OSG&nbsp;calling&nbsp;code&nbsp;or&nbsp;in&nbsp;the&nbsp;way&nbsp;that&nbsp;I&nbsp;set&nbsp;up&nbsp;my&nbsp;project&nbsp;and&nbsp;just&nbsp;used&nbsp;htop&nbsp;to&nbsp;see&nbsp;whether&nbsp;any&nbsp;other&nbsp;processes&nbsp;were&nbsp;starving&nbsp;my&nbsp;little&nbsp;OSG&nbsp;program&nbsp;of&nbsp;CPU&nbsp;time&nbsp;(something&nbsp;I&nbsp;did&nbsp;not&nbsp;consider&nbsp;earlier,&nbsp;because&nbsp;of&nbsp;mentioned&nbsp;preconceptions&nbsp;and&nbsp;the&nbsp;fact&nbsp;that&nbsp;everything&nbsp;else&nbsp;running&nbsp;on&nbsp;my&nbsp;PC&nbsp;appears&nbsp;responsive.)&nbsp;I&nbsp;saw&nbsp;a&nbsp;bunch&nbsp;of&nbsp;java&nbsp;processes&nbsp;that&nbsp;were&nbsp;hogging&nbsp;the&nbsp;CPU&nbsp;(Attempts&nbsp;to&nbsp;install&nbsp;a&nbsp;newer&nbsp;eclipse&nbsp;via&nbsp;yatta&nbsp;that&nbsp;had&nbsp;failed&nbsp;silently&nbsp;a&nbsp;few&nbsp;days&nbsp;ago).&nbsp;After&nbsp;killing&nbsp;these,&nbsp;the&nbsp;framerate&nbsp;went&nbsp;up&nbsp;to&nbsp;60Hz&nbsp;and&nbsp;stayed&nbsp;there&nbsp;after&nbsp;I&nbsp;uncommented&nbsp;all&nbsp;the&nbsp;actual&nbsp;functionality&nbsp;in&nbsp;my&nbsp;program.&nbsp;So&nbsp;this&nbsp;was&nbsp;not&nbsp;OSG&nbsp;related&nbsp;at&nbsp;all&nbsp;after&nbsp;all.&nbsp;:-O&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;for&nbsp;your&nbsp;help.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards&lt;/div&gt;&lt;div&gt;Hannes &lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Oct&nbsp;17,&nbsp;2016&nbsp;at&nbsp;5:18&nbsp;PM,&nbsp;Robert&nbsp;Osfield&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:robert.osfield@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;robert.osfield@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Hi&nbsp;Hannes,&lt;br&gt;<br>
&lt;br&gt;<br>
There&nbsp;really&nbsp;isn&#39;t&nbsp;much&nbsp;info&nbsp;to&nbsp;go&nbsp;on&nbsp;from&nbsp;what&nbsp;you&nbsp;are&nbsp;written&nbsp;so&lt;br&gt;<br>
far. &nbsp;Using&nbsp;the&nbsp;StatsHandler&nbsp;is&nbsp;a&nbsp;good&nbsp;first&nbsp;step&nbsp;but&nbsp;just&nbsp;the&nbsp;frame&lt;br&gt;<br>
rate&nbsp;reports&nbsp;doesn&#39;t&nbsp;tell&nbsp;us&nbsp;enough&nbsp;to&nbsp;know&nbsp;what&nbsp;is&nbsp;going&nbsp;on.&lt;br&gt;<br>
&lt;br&gt;<br>
Try&nbsp;toggling&nbsp;the&nbsp;the&nbsp;high&nbsp;levels&nbsp;of&nbsp;stats&nbsp;info&nbsp;and&nbsp;then&nbsp;look&nbsp;at&nbsp;the&lt;br&gt;<br>
size&nbsp;of&nbsp;the&nbsp;update,&nbsp;event,&nbsp;cull,&nbsp;draw&nbsp;dispatch&nbsp;and&nbsp;draw&nbsp;GPU.&lt;br&gt;<br>
&lt;br&gt;<br>
Another&nbsp;thing&nbsp;to&nbsp;do&nbsp;is&nbsp;switch&nbsp;off&nbsp;vsync&nbsp;via&nbsp;the&nbsp;driver&nbsp;and&nbsp;see&nbsp;what&lt;br&gt;<br>
the&nbsp;framerate&nbsp;is&nbsp;without&nbsp;vysunc&nbsp;on.&lt;br&gt;<br>
&lt;br&gt;<br>
Try&nbsp;with&nbsp;a&nbsp;range&nbsp;a&nbsp;models. &nbsp;As&nbsp;a&nbsp;general&nbsp;note,&nbsp;the&nbsp;OSG&nbsp;with&nbsp;980Ti&lt;br&gt;<br>
should&nbsp;perform&nbsp;pretty&nbsp;well&nbsp;even&nbsp;for&nbsp;very&nbsp;large&nbsp;models. &nbsp;I&nbsp;develop&lt;br&gt;<br>
under&nbsp;Kubuntu&nbsp;and&nbsp;find&nbsp;the&nbsp;NVidia&nbsp;drivers&nbsp;work&nbsp;pretty&nbsp;well,&nbsp;it&nbsp;has&nbsp;to&lt;br&gt;<br>
be&nbsp;a&nbsp;pretty&nbsp;serious&nbsp;model&nbsp;to&nbsp;get&nbsp;the&nbsp;frame&nbsp;rate&nbsp;down&nbsp;as&nbsp;low&nbsp;as&lt;br&gt;<br>
30-40fps,&nbsp;this&nbsp;requires&nbsp;ten&#39;s&nbsp;of&nbsp;millions&nbsp;of&nbsp;vertices&nbsp;per&nbsp;frame&nbsp;to&nbsp;be&lt;br&gt;<br>
rendered&nbsp;or&nbsp;high&nbsp;res&nbsp;volume&nbsp;rendering. &nbsp;With&nbsp;an&nbsp;small&nbsp;scene&nbsp;such&nbsp;as&lt;br&gt;<br>
the&nbsp;OpenSceneGraph-Data&#39;s&nbsp;cow.osgt&nbsp;I&nbsp;get&nbsp;6000+fps&nbsp;on&nbsp;a&nbsp;1920x1080&lt;br&gt;<br>
display.&lt;br&gt;<br>
&lt;br&gt;<br>
Robert.&lt;br&gt;<br>
&lt;div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
On&nbsp;17&nbsp;October&nbsp;2016&nbsp;at&nbsp;16:05,&nbsp;Hannes&nbsp;Naude&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:naude.jj@gmail.com&quot;&gt;naude.jj@gmail.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;OK.&nbsp;Scratch&nbsp;that,&nbsp;I&nbsp;no&nbsp;longer&nbsp;believe&nbsp;that&nbsp;this&nbsp;is&nbsp;a&nbsp;performance&nbsp;measurement&lt;br&gt;<br>
&gt;&nbsp;issue,&nbsp;but&nbsp;rather&nbsp;a&nbsp;performance&nbsp;issue.&nbsp;I&nbsp;have&nbsp;replaced&nbsp;my&nbsp;measurement&nbsp;code&lt;br&gt;<br>
&gt;&nbsp;with&nbsp;the&nbsp;built&nbsp;in&nbsp;StatsHandler&nbsp;class,&nbsp;so&nbsp;my&nbsp;code&nbsp;now&nbsp;looks&nbsp;as&nbsp;follows:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;int&nbsp;main()&nbsp;{&lt;br&gt;<br>
&gt;&nbsp;ref_ptr&lt;osgViewer::&lt;wbr&gt;CompositeViewer&gt;&nbsp;viewer=new&nbsp;osgViewer::CompositeViewer();&lt;br&gt;<br>
&gt;&nbsp;ref_ptr&lt;osgViewer::View&gt;&nbsp;view1&nbsp;=&nbsp;new&nbsp;osgViewer::View;&lt;br&gt;<br>
&gt;&nbsp;viewer-&gt;addView(view1);&lt;br&gt;<br>
&gt;&nbsp;view1-&gt;addEventHandler(&nbsp;new&nbsp;osgViewer::StatsHandler&nbsp;);&lt;br&gt;<br>
&gt;&nbsp;return&nbsp;viewer-&gt;run();&lt;br&gt;<br>
&gt;&nbsp;}&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;When&nbsp;I&nbsp;press&nbsp;S&nbsp;statshandler&nbsp;reports&nbsp;30-40fps.&nbsp;Obviously&nbsp;there&nbsp;is&nbsp;not&nbsp;a&nbsp;lot&lt;br&gt;<br>
&gt;&nbsp;of&nbsp;room&nbsp;to&nbsp;have&nbsp;messed&nbsp;up&nbsp;in&nbsp;a&nbsp;5-liner&nbsp;program,&nbsp;so&nbsp;I&nbsp;believe&nbsp;that&nbsp;that&nbsp;is&lt;br&gt;<br>
&gt;&nbsp;the&nbsp;actual&nbsp;framerate&nbsp;that&nbsp;I&nbsp;am&nbsp;getting.&nbsp;Question&nbsp;is&nbsp;why.&nbsp;I&nbsp;am&nbsp;running&nbsp;on&nbsp;a&lt;br&gt;<br>
&gt;&nbsp;NVIDIA&nbsp;Geforce&nbsp;980Ti&nbsp;under&nbsp;Ubuntu&nbsp;14.04&nbsp;with&nbsp;nvidia&nbsp;driver&nbsp;version&nbsp;352.63)&nbsp;.&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;have&nbsp;optimization&nbsp;on&nbsp;(-O3&nbsp;under&nbsp;gcc) &nbsp;and&nbsp;believe&nbsp;that&nbsp;I&nbsp;am&nbsp;linking&lt;br&gt;<br>
&gt;&nbsp;against&nbsp;release&nbsp;libraries&nbsp;not&nbsp;debug&nbsp;ones.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Any&nbsp;ideas&nbsp;where&nbsp;to&nbsp;look??&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Regards&lt;br&gt;<br>
&gt;&nbsp;Hannes&lt;br&gt;<br>
&gt;&nbsp;----------&nbsp;Forwarded&nbsp;message&nbsp;----------&lt;br&gt;<br>
&gt;&nbsp;From:&nbsp;Hannes&nbsp;Naude&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:naude.jj@gmail.com&quot;&gt;naude.jj@gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt;&nbsp;Date:&nbsp;Mon,&nbsp;Oct&nbsp;17,&nbsp;2016&nbsp;at&nbsp;1:46&nbsp;PM&lt;br&gt;<br>
&gt;&nbsp;Subject:&nbsp;OSG&nbsp;performance&nbsp;measurement&lt;br&gt;<br>
&gt;&nbsp;To:&nbsp;OpenSceneGraph&nbsp;Users&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:osg-users@lists.openscenegraph.org&quot;&gt;osg-users@lists.&lt;wbr&gt;openscenegraph.org&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Hi&nbsp;all&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;New&nbsp;to&nbsp;OSG&nbsp;so&nbsp;apologies&nbsp;if&nbsp;this&nbsp;is&nbsp;a&nbsp;stupid&nbsp;question.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;have&nbsp;written&nbsp;a&nbsp;visualization&nbsp;tool&nbsp;in&nbsp;OSG&nbsp;and&nbsp;as&nbsp;a&nbsp;last&nbsp;step,&nbsp;I&nbsp;wish&nbsp;to&lt;br&gt;<br>
&gt;&nbsp;ensure&nbsp;that&nbsp;it&nbsp;runs&nbsp;at&nbsp;the&nbsp;screen&nbsp;refresh&nbsp;rate.&nbsp;My&nbsp;perception&nbsp;was&nbsp;that&nbsp;it&lt;br&gt;<br>
&gt;&nbsp;mostly&nbsp;runs&nbsp;smoothly&nbsp;but&nbsp;stutters&nbsp;every&nbsp;few&nbsp;frames&nbsp;or&nbsp;so,&nbsp;so&nbsp;I&nbsp;wrote&nbsp;code&nbsp;to&lt;br&gt;<br>
&gt;&nbsp;print&nbsp;the&nbsp;elapsed&nbsp;time&nbsp;between&nbsp;every&nbsp;two&nbsp;frames,&nbsp;rather&nbsp;than&nbsp;just&nbsp;the&lt;br&gt;<br>
&gt;&nbsp;average&nbsp;framerate.&nbsp;The&nbsp;printout&nbsp;seemed&nbsp;to&nbsp;confirm&nbsp;this,&nbsp;so&nbsp;I&nbsp;gradually&lt;br&gt;<br>
&gt;&nbsp;removed&nbsp;more&nbsp;and&nbsp;more&nbsp;of&nbsp;my&nbsp;scenegraph,&nbsp;trying&nbsp;to&nbsp;determine&nbsp;where&nbsp;the&lt;br&gt;<br>
&gt;&nbsp;bottleneck&nbsp;lies.&nbsp;The&nbsp;weird&nbsp;thing&nbsp;is&nbsp;that&nbsp;I&nbsp;end&nbsp;up&nbsp;with&nbsp;a&nbsp;completely&nbsp;empty&lt;br&gt;<br>
&gt;&nbsp;scenegraph&nbsp;(just&nbsp;rendering&nbsp;a&nbsp;blue&nbsp;screen)&nbsp;and&nbsp;execution&nbsp;time&nbsp;STILL&nbsp;seems&nbsp;to&lt;br&gt;<br>
&gt;&nbsp;stutter.&nbsp;So,&nbsp;I&nbsp;strongly&nbsp;suspect&nbsp;that&nbsp;there&nbsp;is&nbsp;something&nbsp;fundamentally&nbsp;wrong&lt;br&gt;<br>
&gt;&nbsp;with&nbsp;the&nbsp;way&nbsp;I&nbsp;am&nbsp;measuring.&nbsp;I&nbsp;realise&nbsp;that&nbsp;FPS&nbsp;is&nbsp;a&nbsp;bad&nbsp;performance&nbsp;metric,&lt;br&gt;<br>
&gt;&nbsp;but&nbsp;right&nbsp;now&nbsp;I&nbsp;just&nbsp;want&nbsp;to&nbsp;get&nbsp;to&nbsp;the&nbsp;point&nbsp;where&nbsp;I&nbsp;am&nbsp;updating&nbsp;every&lt;br&gt;<br>
&gt;&nbsp;frame&nbsp;on&nbsp;my&nbsp;hardware&nbsp;and&nbsp;I&nbsp;am&nbsp;not&nbsp;particularly&nbsp;concerned&nbsp;about&nbsp;performance&lt;br&gt;<br>
&gt;&nbsp;on&nbsp;any&nbsp;other&nbsp;hardware.&nbsp;The&nbsp;remaining&nbsp;code&nbsp;looks&nbsp;like&nbsp;this:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;int&nbsp;main()&nbsp;{&lt;br&gt;<br>
&gt;&nbsp;ref_ptr&lt;osgViewer::&lt;wbr&gt;CompositeViewer&gt;&nbsp;viewer=new&nbsp;osgViewer::CompositeViewer();&lt;br&gt;<br>
&gt;&nbsp;ref_ptr&lt;osgViewer::View&gt;&nbsp;view1&nbsp;=&nbsp;new&nbsp;osgViewer::View;&lt;br&gt;<br>
&gt;&nbsp;viewer-&gt;addView(view1);&lt;br&gt;<br>
&gt;&nbsp;float&nbsp;timeNow,timePrev=0;&lt;br&gt;<br>
&gt;&nbsp;while&nbsp;(!viewer-&gt;done())&lt;br&gt;<br>
&gt;&nbsp;{&lt;br&gt;<br>
&gt;&nbsp;viewer-&gt;frame();&lt;br&gt;<br>
&gt;&nbsp;timeNow=osg::Timer::instance()&lt;wbr&gt;-&gt;time_s();&lt;br&gt;<br>
&gt;&nbsp;std::cout&nbsp;&lt;&lt;&nbsp;timeNow-timePrev&nbsp;&lt;&lt;&nbsp;&quot;&nbsp;&quot;;&lt;br&gt;<br>
&gt;&nbsp;timePrev=timeNow;&lt;br&gt;<br>
&gt;&nbsp;}&lt;br&gt;<br>
&gt;&nbsp;return(0);&lt;br&gt;<br>
&gt;&nbsp;}&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;and&nbsp;the&nbsp;resulting&nbsp;printout&nbsp;to&nbsp;the&nbsp;console&nbsp;looks&nbsp;like&nbsp;this:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;0.123003&nbsp;0.00298501&nbsp;0.000751987&nbsp;0.016045&nbsp;0.083418&nbsp;0.038128&nbsp;0.013075&lt;br&gt;<br>
&gt;&nbsp;0.00068298&nbsp;0.014678&nbsp;0.019825&nbsp;0.013804&nbsp;0.016688&nbsp;0.01651&nbsp;0.066802&nbsp;0.023197&lt;br&gt;<br>
&gt;&nbsp;0.07995&nbsp;0.013019&nbsp;0.000387967&nbsp;0.0331&nbsp;0.000599027&nbsp;0.03273&nbsp;0.000575006&nbsp;0.088067&lt;br&gt;<br>
&gt;&nbsp;0.083023...&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;As&nbsp;you&nbsp;can&nbsp;see,&nbsp;the&nbsp;loop&nbsp;occasionally&nbsp;takes&nbsp;as&nbsp;much&nbsp;as&nbsp;88ms&nbsp;to&nbsp;complete,&lt;br&gt;<br>
&gt;&nbsp;while&nbsp;at&nbsp;other&nbsp;time&nbsp;completing&nbsp;within&nbsp;0.6ms.&nbsp;What&nbsp;could&nbsp;possibly&nbsp;be&nbsp;causing&lt;br&gt;<br>
&gt;&nbsp;this&nbsp;massive&nbsp;variation?&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Regards&lt;br&gt;<br>
&gt;&nbsp;Hannes&nbsp;Naude&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&gt;&nbsp;______________________________&lt;wbr&gt;_________________&lt;br&gt;<br>
&gt;&nbsp;osg-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:osg-users@lists.openscenegraph.org&quot;&gt;osg-users@lists.&lt;wbr&gt;openscenegraph.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.openscenegraph.&lt;wbr&gt;org/listinfo.cgi/osg-users-&lt;wbr&gt;openscenegraph.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
______________________________&lt;wbr&gt;_________________&lt;br&gt;<br>
osg-users&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:osg-users@lists.openscenegraph.org&quot;&gt;osg-users@lists.&lt;wbr&gt;openscenegraph.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.openscenegraph.&lt;wbr&gt;org/listinfo.cgi/osg-users-&lt;wbr&gt;openscenegraph.org&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
