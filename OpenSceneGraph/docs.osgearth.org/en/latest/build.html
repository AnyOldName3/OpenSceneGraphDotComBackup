

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Building osgEarth from Scratch &mdash; osgEarth 3.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="../../_/static/javascript/readthedocs-doc-embed.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/styles.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The Earth File" href="earthfile.html" />
    <link rel="prev" title="Getting started with osgEarth" href="install.html" /> 

<!-- RTD Extra Head -->

<link rel="stylesheet" href="../../_/static/css/readthedocs-doc-embed.css" type="text/css" />

<script type="application/json" id="READTHEDOCS_DATA">{"ad_free": false, "api_host": "https://readthedocs.org", "builder": "sphinx", "canonical_url": null, "docroot": "/docs/source/", "features": {"docsearch_disabled": false}, "global_analytics_code": "UA-17997319-1", "language": "en", "page": "build", "programming_language": "cpp", "project": "osgearth", "proxied_api_host": "/_", "source_suffix": ".md", "subprojects": {}, "theme": "sphinx_rtd_theme", "user_analytics_code": "G-H28EPNP1WC", "version": "latest"}</script>

<!--
Using this variable directly instead of using `JSON.parse` is deprecated.
The READTHEDOCS_DATA global variable will be removed in the future.
-->
<script type="text/javascript">
READTHEDOCS_DATA = JSON.parse(document.getElementById('READTHEDOCS_DATA').innerHTML);
</script>

<script type="text/javascript" src="../../_/static/javascript/readthedocs-analytics.js" async="async"></script>

<!-- end RTD <extrahead> -->
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index-2.html" class="icon icon-home"> osgEarth
          

          
          </a>

          
            
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="http://docs.osgearth.org/en/latest/search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Building the SDK</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#building-with-vcpkg">Building with vcpkg</a></li>
<li class="toctree-l2"><a class="reference internal" href="#checking-for-an-opengl-core-profile-context">Checking for an OpenGL Core Profile Context</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tips-for-vmware-users">Tips for VMware Users</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="earthfile.html">The Earth File</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Working with Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="layers.html">Layer Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="releasenotes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.0_upgrade_guide.html">Upgrade Guide: from 2.x to 3.x</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Getting Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index-2.html">osgEarth</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index-2.html">Docs</a> &raquo;</li>
        
      <li>Building osgEarth from Scratch</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/gwaldron/osgearth/blob/master/docs/source/build.md" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="building-osgearth-from-scratch">
<h1>Building osgEarth from Scratch<a class="headerlink" href="#building-osgearth-from-scratch" title="Permalink to this headline">¶</a></h1>
<p>Normally it is sufficient to install osgEarth from <code class="docutils literal notranslate"><span class="pre">vcpkg</span></code> and use it in your appplication. However, if you want to contribute to the project or make local modifications, you will need to build osgEarth yourself.</p>
<p>The documentation here is focused on Windows.</p>
<div class="section" id="building-with-vcpkg">
<h2>Building with vcpkg<a class="headerlink" href="#building-with-vcpkg" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/Microsoft/vcpkg">vcpkg</a> is an extremely useful package manager. It works on Windows, Linux and MacOS but for this guide we will focus on Windows.</p>
<p><strong>Step 1 - Configure vcpkg</strong></p>
<p>First, download and bootstrap <a class="reference external" href="https://github.com/Microsoft/vcpkg">vcpkg</a> following the instructions on the page.</p>
<p><strong>Step 2 - Set the osg_OPENGL_PROFILE triplet variable to GL3</strong></p>
<p>Next, you will need to set a triplet variable to ensure that osg will be built with modern OpenGL features enabled that osgEarth requires.</p>
<p>The latest (as of 6/6/2023) version of vcpkg will build OSG with OPENGL_PROFILE=GL2 by default.  This is not sufficient for running osgEarth as it does not enable all modern OpenGL features that osgEarth requires and keeps the deprecated fixed function pipeline path in OSG.</p>
<p>Open your existing x64-windows.cmake triplet file at path\to\vcpkg\triplets\x64-windows.cmake and add this line to the end of the file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="n">osg_OPENGL_PROFILE</span> <span class="n">GL3</span><span class="p">)</span>
</pre></div>
</div>
<p>This will build osg with modern OpenGL features and remove the fixed function pipeline.</p>
<p>If you wish to build OSG with a different OPENGL_PROFILE such as GLCORE you can set the osg_OPENGL_PROFILE to GLCORE like this</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="n">osg_OPENGL_PROFILE</span> <span class="n">GLCORE</span><span class="p">)</span>
</pre></div>
</div>
<p>When you install osg using vcpkg with this variable set it will build osg against the &lt;GL/glcorearb.h&gt; headers instead of the usual &lt;GL/gl.h&gt; header.</p>
<p><strong>Step 3 - Clone the repository</strong></p>
<p>Pull down the source from GitHub and create a <code class="docutils literal notranslate"><span class="pre">build</span></code> folder for your out-of-source build. We always recommend doing an out-of-source build to avoid problems down the road!</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="o">--</span><span class="n">recurse</span><span class="o">-</span><span class="n">submodules</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">gwaldron</span><span class="o">/</span><span class="n">osgearth</span><span class="o">.</span><span class="n">git</span> <span class="n">osgearth</span>
<span class="n">mkdir</span> <span class="n">build</span>
</pre></div>
</div>
<p>This will clone the repository into a folder called <code class="docutils literal notranslate"><span class="pre">osgearth</span></code> and pull down all the submodules.</p>
<p><strong>Step 4 - Configure CMake</strong></p>
<p>On Windows, you can run the provided script <code class="docutils literal notranslate"><span class="pre">bootstrap-vcpkg.bat</span></code> to configure your CMake build. This can take a while since it needs to download and build all your dependencies.</p>
<p>Otherwise, follow these steps:</p>
<p>vcpkg provides a CMake toolchain file that helps osgEarth find all of its dependencies.</p>
<p>Note: You’ll need to specify a different build directory based on your build configuration (Release, RelWIthDebInfo, Debug) and specify the build type using <code class="docutils literal notranslate"><span class="pre">-DCMAKE_BUILD_TYPE</span></code>. This is because some dependencies of osgEarth don’t pick up both debug and release versions without specifying the build type. Hopefully this will be fixed in future CMake versions.</p>
<p>Most developers will use a RelWithDebInfo build, like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span> <span class="o">-</span><span class="n">S</span> <span class="n">osgearth</span> <span class="o">-</span><span class="n">B</span> <span class="n">build</span> <span class="o">-</span><span class="n">G</span> <span class="s2">&quot;Visual Studio 15 2017 Win64&quot;</span> <span class="o">-</span><span class="n">DCMAKE_BUILD_TYPE</span><span class="o">=</span><span class="n">RelWithDebInfo</span> <span class="o">-</span><span class="n">DWIN32_USE_MP</span><span class="o">=</span><span class="n">ON</span> <span class="o">-</span><span class="n">DCMAKE_INSTALL_PREFIX</span><span class="o">=</span><span class="p">[</span><span class="n">installroot</span><span class="p">]</span> <span class="o">-</span><span class="n">DCMAKE_TOOLCHAIN_FILE</span><span class="o">=</span><span class="p">[</span><span class="n">vcpkgroot</span><span class="p">]</span>\<span class="n">scripts</span>\<span class="n">buildsystems</span>\<span class="n">vcpkg</span><span class="o">.</span><span class="n">cmake</span>
</pre></div>
</div>
<p>osgEarth provides a vcpkg.json manifest file that lists all of it’s necessary dependencies.  The vcpkg toolchain integration will notice this file and install the necessary dependencies in your build\vcpkg_installed directory.</p>
<p><strong>Step 5 - Build and install osgEarth</strong></p>
<p>You can build and install osgEarth on the command line using CMake or you can open up the Visual Studio solution and build it from there.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span> <span class="o">--</span><span class="n">build</span> <span class="n">build</span> <span class="o">--</span><span class="n">target</span> <span class="n">INSTALL</span> <span class="o">--</span><span class="n">config</span> <span class="n">RelWithDebInfo</span>
</pre></div>
</div>
<p><strong>Step 6 - Set up your runtime environment</strong></p>
<p>You’ll need to make sure that the vcpkg dependencies and osgEarth are in your path:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">PATH</span><span class="o">=%</span><span class="n">PATH</span><span class="o">%</span><span class="p">;</span><span class="n">path</span>\<span class="n">to</span>\<span class="n">build</span>\<span class="n">vcpkg_installed</span>\<span class="n">x64</span><span class="o">-</span><span class="n">windows</span>\<span class="nb">bin</span>
<span class="nb">set</span> <span class="n">PATH</span><span class="o">=%</span><span class="n">PATH</span><span class="o">%</span><span class="p">;</span><span class="n">path</span>\<span class="n">to</span>\<span class="n">build</span>\<span class="n">vcpkg_installed</span>\<span class="n">x64</span><span class="o">-</span><span class="n">windows</span>\<span class="n">tools</span>\<span class="n">osg</span>
<span class="nb">set</span> <span class="n">PATH</span><span class="o">=%</span><span class="n">PATH</span><span class="o">%</span><span class="p">;[</span><span class="n">installroot</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="checking-for-an-opengl-core-profile-context">
<h2>Checking for an OpenGL Core Profile Context<a class="headerlink" href="#checking-for-an-opengl-core-profile-context" title="Permalink to this headline">¶</a></h2>
<p>Some situations require you to have an OpenGL Core Profile context.  The ability to create a core context is available when OSG is built with OPENGL_PROFILE=GL3 or GLCORE.  Environments such as Apple OSX and VMWare require it as does debugging with tools like NVidia NSight.  You can check to see if you are running with an OpenGL Core Profile by running a command like this (Windows)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">OSG_GL_CONTEXT_VERSION</span><span class="o">=</span><span class="mf">4.6</span>
<span class="n">osgearth_version</span> <span class="o">--</span><span class="n">caps</span>
</pre></div>
</div>
<p>If all went well, it should report <strong>“Core Profile = yes”</strong>.</p>
<p>You can disable the CORE profile and select a compatibility profile by setting a profile mask like so</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">OSG_GL_CONTEXT_PROFILE_MASK</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p>The context version and profile mask are also settable via the <code class="docutils literal notranslate"><span class="pre">osg::DisplaySettings</span></code> class in the OpenSceneGraph API.</p>
</div>
<div class="section" id="tips-for-vmware-users">
<h2>Tips for VMware Users<a class="headerlink" href="#tips-for-vmware-users" title="Permalink to this headline">¶</a></h2>
<p>Running osgEarth in a virtual machine environment can be tricky since they usually don’t have direct access to the graphics hardware by default. If you are having trouble you can try these tips.</p>
<p>First, build OSG and osgEarth for GL CORE profile (as above).</p>
<p>Next, assess the situation with a capabilities check:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">osgearth_version</span> <span class="o">--</span><span class="n">caps</span>
</pre></div>
</div>
<p>The output will look something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GPU</span> <span class="n">Vendor</span><span class="p">:</span>        <span class="n">WMware</span><span class="p">,</span> <span class="n">Inc</span><span class="o">.</span>
<span class="n">GPU</span> <span class="n">Renderer</span>       <span class="n">Gallium</span> <span class="mf">0.3</span> <span class="n">on</span> <span class="n">llvmpipe</span>
<span class="n">GL</span><span class="o">/</span><span class="n">Driver</span> <span class="n">Version</span><span class="p">:</span> <span class="mf">1.2</span> <span class="n">Mesa</span> <span class="mf">11.2</span><span class="o">.</span><span class="mi">0</span>
</pre></div>
</div>
<p>If is reports a Mesa driver, and the version is less than 3.3, you will need to configure a couple environment variables to move forward (Windows):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">OSG_GL_CONTEXT_VERSION</span><span class="o">=</span><span class="mf">3.3</span>
<span class="nb">set</span> <span class="n">MESA_GL_VERSION_OVERRIDE</span><span class="o">=</span><span class="mf">3.3</span>
<span class="n">osgearth_version</span> <span class="o">--</span><span class="n">caps</span>
</pre></div>
</div>
<p>Good luck!</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="earthfile.html" class="btn btn-neutral float-right" title="The Earth File" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="install.html" class="btn btn-neutral float-left" title="Getting started with osgEarth" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Pelican Mapping
      
        <span class="commit">
          Revision <code>74a5fc6d</code>.
        </span>
      

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org/">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="index.html">latest</a></dd>
        
          <dd><a href="../3.2/index.html">3.2</a></dd>
        
          <dd><a href="../3.1/index.html">3.1</a></dd>
        
          <dd><a href="../2.10/index.html">2.10</a></dd>
        
          <dd><a href="../docs/index.html">docs</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="../../_/downloads/en/latest/pdf/index.html">pdf</a></dd>
        
          <dd><a href="../../_/downloads/en/latest/htmlzip/index.html">html</a></dd>
        
      </dl>
      <dl>
        <dt>On Read the Docs</dt>
          <dd>
            <a href="http://readthedocs.org/projects/osgearth/?fromdocs=osgearth">Project Home</a>
          </dd>
          <dd>
            <a href="http://readthedocs.org/builds/osgearth/?fromdocs=osgearth">Builds</a>
          </dd>
      </dl>
      <hr/>
      Free document hosting provided by <a href="http://www.readthedocs.org/">Read the Docs</a>.

    </div>
  </div>



  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
   

</body>
</html>