

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Utilities SDK &mdash; osgEarth 2.10 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../../../../assets.readthedocs.org/static/javascript/readthedocs-doc-embed.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Shader Composition" href="shader_composition.html" />
    <link rel="prev" title="Working with Maps" href="maps.html" /> 

<!-- RTD Extra Head -->

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="../../latest/developer/utilities.html" />

<link rel="stylesheet" href="../../../../assets.readthedocs.org/static/css/readthedocs-doc-embed.css" type="text/css" />

<script type="text/javascript" src="../_static/readthedocs-data.js"></script>

<!-- Add page-specific data, which must exist in the page js, not global -->
<script type="text/javascript">
READTHEDOCS_DATA['page'] = "developer/utilities"
READTHEDOCS_DATA['source_suffix'] = ".rst"
</script>

<script type="text/javascript" src="../../../../assets.readthedocs.org/static/javascript/readthedocs-analytics.js"></script>

<!-- end RTD <extrahead> -->
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index-2.html" class="icon icon-home"> osgEarth
          

          
          </a>

          
            
            
            
              <div class="version">
                2.10
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="http://docs.osgearth.org/en/2.10/search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About the Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../startup.html">Building osgEarth</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Topics</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="maps.html">Working with Maps</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Utilities SDK</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#logarithmic-depth-buffer">Logarithmic Depth Buffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#formatters">Formatters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#latlongformatter">LatLongFormatter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mgrsformatter">MGRSFormatter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mousecoordstool">MouseCoordsTool</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="shader_composition.html">Shader Composition</a></li>
<li class="toctree-l2"><a class="reference internal" href="coordinate_systems.html">Coordinate Systems</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../data.html">Working with Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/index.html">Reference Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releasenotes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">osgEarth Priority Support</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index-2.html">osgEarth</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index-2.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Developer Topics</a> &raquo;</li>
        
      <li>Utilities SDK</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/gwaldron/osgearth/blob/2.10/docs/source/developer/utilities.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="utilities-sdk">
<h1>Utilities SDK<a class="headerlink" href="#utilities-sdk" title="Permalink to this headline">¶</a></h1>
<p>The osgEarth <em>Utils</em> namespace includes a variety of useful classes for interacting
with the map. None of these are strictly necessary for using osgEarth, but they do
make it easier to perform some common operations.</p>
<div class="section" id="logarithmic-depth-buffer">
<h2>Logarithmic Depth Buffer<a class="headerlink" href="#logarithmic-depth-buffer" title="Permalink to this headline">¶</a></h2>
<p>In whole-earth applications it’s common that you want to see something up close (like
an aircraft at altitude) while seeing the Earth and its horizon off in the distance.
This poses a problem for modern graphic hardware because the standard depth buffer
precision heavily favors objects closer to the camera, and viewing such a wide range
of objects leads to “z-fighting” artifacts.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">LogarithmicDepthBuffer</span></code> is one way to solve this problem. It uses a shader to
re-map the GPU’s depth buffer values so they can be put to better use in this type
of scenario.</p>
<p>It’s easy to install:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LogarithmicDepthBuffer</span> <span class="n">logdepth</span><span class="p">;</span>
<span class="n">logdepth</span><span class="o">-&gt;</span><span class="n">install</span><span class="p">(</span> <span class="n">view</span><span class="o">-&gt;</span><span class="n">getCamera</span><span class="p">()</span> <span class="p">);</span>
</pre></div>
</div>
<p>Or you can activate it from <code class="docutils literal notranslate"><span class="pre">osgearth_viewer</span></code> or other examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">osgearth_viewer</span> <span class="o">--</span><span class="n">logdepth</span> <span class="o">...</span>
</pre></div>
</div>
<p>Since it does alter the projection-space coordinates of your geometry at draw time,
you do need to be careful that you aren’t doing anything ELSE in clip space in your
own custom shaders that would conflict with this.</p>
<p>(10-Jul-2014: Some osgEarth features are incompatible with the log depth buffer;
namely, GPU clamping and Shadowing. Depth Offset works correctly though.)</p>
</div>
<div class="section" id="formatters">
<h2>Formatters<a class="headerlink" href="#formatters" title="Permalink to this headline">¶</a></h2>
<p>Use <em>Formatters</em> to format geospatial coordinates as a string. There are two stock formatters,
the <code class="docutils literal notranslate"><span class="pre">LatLongFormatter</span></code> and the <code class="docutils literal notranslate"><span class="pre">MGRSFormatter</span></code>. A formatter takes a <code class="docutils literal notranslate"><span class="pre">GeoPoint</span></code> and
returns a <code class="docutils literal notranslate"><span class="pre">std::string</span></code> like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LatLongFormatter</span> <span class="n">formatter</span><span class="p">;</span>
<span class="n">GeoPoint</span> <span class="n">point</span><span class="p">;</span>
<span class="o">....</span>
<span class="n">std</span><span class="p">::</span><span class="n">string</span> <span class="o">=</span> <span class="n">formatter</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">point</span> <span class="p">);</span>
</pre></div>
</div>
<div class="section" id="latlongformatter">
<h3>LatLongFormatter<a class="headerlink" href="#latlongformatter" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">LatLongFormatter</span></code> takes coordinates and generates a string. It supports the following
formats:</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">FORMAT_DECIMAL_DEGREES:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">34.04582</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">FORMAT_DEGREES_DECIMAL_MINUTES:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body">34.20:30</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">FORMAT_DEGREES_MINUTES_SECONDS:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">34:14:30</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>You can also specify options for the output string:</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">USE_SYMBOLS:</th><td class="field-body">Use the degrees, minutes and seconds symbology</td>
</tr>
<tr class="field-even field"><th class="field-name">USE_COLONS:</th><td class="field-body">Use colons between the components</td>
</tr>
<tr class="field-odd field"><th class="field-name">USE_SPACES:</th><td class="field-body">Use spaces between the components</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="mgrsformatter">
<h3>MGRSFormatter<a class="headerlink" href="#mgrsformatter" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">MGRSFormatter</span></code> constructs a string according to the <a class="reference external" href="http://en.wikipedia.org/wiki/Military_grid_reference_system">Military Grid Reference System</a>.
Technically, an MGRS coordinate represents a <em>region</em> rather than an exact point, so you
have to specify a <em>precision</em> qualifier to control the size of the represented region.
Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MGRSFormatter</span> <span class="n">mgrs</span><span class="p">(</span> <span class="n">MGRFormatter</span><span class="p">::</span><span class="n">PRECISION_1000M</span> <span class="p">);</span>
<span class="n">std</span><span class="p">::</span><span class="n">string</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">mgrs</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">geopoint</span> <span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="mousecoordstool">
<h2>MouseCoordsTool<a class="headerlink" href="#mousecoordstool" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">MouseCoordsTool</span></code> reports the map coordinates under the mouse (or other pointing device).
Install a callback to respond to the reports. <code class="docutils literal notranslate"><span class="pre">MouseCoordsTool</span></code> is an <code class="docutils literal notranslate"><span class="pre">osgGA::GUIEventHandler</span></code>
that you can install on a <code class="docutils literal notranslate"><span class="pre">Viewer</span></code> or any <code class="docutils literal notranslate"><span class="pre">Node</span></code>, like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MouseCoordsTool</span><span class="o">*</span> <span class="n">tool</span> <span class="o">=</span> <span class="n">new</span> <span class="n">MouseCoordsTool</span><span class="p">();</span>
<span class="n">tool</span><span class="o">-&gt;</span><span class="n">addCallback</span><span class="p">(</span> <span class="n">new</span> <span class="n">MyCallback</span><span class="p">()</span> <span class="p">);</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">addEventHandler</span><span class="p">(</span> <span class="n">tool</span> <span class="p">);</span>
</pre></div>
</div>
<p>Create your own callback to respond to reports. Here is an example that prints the X,Y under the
mouse to a <em>Qt</em> status bar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">struct</span> <span class="n">PrintCoordsToStatusBar</span> <span class="p">:</span> <span class="n">public</span> <span class="n">MouseCoordsTool</span><span class="p">::</span><span class="n">Callback</span>
<span class="p">{</span>
<span class="n">public</span><span class="p">:</span>
    <span class="n">PrintCoordsToStatusBar</span><span class="p">(</span><span class="n">QStatusBar</span><span class="o">*</span> <span class="n">sb</span><span class="p">)</span> <span class="p">:</span> <span class="n">_sb</span><span class="p">(</span><span class="n">sb</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

    <span class="n">void</span> <span class="nb">set</span><span class="p">(</span><span class="n">const</span> <span class="n">GeoPoint</span><span class="o">&amp;</span> <span class="n">p</span><span class="p">,</span> <span class="n">osg</span><span class="p">::</span><span class="n">View</span><span class="o">*</span> <span class="n">view</span><span class="p">,</span> <span class="n">MapNode</span><span class="o">*</span> <span class="n">mapNode</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">std</span><span class="p">::</span><span class="n">string</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">osgEarth</span><span class="p">::</span><span class="n">Stringify</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;, &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">();</span>
        <span class="n">_sb</span><span class="o">-&gt;</span><span class="n">showMessage</span><span class="p">(</span> <span class="n">QString</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">c_str</span><span class="p">())</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="n">void</span> <span class="n">reset</span><span class="p">(</span><span class="n">osg</span><span class="p">::</span><span class="n">View</span><span class="o">*</span> <span class="n">view</span><span class="p">,</span> <span class="n">MapNode</span><span class="o">*</span> <span class="n">mapNode</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">_sb</span><span class="o">-&gt;</span><span class="n">showMessage</span><span class="p">(</span> <span class="n">QString</span><span class="p">(</span><span class="s2">&quot;out of range&quot;</span><span class="p">)</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="n">QStatusBar</span><span class="o">*</span> <span class="n">_sb</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>For your convenience, <code class="docutils literal notranslate"><span class="pre">MouseCoordsTool</span></code> also comes with a stock callback that will
print the coords to <code class="docutils literal notranslate"><span class="pre">osgEarthUtil::Controls::LabelControl</span></code>. You can even pass a
<code class="docutils literal notranslate"><span class="pre">LabelControl</span></code> to the constructor to make it even easier.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="shader_composition.html" class="btn btn-neutral float-right" title="Shader Composition" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="maps.html" class="btn btn-neutral float-left" title="Working with Maps" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Pelican Mapping
      
        <span class="commit">
          Revision <code>de6041a2</code>.
        </span>
      

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org/">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: 2.10
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="../../latest/index.html">latest</a></dd>
        
          <dd><a href="../../3.0/index.html">3.0</a></dd>
        
          <dd><a href="../index.html">2.10</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="http://readthedocs.org/projects/osgearth/downloads/pdf/2.10/">pdf</a></dd>
        
          <dd><a href="http://readthedocs.org/projects/osgearth/downloads/htmlzip/2.10/">html</a></dd>
        
          <dd><a href="http://readthedocs.org/projects/osgearth/downloads/epub/2.10/">epub</a></dd>
        
      </dl>
      <dl>
        <dt>On Read the Docs</dt>
          <dd>
            <a href="http://readthedocs.org/projects/osgearth/?fromdocs=osgearth">Project Home</a>
          </dd>
          <dd>
            <a href="http://readthedocs.org/builds/osgearth/?fromdocs=osgearth">Builds</a>
          </dd>
      </dl>
      <hr/>
      Free document hosting provided by <a href="http://www.readthedocs.org/">Read the Docs</a>.

    </div>
  </div>



  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
   

</body>
</html>